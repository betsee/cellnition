
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../1%29%20GRN%20Model%20Building/network_models_probability_networks/">
      
      
        <link rel="next" href="../networks_toolbox_state_machine/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Boolean Finite State Machine - Cellnition</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#boolean-finite-state-machine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cellnition" class="md-header__button md-logo" aria-label="Cellnition" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cellnition
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Boolean Finite State Machine
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cellnition" class="md-nav__button md-logo" aria-label="Cellnition" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cellnition
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Background
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    1) GRN Model Building
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            1) GRN Model Building
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1%29%20GRN%20Model%20Building/network_models_boolean_networks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boolean Network Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1%29%20GRN%20Model%20Building/network_models_interaction_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interaction Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1%29%20GRN%20Model%20Building/network_models_network_abc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Base Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1%29%20GRN%20Model%20Building/network_models_network_enums/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Enumerations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1%29%20GRN%20Model%20Building/network_models_probability_networks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continuous Network Model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2) Construction of NFSMs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            2) Construction of NFSMs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Boolean Finite State Machine
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Boolean Finite State Machine
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine" class="md-nav__link">
    <span class="md-ellipsis">
      BoolStateMachine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.create_transition_network" class="md-nav__link">
    <span class="md-ellipsis">
      create_transition_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.get_state_distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      get_state_distance_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_input_words_array" class="md-nav__link">
    <span class="md-ellipsis">
      plot_input_words_array
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_sequence_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sequence_trajectory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_state_perturbation_network" class="md-nav__link">
    <span class="md-ellipsis">
      plot_state_perturbation_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_state_transition_network" class="md-nav__link">
    <span class="md-ellipsis">
      plot_state_transition_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.sim_sequence_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      sim_sequence_trajectory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.steady_state_solutions_search" class="md-nav__link">
    <span class="md-ellipsis">
      steady_state_solutions_search
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../networks_toolbox_state_machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continuous Finite State Machine
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    3) Additional GRN Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            3) Additional GRN Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/network_models_basic_network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/network_models_network_library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Library
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/networks_toolbox_gene_knockout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gene Knockout Simulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/networks_toolbox_netplot_plotnetwork/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine" class="md-nav__link">
    <span class="md-ellipsis">
      BoolStateMachine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.create_transition_network" class="md-nav__link">
    <span class="md-ellipsis">
      create_transition_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.get_state_distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      get_state_distance_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_input_words_array" class="md-nav__link">
    <span class="md-ellipsis">
      plot_input_words_array
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_sequence_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sequence_trajectory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_state_perturbation_network" class="md-nav__link">
    <span class="md-ellipsis">
      plot_state_perturbation_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_state_transition_network" class="md-nav__link">
    <span class="md-ellipsis">
      plot_state_transition_network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.sim_sequence_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      sim_sequence_trajectory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.steady_state_solutions_search" class="md-nav__link">
    <span class="md-ellipsis">
      steady_state_solutions_search
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="boolean-finite-state-machine">Boolean Finite State Machine</h1>


<div class="doc doc-object doc-class">



<a id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a></code></p>


        <p>Builds and plots Network Finite State Machines (NFSMs) from a regulatory
network modelled using Boolean logic functions (see
<a class="autorefs autorefs-internal" href="../../1%29%20GRN%20Model%20Building/network_models_boolean_networks/#cellnition.science.network_models.boolean_networks.BooleanNet"><code>BooleanNet</code></a>).
BoolStateMachine first performs a comprehensive search for stable
equilibrium states of the regulatory network. It then uses pseudo-time simulation,
starting the system off at every equilibrium state and every input signal,
applying a new input signal, and returning the system to the original input signal.
It then detects new equilibrium states occupied by the system after the application
of each input signal perturbation. The input-driven transitions between states are
recorded as the NFSMs of the system.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.G_states">G_states</span></code></td>
            <td>
                  <code><span title="networkx.MultiDiGraph">MultiDiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>General NFSM (G-NFSM), where each equilibrium-state of the
regulatory network is a node of the G-NFSM, and labeled directed edges indicate the
input state (as an edge label) inducing a transition between one equilibrium state
and another. This is a networkx MultiDiGraph,
which means parallel edges are allowed to exist and therefore it is possible for different signals to
transition the system between the same two state. <code>G_states</code> is created using the
<code>create_transition_network</code> method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BoolStateMachine</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Builds and plots Network Finite State Machines (NFSMs) from a regulatory</span>
<span class="sd">    network modelled using Boolean logic functions (see</span>
<span class="sd">    [`BooleanNet`][cellnition.science.network_models.boolean_networks.BooleanNet]).</span>
<span class="sd">    BoolStateMachine first performs a comprehensive search for stable</span>
<span class="sd">    equilibrium states of the regulatory network. It then uses pseudo-time simulation,</span>
<span class="sd">    starting the system off at every equilibrium state and every input signal,</span>
<span class="sd">    applying a new input signal, and returning the system to the original input signal.</span>
<span class="sd">    It then detects new equilibrium states occupied by the system after the application</span>
<span class="sd">    of each input signal perturbation. The input-driven transitions between states are</span>
<span class="sd">    recorded as the NFSMs of the system.</span>

<span class="sd">    Attributes</span>
<span class="sd">    -----------------</span>
<span class="sd">    G_states : MultiDiGraph</span>
<span class="sd">        General NFSM (G-NFSM), where each equilibrium-state of the</span>
<span class="sd">        regulatory network is a node of the G-NFSM, and labeled directed edges indicate the</span>
<span class="sd">        input state (as an edge label) inducing a transition between one equilibrium state</span>
<span class="sd">        and another. This is a networkx MultiDiGraph,</span>
<span class="sd">        which means parallel edges are allowed to exist and therefore it is possible for different signals to</span>
<span class="sd">        transition the system between the same two state. `G_states` is created using the</span>
<span class="sd">        `create_transition_network` method.</span>


<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bnet</span><span class="p">:</span> <span class="n">BooleanNet</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialize the `BoolStateMachine`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bnet : BooleanNet</span>
<span class="sd">            An instance of [`BooleanNet`][cellnition.science.network_models.boolean_networks.BooleanNet].</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span> <span class="o">=</span> <span class="n">bnet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G_states</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># The state transition network</span>

        <span class="c1"># Path to load image assets:</span>
        <span class="n">GLYPH_DIR</span> <span class="o">=</span> <span class="n">get_data_png_glyph_stability_dir</span><span class="p">()</span>
        <span class="n">attractor_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_attractor.png&#39;</span><span class="p">)</span>
        <span class="n">limitcycle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_limit_cycle.png&#39;</span><span class="p">)</span>
        <span class="n">saddle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_saddle.png&#39;</span><span class="p">)</span>
        <span class="n">attractor_limitcycle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_attractor_limit_cycle.png&#39;</span><span class="p">)</span>
        <span class="n">repellor_limitcycle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_repellor_limit_cycle.png&#39;</span><span class="p">)</span>
        <span class="n">repellor_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_repellor.png&#39;</span><span class="p">)</span>
        <span class="n">unknown_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_unknown.png&#39;</span><span class="p">)</span>
        <span class="n">hidden_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_hidden.png&#39;</span><span class="p">)</span>

        <span class="c1"># Associate each equilibrium type with an image file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">attractor_fname</span><span class="p">),</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">limit_cycle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">limitcycle_fname</span><span class="p">),</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">saddle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">saddle_fname</span><span class="p">),</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor_limit_cycle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">attractor_limitcycle_fname</span><span class="p">),</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor_limit_cycle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">repellor_limitcycle_fname</span><span class="p">),</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">repellor_fname</span><span class="p">),</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">undetermined</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">unknown_fname</span><span class="p">),</span>
            <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">hidden</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">hidden_fname</span><span class="p">)</span>
        <span class="p">}</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">steady_state_solutions_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">search_main_nodes_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">n_max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                                      <span class="n">order_by_distance</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">node_num_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                      <span class="n">output_nodes_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                                      <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Search through all possible (binary valued) combinations of input nodes</span>
<span class="sd">        (`BooleanNet.input_node_inds`) to find and dynamically characterize equilibrium</span>
<span class="sd">        state of the regulatory network system.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, default: True</span>
<span class="sd">            Print output while solving (`True`)?</span>
<span class="sd">        search_main_nodes_only : bool, default: False</span>
<span class="sd">            Search only the `BooleanNet.main_nodes` (`True`) or search all noninput nodes,</span>
<span class="sd">            `BooleanNet.noninput_node_inds` nodes (`False`)?</span>
<span class="sd">        n_max_steps : int, default: 20</span>
<span class="sd">            The maximum number of steps that the Boolean regulatory network solver should use in</span>
<span class="sd">            determining each eq&#39;m. It is recommended that `n_max_steps` be greater than twice the</span>
<span class="sd">            total node number (i.e. `n_max_steps &gt;= 2*BooleanNet.N_nodes`).</span>
<span class="sd">        order_by_distance : bool, default: False</span>
<span class="sd">            Order states by increasing distance from the zero state (`True`)?</span>
<span class="sd">        node_num_max : int|None, default: None</span>
<span class="sd">            If `n_max_steps` is `True`, further limit the search space dimensions to the first node_num_max</span>
<span class="sd">            nodes according to their hierarchical level (i.e. according to `BooleanNet.hier_node_level`)?</span>
<span class="sd">            We have found that all equilibrium solutions can be returned by selecting the a subset of nodes</span>
<span class="sd">            with the ones with the highest hierarchical level (i.e. closest to inputs) having maximum influence</span>
<span class="sd">            on the network.</span>
<span class="sd">        output_nodes_only : bool, default: False</span>
<span class="sd">            Define the uniqueness of equilibrium states using only the `BooleanNet.output_node_inds` (`True`) or</span>
<span class="sd">            by using all non-input node inds using `BooleanNet.noninput_node_inds` (`False`)?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        solsM : ndarray</span>
<span class="sd">            The matrix of unique equilibrium state solutions, with each solution appearing in columns, and each row</span>
<span class="sd">            representing the node expression level.</span>
<span class="sd">        charM_all : ndarray</span>
<span class="sd">            The dynamic characterization of each equilibrium state in solsM, as a linear array of</span>
<span class="sd">            [`EquilibriumType`][cellnition.science.network_models.network_enums]</span>
<span class="sd">            enumerations.</span>
<span class="sd">        sols_list : list</span>
<span class="sd">            The list of all (non-unique) equilibrium state solutions in the order that they were found.</span>
<span class="sd">        states_dict : OrderedDict</span>
<span class="sd">            A dictionary with keys as tuples representing each input state, and values being the equilibrium</span>
<span class="sd">            state index as the column index of `solsM`.</span>
<span class="sd">        sig_test_set : ndarray</span>
<span class="sd">            An array containing each of the input states (i.e. all binary-node-level combinations of</span>
<span class="sd">            `BooleanNet.input_node_inds`) which were applied to the network, for which equilibrium states</span>
<span class="sd">            of the network were found.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The BooleanNetwork object needs to have an analytical model constructed using&quot;</span>
                            <span class="s2">&quot;the build_boolean_model method.&quot;</span><span class="p">)</span>

        <span class="n">sig_lin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">sig_lin_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">sig_lin</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">]</span>

        <span class="n">sigGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">sig_lin_set</span><span class="p">)</span>

        <span class="n">N_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigGrid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

        <span class="n">sig_test_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_vocab</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sigM</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sigGrid</span><span class="p">):</span>
            <span class="n">sig_test_set</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigM</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="c1"># solsM_allo = np.zeros((self._bnet.N_nodes, 1))</span>
        <span class="c1"># charM_allo = [EquilibriumType.undetermined]</span>
        <span class="n">solsM_allo</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">charM_allo</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sols_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">sigis</span> <span class="ow">in</span> <span class="n">sig_test_set</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Signals: </span><span class="si">{</span><span class="n">sigis</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sols_M</span><span class="p">,</span> <span class="n">sols_char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">solve_system_equms</span><span class="p">(</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                        <span class="n">constraint_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">constraint_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">signal_constr_vals</span><span class="o">=</span><span class="n">sigis</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                                                        <span class="n">search_main_nodes_only</span><span class="o">=</span><span class="n">search_main_nodes_only</span><span class="p">,</span>
                                                        <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                        <span class="n">node_num_max</span><span class="o">=</span><span class="n">node_num_max</span>
                                                        <span class="p">)</span>
            <span class="k">if</span> <span class="n">solsM_allo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">solsM_allo</span> <span class="o">=</span> <span class="n">sols_M</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">solsM_allo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">solsM_allo</span><span class="p">,</span> <span class="n">sols_M</span><span class="p">))</span>  <span class="c1"># append all unique sols</span>
            <span class="n">charM_allo</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sols_char</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>  <span class="c1"># append the sol stability characterization tags</span>
            <span class="n">sols_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols_M</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">sols_M</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----&#39;</span><span class="p">)</span>

        <span class="c1"># If desired, states can be defined as &quot;unique&quot; with respect to the output nodes only:</span>
        <span class="k">if</span> <span class="n">output_nodes_only</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span><span class="p">):</span>
            <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span>

        <span class="c1"># Eliminate duplicate states, but stack on strings of the eqm char</span>
        <span class="c1"># so we don&#39;t lose states with the same values but with different eq&#39;m:</span>
        <span class="c1"># chrm = [eqt.name for eqt in charM_allo]</span>
        <span class="c1"># checkM = np.vstack((solsM_allo[state_node_inds, :], chrm))</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">inds_solsM_all_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">solsM_allo</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">solsM_allo</span><span class="p">[:,</span> <span class="n">inds_solsM_all_unique</span><span class="p">]</span>
        <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">charM_allo</span><span class="p">)[</span><span class="n">inds_solsM_all_unique</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">order_by_distance</span><span class="p">:</span>
            <span class="c1"># Order states by distance from the zero vector</span>
            <span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_states_by_distance</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span><span class="p">)</span>

        <span class="n">states_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">sigi</span> <span class="ow">in</span> <span class="n">sig_test_set</span><span class="p">:</span>
            <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Stability&#39;</span><span class="p">:</span> <span class="p">[]}</span>

        <span class="k">for</span> <span class="n">sigi</span><span class="p">,</span> <span class="n">state_subseto</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">,</span> <span class="n">sols_list</span><span class="p">):</span>
            <span class="n">state_subset</span> <span class="o">=</span> <span class="n">state_subseto</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:]</span>
            <span class="k">for</span> <span class="n">target_state</span> <span class="ow">in</span> <span class="n">state_subset</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
                <span class="n">state_match_index</span><span class="p">,</span> <span class="n">err_match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                      <span class="n">target_state</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">state_match_index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)][</span><span class="s1">&#39;States&#39;</span><span class="p">]:</span>
                    <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state_match_index</span><span class="p">)</span>
                    <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)][</span><span class="s1">&#39;Stability&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">charM_all</span><span class="p">[</span><span class="n">state_match_index</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span><span class="p">,</span> <span class="n">sols_list</span><span class="p">,</span> <span class="n">states_dict</span><span class="p">,</span> <span class="n">sig_test_set</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_transition_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">states_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                                  <span class="n">sig_test_set</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                                  <span class="n">solsM_allo</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                                  <span class="n">charM_allo</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                                  <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="n">remove_inaccessible_states</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">save_graph_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">n_max_steps</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">output_nodes_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">set</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="n">MultiDiGraph</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This method builds the Network Finite State Machine by starting the system</span>
<span class="sd">        in different equilibrium states, applying different input signals, and seeing</span>
<span class="sd">        which equilibrium state the system ends up in after</span>
<span class="sd">        a time simulation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states_dict : dict</span>
<span class="sd">            A dictionary with keys as tuples representing each input state, and values being the equilibrium</span>
<span class="sd">            state index as the column index of `solsM`. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">        sig_test_set : list|ndarray</span>
<span class="sd">            An array containing each of the input states (i.e. all binary-node-level combinations of</span>
<span class="sd">            `BooleanNet.input_node_inds`) which were applied to the network, for which equilibrium states</span>
<span class="sd">            of the network were found. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">        solsM_allo : ndarray</span>
<span class="sd">            The matrix of unique equilibrium state solutions, with each solution appearing in columns, and each row</span>
<span class="sd">            representing the node expression level. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">        charM_allo : ndarray</span>
<span class="sd">            The dynamic characterization of each equilibrium state in solsM, as a linear array of</span>
<span class="sd">            [`EquilibriumType`][cellnition.science.network_models.network_enums.EquilibriumType]</span>
<span class="sd">            enumerations. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">        verbose : bool, default: True</span>
<span class="sd">            Print output while solving (`True`)?</span>
<span class="sd">        remove_inaccessible_states : bool, default: False</span>
<span class="sd">            If there are states in the NFSM that aren&#39;t reachable by any other state, remove them? (Don&#39;t think</span>
<span class="sd">            this variable currently works).</span>
<span class="sd">        save_graph_file: str|None, default: None</span>
<span class="sd">            Full directory and filename to save a gml format graph of the resulting G-NFSM.</span>
<span class="sd">        n_max_steps: int, default: 10</span>
<span class="sd">            The maximum number of steps that the Boolean regulatory network solver should use in</span>
<span class="sd">            determining each eq&#39;m. It is recommended that `n_max_steps` be greater than twice the</span>
<span class="sd">            total node number (i.e. `n_max_steps &gt;= 2*BooleanNet.N_nodes`).</span>
<span class="sd">        output_nodes_only: bool, default: False</span>
<span class="sd">            Define the uniqueness of equilibrium states using only the `BooleanNet.output_node_inds` (`True`) or</span>
<span class="sd">            by using all non-input node inds using `BooleanNet.noninput_node_inds` (`False`)?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        transition_edges_set : set</span>
<span class="sd">            Set containing tuples defining all edges representing transitions of the general-NFSM (G-NFSM).</span>
<span class="sd">            Each tuple marks the transition from eq&#39;m state i to j under the action of input state k, so (i, j, k).</span>
<span class="sd">            Eq&#39;m state indices are to the columns of `solsM_allo`, and input state indices are to `sig_test_set`.</span>
<span class="sd">            Note, as new eq&#39;m states</span>
<span class="sd">            may be detected during the run of this method, `self._solsM_all` and `self._charM_all` should be used to</span>
<span class="sd">            reference eq&#39;m states and their characterization instead of the original `solsM_allo` and `charM_allo`.</span>
<span class="sd">        perturbation_edges_set : set</span>
<span class="sd">            Set containing tuples defining all edges representing transitions of the event-driven NFSM (E-NFSM).</span>
<span class="sd">            Each tuple marks the transition from eq&#39;m state i to j under the action of transiently held input state k,</span>
<span class="sd">            where the system is returned to the base input state l, so (i, j, k, l).</span>
<span class="sd">            Eq&#39;m state indices are to the columns of `solsM_allo`, and input state indices are to `sig_test_set`.</span>
<span class="sd">            Note, as new eq&#39;m states may be detected during the run of this method,</span>
<span class="sd">            `self._solsM_all` and `self._charM_all` should be used to</span>
<span class="sd">            reference eq&#39;m states and their characterization instead of the original `solsM_allo` and `charM_allo`.</span>
<span class="sd">        GG : MultiDiGraph</span>
<span class="sd">            The networkx MultiDiGraph object representing the G-NFSM.</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># make a copy of solsM_all:</span>
        <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">solsM_allo</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">charM_all</span> <span class="o">=</span> <span class="n">charM_allo</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># make a copy of the states dict that&#39;s only used for modifications:</span>
        <span class="n">states_dict_2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">states_dict</span><span class="p">)</span>

        <span class="c1"># If desired, states can be defined as &quot;unique&quot; with respect to the output nodes only:</span>
        <span class="k">if</span> <span class="n">output_nodes_only</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span><span class="p">):</span>
            <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span>

        <span class="c1"># States for perturbation of the zero state inputs</span>
        <span class="c1"># Let&#39;s start the system off in the zero vector, then</span>
        <span class="c1"># temporarily perturb the system with each signal set and see what the final state is after</span>
        <span class="c1"># the perturbation.</span>

        <span class="n">sig_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span>

        <span class="n">transition_edges_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">perturbation_edges_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="n">num_step</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># We want to step through all &#39;held&#39; signals and potentially multistable states:</span>
        <span class="c1"># The &quot;base&quot; refers to the base context of the system:</span>
        <span class="k">for</span> <span class="n">base_input_label</span><span class="p">,</span> <span class="p">(</span><span class="n">sig_base_set</span><span class="p">,</span> <span class="n">sc_dict</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

            <span class="n">states_set</span> <span class="o">=</span> <span class="n">sc_dict</span><span class="p">[</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>

            <span class="c1"># Get an integer label for the &#39;bitstring&#39; of signal node inds defining the base:</span>
            <span class="c1"># base_input_label = self._get_integer_label(sig_base_set)</span>
            <span class="c1"># We want to use each state in states_set as the initial condition:</span>
            <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">states_set</span><span class="p">:</span>
            <span class="c1"># for si, cvect_co in enumerate(solsM_all.T): # step through all stable states</span>

                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing State </span><span class="si">{</span><span class="n">si</span><span class="si">}</span><span class="s2"> in held context I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

                <span class="n">cvect_co</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="p">[:,</span> <span class="n">si</span><span class="p">]</span>

                <span class="c1"># Initial state vector, which will be held at the base_input context</span>
                <span class="n">cvect_co</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_base_set</span>
                <span class="c1"># ensure that this initial state is indeed stable in the context:</span>
                <span class="n">cvect_c</span><span class="p">,</span> <span class="n">char_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_state_compute</span><span class="p">(</span><span class="n">cvect_co</span><span class="p">,</span>
                                                               <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                               <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                               <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                               <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                               <span class="n">constraint_vals</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sig_base_set</span><span class="p">),</span>
                                                               <span class="p">)</span>

                <span class="n">initial_state</span><span class="p">,</span> <span class="n">match_error_initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                      <span class="n">cvect_c</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">match_error_initial</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>  <span class="c1"># if held state is unmatched, send warning...</span>
                    <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">cvect_c</span><span class="p">))</span>
                    <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">charM_all</span><span class="p">,</span> <span class="n">char_c</span><span class="p">))</span>
                    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

                    <span class="c1"># Update the states listing for this input state set</span>
                    <span class="n">sc_dict2</span> <span class="o">=</span> <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>
                    <span class="n">sc_dict2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
                    <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc_dict2</span>

                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING: Initial state not found (error </span><span class="si">{</span><span class="n">match_error_initial</span><span class="si">}</span><span class="s1">);&#39;</span>
                              <span class="sa">f</span><span class="s1">&#39; adding new state </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> to the solution set...&#39;</span><span class="p">)</span>

                <span class="c1"># Add this transition to the state transition diagram:</span>
                <span class="n">transition_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">si</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">base_input_label</span><span class="p">))</span>

                <span class="c1"># We then step through all possible perturbation signals that act on the state in the set:</span>
                <span class="n">cvect_ho</span> <span class="o">=</span> <span class="n">cvect_c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">pert_input_label</span><span class="p">,</span> <span class="p">(</span><span class="n">sig_pert_set</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Step: </span><span class="si">{</span><span class="n">num_step</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;...State </span><span class="si">{</span><span class="n">si</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> via I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>


                    <span class="n">cvect_ho</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_pert_set</span> <span class="c1"># apply the perturbation to the state</span>
                    <span class="n">cvect_h</span><span class="p">,</span> <span class="n">char_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_state_compute</span><span class="p">(</span><span class="n">cvect_ho</span><span class="p">,</span>
                                                               <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                               <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                               <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                               <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                               <span class="n">constraint_vals</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sig_pert_set</span><span class="p">),</span>
                                                               <span class="p">)</span>

                    <span class="c1"># FIXME: the find_state_match method should use the equm&#39; char as well as the state values!</span>
                    <span class="c1"># match the network state to one that only involves the hub nodes:</span>
                    <span class="n">held_state</span><span class="p">,</span> <span class="n">match_error_held</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                                <span class="n">cvect_h</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">match_error_held</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span> <span class="c1"># if held state is unmatched, flag it with a nan</span>
                        <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">cvect_h</span><span class="p">))</span>
                        <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">charM_all</span><span class="p">,</span> <span class="n">char_h</span><span class="p">))</span>
                        <span class="n">held_state</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

                        <span class="n">sc_dict2</span> <span class="o">=</span> <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>
                        <span class="n">sc_dict2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">held_state</span><span class="p">)</span>
                        <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc_dict2</span>

                        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING: Held state not found (error </span><span class="si">{</span><span class="n">match_error_held</span><span class="si">}</span><span class="s1">); &#39;</span>
                                  <span class="sa">f</span><span class="s1">&#39;adding new state </span><span class="si">{</span><span class="n">held_state</span><span class="si">}</span><span class="s1"> to the solution set...&#39;</span><span class="p">)</span>

                    <span class="n">transition_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">held_state</span><span class="p">,</span> <span class="n">pert_input_label</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;...State </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">held_state</span><span class="si">}</span><span class="s1"> via I</span><span class="si">{</span><span class="n">pert_input_label</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>

                    <span class="c1"># Next, re-apply the initial context input state to the held state and see what final state results:</span>
                    <span class="n">cvect_h</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_base_set</span>

                    <span class="c1"># find the stable state that results from re-applying the context input state to the held state:</span>
                    <span class="n">cvect_f</span><span class="p">,</span> <span class="n">char_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_state_compute</span><span class="p">(</span><span class="n">cvect_h</span><span class="p">,</span>
                                                               <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                               <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                               <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                               <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                               <span class="n">constraint_vals</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sig_base_set</span><span class="p">),</span>
                                                               <span class="p">)</span>

                    <span class="n">final_state</span><span class="p">,</span> <span class="n">match_error_final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                          <span class="n">cvect_f</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">])</span>
                    <span class="c1"># held_state, match_error_held = self._find_state_match(solsM_all, c_held)</span>

                    <span class="k">if</span> <span class="n">match_error_final</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span> <span class="c1"># if state is unmatched, flag it</span>
                        <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">cvect_f</span><span class="p">))</span>
                        <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">charM_all</span><span class="p">,</span> <span class="n">char_f</span><span class="p">))</span>
                        <span class="n">final_state</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="mi">1</span>

                        <span class="n">sc_dict2</span> <span class="o">=</span> <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>
                        <span class="n">sc_dict2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_state</span><span class="p">)</span>
                        <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc_dict2</span>

                        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING: Final state not found (error </span><span class="si">{</span><span class="n">match_error_final</span><span class="si">}</span><span class="s1">); &#39;</span>
                                  <span class="sa">f</span><span class="s1">&#39;adding new state </span><span class="si">{</span><span class="n">final_state</span><span class="si">}</span><span class="s1"> to the solution set...&#39;</span><span class="p">)</span>

                    <span class="n">transition_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">held_state</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="n">base_input_label</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;...State </span><span class="si">{</span><span class="n">held_state</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">final_state</span><span class="si">}</span><span class="s1"> via I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="c1"># Look for change in the system from initial to final state:</span>

                    <span class="k">if</span> <span class="n">initial_state</span> <span class="o">!=</span> <span class="n">final_state</span><span class="p">:</span>  <span class="c1"># add this to the perturbed transitions:</span>
                        <span class="n">perturbation_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="n">pert_input_label</span><span class="p">,</span> <span class="n">base_input_label</span><span class="p">))</span>

                        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Event-driven transition identified from State </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">final_state</span><span class="si">}</span><span class="s1"> via &#39;</span>
                                  <span class="sa">f</span><span class="s1">&#39;event I</span><span class="si">{</span><span class="n">pert_input_label</span><span class="si">}</span><span class="s1"> under context I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="n">num_step</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># if verbose:</span>
                    <span class="c1">#     # print(f&#39;Match errors {match_error_initial, match_error_held, match_error_final}&#39;)</span>
                    <span class="c1">#     print(&#39;------&#39;)</span>

        <span class="c1"># The first thing we do after the construction of the</span>
        <span class="c1"># transition edges set is make a multidigraph and</span>
        <span class="c1"># use networkx to pre-process &amp; simplify it, removing inaccessible states</span>
        <span class="c1"># (states with no non-self input degree)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_solsM_all</span> <span class="o">=</span> <span class="n">solsM_all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_states_dict</span> <span class="o">=</span> <span class="n">states_dict_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sig_test_set</span> <span class="o">=</span> <span class="n">sig_test_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_charM_all</span> <span class="o">=</span> <span class="n">charM_all</span>
        <span class="c1"># self._charM_all = np.hstack((self._charM_all, charM_ext))</span>

        <span class="c1"># Create the multidigraph:</span>
        <span class="n">GG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ndei</span><span class="p">,</span> <span class="n">ndej</span><span class="p">,</span> <span class="n">trans_label_ij</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">transition_edges_set</span><span class="p">):</span>
            <span class="c1"># Annoyingly, nodes must be strings in order to save properly...</span>
            <span class="n">GG</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ndei</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">ndej</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;I</span><span class="si">{</span><span class="n">trans_label_ij</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">remove_inaccessible_states</span><span class="p">:</span>
            <span class="c1"># Remove nodes that have no input degree other than their own self-loop:</span>
            <span class="n">nodes_with_selfloops</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">nodes_with_selfloops</span><span class="p">(</span><span class="n">GG</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">node_lab</span><span class="p">,</span> <span class="n">node_in_deg</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">GG</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">node_in_deg</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">node_lab</span> <span class="ow">in</span> <span class="n">nodes_with_selfloops</span><span class="p">)</span> <span class="ow">or</span> <span class="n">node_in_deg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">GG</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node_lab</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save_graph_file</span><span class="p">:</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">write_gml</span><span class="p">(</span><span class="n">GG</span><span class="p">,</span> <span class="n">save_graph_file</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">G_states</span> <span class="o">=</span> <span class="n">GG</span>

        <span class="k">return</span> <span class="n">transition_edges_set</span><span class="p">,</span> <span class="n">perturbation_edges_set</span><span class="p">,</span> <span class="n">GG</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_state_transition_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="n">nodes_listo</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                                      <span class="n">edges_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                                      <span class="n">charM_all</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                                      <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                      <span class="n">graph_layout</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span>
                                      <span class="n">mono_edge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">rank</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
                                      <span class="n">constraint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">concentrate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                      <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">18.0</span><span class="p">,</span>
                                      <span class="n">node_colors</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                      <span class="n">cmap_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;rainbow_r&#39;</span><span class="p">,</span>
                                      <span class="n">transp_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;80&#39;</span><span class="p">,</span>
                                      <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This method creates a plot of a general network finite state machine (G-NFSM), which has nodes representing</span>
<span class="sd">        equilibrium states of a regulatory network, edges as the transition between two equilibrium states, and</span>
<span class="sd">        the label on each edge representing the input state index applied and held to transition the network</span>
<span class="sd">        between the two equilibrium states. The result is saved to an image file on disk.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nodes_listo : list</span>
<span class="sd">            List of nodes forming the G-NFSM.</span>
<span class="sd">        edges_list : list</span>
<span class="sd">            List of edges forming the G-NFSM.</span>
<span class="sd">        charM_all : list|ndarray</span>
<span class="sd">            The dynamic characteristic of all unique equilbrium states.</span>
<span class="sd">        save_file : str|None, default: None</span>
<span class="sd">            The complete directory and filename to save an image of the G-NFSM graph (as &#39;png&#39; or &#39;svg&#39;).</span>
<span class="sd">        graph_layout : str, default:&#39;dot&#39;</span>
<span class="sd">            Graphviz layout for the graph.</span>
<span class="sd">        mono_edge : bool, default: False</span>
<span class="sd">            Merge close edges into a single path (`True`)?</span>
<span class="sd">        rank : str, default:&#39;same&#39;</span>
<span class="sd">            Graphviz rank key.</span>
<span class="sd">        constraint : bool, default: False</span>
<span class="sd">            Graphviz constraint key.</span>
<span class="sd">        concentrate : bool, default: True</span>
<span class="sd">            Graphviz concentrate key.</span>
<span class="sd">        fontsize : float, default: 18.0</span>
<span class="sd">            Font size to use on node labels.</span>
<span class="sd">        node_colors : list|None, default: None</span>
<span class="sd">            Values that should be mapped to nodes (e.g. these may be distance from a &#39;cancer&#39; state).</span>
<span class="sd">        cmap_str : str, default: &#39;rainbow_r&#39;</span>
<span class="sd">            Colormap to use to color the nodes.</span>
<span class="sd">        transp_str : str, default: &#39;80&#39;</span>
<span class="sd">            Transparancy (as a hex value) to lighten the node coloring.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AGraph</span>
<span class="sd">            The pygraphviz object representing the G-NFSM.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Convert nodes from string to int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_charM_all</span> <span class="o">=</span> <span class="n">charM_all</span>
        <span class="n">nodes_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">nodes_listo</span><span class="p">]</span>
        <span class="n">img_pos</span> <span class="o">=</span> <span class="s1">&#39;bc&#39;</span>  <span class="c1"># position of the glyph in the node</span>
        <span class="n">subcluster_font</span> <span class="o">=</span> <span class="s1">&#39;DejaVu Sans Bold&#39;</span>
        <span class="n">node_shape</span> <span class="o">=</span> <span class="s1">&#39;ellipse&#39;</span>
        <span class="n">clr_map</span> <span class="o">=</span> <span class="n">cmap_str</span>
        <span class="n">nde_font_color</span> <span class="o">=</span> <span class="s1">&#39;Black&#39;</span>
        <span class="n">hex_transparency</span> <span class="o">=</span> <span class="n">transp_str</span>

        <span class="c1"># Try to make a nested graph:</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">pgv</span><span class="o">.</span><span class="n">AGraph</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="n">mono_edge</span><span class="p">,</span>
                       <span class="n">fontname</span><span class="o">=</span><span class="n">subcluster_font</span><span class="p">,</span>
                       <span class="n">splines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">concentrate</span><span class="o">=</span><span class="n">concentrate</span><span class="p">,</span>
                       <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span>
                       <span class="n">rank</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span>
                       <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormaps</span><span class="p">[</span><span class="n">clr_map</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">node_colors</span><span class="p">),</span>
                                    <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">node_colors</span><span class="p">))</span>

        <span class="c1"># Add all the nodes:</span>
        <span class="k">for</span> <span class="n">nde_i</span> <span class="ow">in</span> <span class="n">nodes_list</span><span class="p">:</span>
            <span class="n">nde_lab</span> <span class="o">=</span> <span class="n">nde_i</span>
            <span class="n">nde_index</span> <span class="o">=</span> <span class="n">nodes_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nde_i</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nde_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">nde_lab</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nde_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">node_colors</span><span class="p">[</span><span class="n">nde_lab</span><span class="p">])))</span>

            <span class="n">nde_color</span> <span class="o">+=</span> <span class="n">hex_transparency</span>  <span class="c1"># add some transparancy to the node</span>

            <span class="n">char_i</span> <span class="o">=</span> <span class="n">charM_all</span><span class="p">[</span><span class="n">nde_i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="c1"># Get the stability characterization for this state</span>

            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">nde_i</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">nde_lab</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                           <span class="n">labelloc</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                           <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">char_i</span><span class="p">],</span>
                           <span class="n">imagepos</span><span class="o">=</span><span class="n">img_pos</span><span class="p">,</span>
                           <span class="n">shape</span><span class="o">=</span><span class="n">node_shape</span><span class="p">,</span>
                           <span class="n">fontcolor</span><span class="o">=</span><span class="n">nde_font_color</span><span class="p">,</span>
                           <span class="n">style</span><span class="o">=</span><span class="s1">&#39;filled&#39;</span><span class="p">,</span>
                           <span class="n">fillcolor</span><span class="o">=</span><span class="n">nde_color</span><span class="p">)</span>


        <span class="c1"># Add all the edges:</span>
        <span class="k">for</span> <span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">,</span> <span class="n">trans_ij</span> <span class="ow">in</span> <span class="n">edges_list</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">trans_ij</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="n">graph_layout</span><span class="p">)</span>
            <span class="n">G</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">G</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_state_perturbation_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                       <span class="n">pert_edges_set</span><span class="p">:</span> <span class="nb">set</span><span class="p">,</span>
                                       <span class="n">charM_all</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                                       <span class="n">nodes_listo</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                                       <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="n">graph_layout</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;dot&#39;</span><span class="p">,</span>
                                       <span class="n">mono_edge</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">rank</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;same&#39;</span><span class="p">,</span>
                                       <span class="n">constraint</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">concentrate</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">18.0</span><span class="p">,</span>
                                       <span class="n">node_colors</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                        <span class="n">cmap_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;rainbow_r&#39;</span><span class="p">,</span>
                                        <span class="n">transp_str</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;80&#39;</span><span class="p">,</span>
                                        <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This method creates a plot of an event-driven network finite state machine (E-NFSM), which has nodes representing</span>
<span class="sd">        equilibrium states of a regulatory network, edges as the transition between two equilibrium states occuring under</span>
<span class="sd">        the application of a transiently applied input signal, and a more &#39;permanent&#39; input signal to which the</span>
<span class="sd">        system returns after the transient perturbation.</span>

<span class="sd">        An input state can be associated with several possible equilibrium</span>
<span class="sd">        states if the network has multistability. If this is the case, then the</span>
<span class="sd">        equilibrium state that the system transitions to depends not only on the applied input</span>
<span class="sd">        state, but also the equilibrium state that the system is in to begin with.</span>

<span class="sd">        To capture this path dependency, here we create a graph with subgraphs, where each subgraph</span>
<span class="sd">        represents the possible states for a</span>
<span class="sd">        held input state (the &#39;held context&#39; case is represented by the subgraph).</span>
<span class="sd">        In the case of multistability, temporary</span>
<span class="sd">        perturbations to the held input state can result in transitions between</span>
<span class="sd">        the multistable states. The</span>
<span class="sd">        sub-graph indicates which temporarily-applied input signal leads to which state</span>
<span class="sd">        transition via the edge label. Input signal states are represented as</span>
<span class="sd">        integers, where the integer codes for a binary bit string of signal state values; equilibrium states</span>
<span class="sd">        are indexed according to their column index in solsM_all.</span>

<span class="sd">        The result is saved to an image file on disk.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nodes_listo : list</span>
<span class="sd">            List of nodes forming the E-NFSM.</span>
<span class="sd">        pert_edges_set : set</span>
<span class="sd">            List of edges forming the E-NFSM.</span>
<span class="sd">        charM_all : list|ndarray</span>
<span class="sd">            The dynamic characteristic of all unique equilbrium states.</span>
<span class="sd">        save_file : str|None, default: None</span>
<span class="sd">            The complete directory and filename to save an image of the E-NFSM graph (as &#39;png&#39; or &#39;svg&#39;).</span>
<span class="sd">        graph_layout : str, default:&#39;dot&#39;</span>
<span class="sd">            Graphviz layout for the graph.</span>
<span class="sd">        mono_edge : bool, default: False</span>
<span class="sd">            Merge close edges into a single path (`True`)?</span>
<span class="sd">        rank : str, default:&#39;same&#39;</span>
<span class="sd">            Graphviz rank key.</span>
<span class="sd">        constraint : bool, default: False</span>
<span class="sd">            Graphviz constraint key.</span>
<span class="sd">        concentrate : bool, default: True</span>
<span class="sd">            Graphviz concentrate key.</span>
<span class="sd">        fontsize : float, default: 18.0</span>
<span class="sd">            Font size to use on node labels.</span>
<span class="sd">        node_colors : list|None, default: None</span>
<span class="sd">            Values that should be mapped to nodes (e.g. these may be distance from a &#39;cancer&#39; state).</span>
<span class="sd">        cmap_str : str, default: &#39;rainbow_r&#39;</span>
<span class="sd">            Colormap to use to color the nodes.</span>
<span class="sd">        transp_str : str, default: &#39;80&#39;</span>
<span class="sd">            Transparancy (as a hex value) to lighten the node coloring.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AGraph</span>
<span class="sd">            The pygraphviz object representing the E-NFSM.</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="n">nodes_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">nodes_listo</span><span class="p">]</span> <span class="c1"># convert nodes from string to int</span>

        <span class="n">img_pos</span> <span class="o">=</span> <span class="s1">&#39;bc&#39;</span>  <span class="c1"># position of the glyph in the node</span>
        <span class="n">subcluster_font</span> <span class="o">=</span> <span class="s1">&#39;DejaVu Sans Bold&#39;</span>
        <span class="n">node_shape</span> <span class="o">=</span> <span class="s1">&#39;ellipse&#39;</span>
        <span class="n">clr_map</span> <span class="o">=</span> <span class="n">cmap_str</span>
        <span class="n">nde_font_color</span> <span class="o">=</span> <span class="s1">&#39;Black&#39;</span>
        <span class="n">hex_transparency</span> <span class="o">=</span> <span class="n">transp_str</span>

        <span class="c1"># Make a nested graph with compound=True keyword:</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">pgv</span><span class="o">.</span><span class="n">AGraph</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="n">mono_edge</span><span class="p">,</span>
                       <span class="n">fontname</span><span class="o">=</span><span class="n">subcluster_font</span><span class="p">,</span>
                       <span class="n">splines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">concentrate</span><span class="o">=</span><span class="n">concentrate</span><span class="p">,</span>
                       <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span>
                       <span class="n">compound</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">rank</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span>
                       <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormaps</span><span class="p">[</span><span class="n">clr_map</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">node_colors</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">node_colors</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">st_i</span><span class="p">,</span> <span class="n">st_f</span><span class="p">,</span> <span class="n">i_pert</span><span class="p">,</span> <span class="n">i_base</span> <span class="ow">in</span> <span class="n">pert_edges_set</span><span class="p">:</span>
            <span class="c1"># Add in a subgraph box for the &quot;held&quot; input node state:</span>
            <span class="n">Gsub</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">add_subgraph</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;cluster_</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Held at I</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># next add-in nodes for the initial state:</span>
            <span class="n">nde_i_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">st_i</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span> <span class="c1"># node name is in terms of the subgraph box index</span>
            <span class="n">nde_i_lab</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">st_i</span><span class="si">}</span><span class="s1">&#39;</span>

            <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nde_i_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">st_i</span><span class="p">)))</span>
                <span class="n">nde_f_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">st_f</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nde_i_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">node_colors</span><span class="p">[</span><span class="n">st_i</span><span class="p">])))</span>
                <span class="n">nde_f_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">node_colors</span><span class="p">[</span><span class="n">st_f</span><span class="p">])))</span>

            <span class="n">nde_i_color</span> <span class="o">+=</span> <span class="n">hex_transparency</span>  <span class="c1"># add some transparency to the node</span>
            <span class="n">nde_f_color</span> <span class="o">+=</span> <span class="n">hex_transparency</span>  <span class="c1"># add some transparency to the node</span>

            <span class="n">chr_i</span> <span class="o">=</span> <span class="n">charM_all</span><span class="p">[</span><span class="n">st_i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

            <span class="n">Gsub</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">nde_i_name</span><span class="p">,</span>
                          <span class="n">label</span><span class="o">=</span><span class="n">nde_i_lab</span><span class="p">,</span>
                          <span class="n">labelloc</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                          <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">chr_i</span><span class="p">],</span>
                          <span class="n">imagepos</span><span class="o">=</span><span class="n">img_pos</span><span class="p">,</span>
                          <span class="n">shape</span><span class="o">=</span><span class="n">node_shape</span><span class="p">,</span>
                          <span class="n">fontcolor</span><span class="o">=</span><span class="n">nde_font_color</span><span class="p">,</span>
                          <span class="n">style</span><span class="o">=</span><span class="s1">&#39;filled&#39;</span><span class="p">,</span>
                          <span class="n">fillcolor</span><span class="o">=</span><span class="n">nde_i_color</span>
                          <span class="p">)</span>

            <span class="c1"># ...and for the final state:</span>
            <span class="n">nde_f_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">st_f</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span> <span class="c1"># node name is in terms of the subgraph box index</span>
            <span class="n">nde_f_lab</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">st_f</span><span class="si">}</span><span class="s1">&#39;</span>


            <span class="n">chr_f</span> <span class="o">=</span> <span class="n">charM_all</span><span class="p">[</span><span class="n">st_f</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

            <span class="n">Gsub</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">nde_f_name</span><span class="p">,</span>
                          <span class="n">label</span><span class="o">=</span><span class="n">nde_f_lab</span><span class="p">,</span>
                          <span class="n">labelloc</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                          <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">chr_f</span><span class="p">],</span>
                          <span class="n">imagepos</span><span class="o">=</span><span class="n">img_pos</span><span class="p">,</span>
                          <span class="n">shape</span><span class="o">=</span><span class="n">node_shape</span><span class="p">,</span>
                          <span class="n">fontcolor</span><span class="o">=</span><span class="n">nde_font_color</span><span class="p">,</span>
                          <span class="n">style</span><span class="o">=</span><span class="s1">&#39;filled&#39;</span><span class="p">,</span>
                          <span class="n">fillcolor</span><span class="o">=</span><span class="n">nde_f_color</span>
                          <span class="p">)</span>

            <span class="n">Gsub</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">nde_i_name</span><span class="p">,</span> <span class="n">nde_f_name</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;I</span><span class="si">{</span><span class="n">i_pert</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="n">graph_layout</span><span class="p">)</span>
            <span class="n">G</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">G</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sim_sequence_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">starting_state</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                                <span class="n">solsM_all</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                                <span class="n">inputs_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                                <span class="n">sig_test_set</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                                <span class="n">n_seq_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                                <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">match_tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span>
                                <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">cc_o</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="p">[:,</span> <span class="n">starting_state</span><span class="p">]</span> <span class="c1"># obtain the starting state of the system</span>

        <span class="n">sigs_vect_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sig_nme</span> <span class="ow">in</span> <span class="n">inputs_list</span><span class="p">:</span>
            <span class="n">sig_i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sig_nme</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="c1"># get the integer representing the input state</span>
            <span class="n">sigs_vect_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">[</span><span class="n">sig_i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="c1"># append the complete input signal to the list</span>

        <span class="n">seq_tvect</span><span class="p">,</span> <span class="n">seq_res</span><span class="p">,</span> <span class="n">sol_res</span><span class="p">,</span> <span class="n">sol_char_res</span><span class="p">,</span> <span class="n">phase_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_multisequence_compute</span><span class="p">(</span><span class="n">cc_o</span><span class="p">,</span>
                                                                              <span class="n">sigs_vect_list</span><span class="p">,</span>
                                                                              <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                                              <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_seq_steps</span><span class="p">,</span>
                                                                              <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                                              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">matched_states</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">matched_char</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">cc_new</span><span class="p">,</span> <span class="n">char_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sol_res</span><span class="p">,</span> <span class="n">sol_char_res</span><span class="p">):</span>
            <span class="n">new_state</span><span class="p">,</span> <span class="n">match_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                           <span class="n">cc_new</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">])</span>
            <span class="n">matched_states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
            <span class="n">matched_char</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char_new</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">match_error</span> <span class="o">&lt;</span> <span class="n">match_tol</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Detected State </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s1">, with error </span><span class="si">{</span><span class="n">match_error</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING! Best match State </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s1"> exceeds match_error with error </span><span class="si">{</span><span class="n">match_error</span><span class="si">}</span><span class="s1">!&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">seq_tvect</span><span class="p">,</span> <span class="n">seq_res</span><span class="p">,</span> <span class="n">matched_states</span><span class="p">,</span> <span class="n">matched_char</span><span class="p">,</span> <span class="n">phase_inds</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_sequence_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">c_time</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                             <span class="n">tvectr</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                             <span class="n">phase_inds</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                             <span class="n">matched_states</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                             <span class="n">char_states</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                             <span class="n">gene_plot_inds</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                             <span class="n">state_label_offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
                             <span class="n">glyph_zoom</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
                             <span class="n">glyph_alignment</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">),</span>
                             <span class="n">fontsize</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                             <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">legend</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">gene_plot_inds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">main_c</span> <span class="o">=</span> <span class="n">c_time</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">main_c</span> <span class="o">=</span> <span class="n">c_time</span><span class="p">[:,</span> <span class="n">gene_plot_inds</span><span class="p">]</span>

        <span class="n">N_plot_genes</span> <span class="o">=</span> <span class="n">main_c</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Resize the figure to fit the panel of plotted genes:</span>
        <span class="n">fig_width</span> <span class="o">=</span> <span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fig_height</span> <span class="o">=</span> <span class="n">figsize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="o">*</span><span class="n">N_plot_genes</span><span class="p">)</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">N_plot_genes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">main_c</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
            <span class="c1"># gene_lab = f&#39;Gene {ii}&#39;</span>
            <span class="n">gene_lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">nodes_list</span><span class="p">)[</span><span class="n">gene_plot_inds</span><span class="p">[</span><span class="n">ii</span><span class="p">]]</span>
            <span class="n">lineplt</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tvectr</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">gene_lab</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span>  <span class="c1"># plot the time series</span>
            <span class="c1"># annotate the plot with the matched state:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">pj</span><span class="p">),</span> <span class="n">stateio</span><span class="p">,</span> <span class="n">chario</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">phase_inds</span><span class="p">,</span> <span class="n">matched_states</span><span class="p">,</span> <span class="n">char_states</span><span class="p">):</span>
                <span class="n">statei</span> <span class="o">=</span> <span class="n">stateio</span>

                <span class="n">char_i</span> <span class="o">=</span> <span class="n">chario</span><span class="o">.</span><span class="n">name</span>
                <span class="n">char_i_fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">char_i</span><span class="p">]</span>
                <span class="n">logo</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">char_i_fname</span><span class="p">)</span>
                <span class="n">imagebox</span> <span class="o">=</span> <span class="n">OffsetImage</span><span class="p">(</span><span class="n">logo</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">glyph_zoom</span><span class="p">)</span>
                <span class="n">pmid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">pi</span> <span class="o">+</span> <span class="n">pj</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">tmid</span> <span class="o">=</span> <span class="n">tvectr</span><span class="p">[</span><span class="n">pmid</span><span class="p">]</span>
                <span class="n">cc_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="n">pi</span><span class="p">:</span><span class="n">pj</span><span class="p">])</span>
                <span class="n">cmid</span> <span class="o">=</span> <span class="n">cc_max</span> <span class="o">+</span> <span class="n">state_label_offset</span>

                <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tmid</span><span class="p">,</span> <span class="n">cmid</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">statei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

                <span class="n">ab</span> <span class="o">=</span> <span class="n">AnnotationBbox</span><span class="p">(</span><span class="n">imagebox</span><span class="p">,</span>
                                    <span class="p">(</span><span class="n">tmid</span><span class="p">,</span> <span class="n">cmid</span><span class="p">),</span>
                                    <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">box_alignment</span><span class="o">=</span><span class="n">glyph_alignment</span><span class="p">)</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>

                <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Expression Probability&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_state_distance_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solsM_all</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a matrix representing the L2 norm &#39;distance&#39;</span>
<span class="sd">        between each state in the array of all possible states.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">num_sols</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">state_distance_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_sols</span><span class="p">,</span> <span class="n">num_sols</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sols</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sols</span><span class="p">):</span>
                <span class="c1"># d_states = np.sqrt(np.sum((solsM_all[:,i] - solsM_all[:, j])**2))</span>
                <span class="n">d_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                            <span class="n">solsM_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                <span class="n">state_distance_M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_states</span>

        <span class="k">return</span> <span class="n">state_distance_M</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_input_signals_from_label_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig_test_set</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Would be very useful to have a lookup dictionary between the integer input</span>
        <span class="c1"># state label and the original signals tuple:</span>
        <span class="n">input_int_to_signals</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">int_label</span><span class="p">,</span> <span class="n">input_sigs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">):</span>
            <span class="c1"># int_label = self._get_integer_label(input_sigs)</span>
            <span class="n">input_int_to_signals</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;I</span><span class="si">{</span><span class="n">int_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">input_sigs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">input_int_to_signals</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_order_states_by_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Re-arrange the supplied solution matrix so that the states are</span>
<span class="sd">        progressively closer to one another, in order to see a more</span>
<span class="sd">        logical transition through the network with perturbation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">zer_sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">dist_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">soli</span> <span class="ow">in</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="c1"># calculate the &quot;distance&quot; between the two solutions</span>
            <span class="c1"># and append to the distance list:</span>
            <span class="n">dist_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">zer_sol</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">]</span> <span class="o">-</span>
                                             <span class="n">soli</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>

        <span class="n">inds_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dist_list</span><span class="p">)</span>

        <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="p">[:,</span> <span class="n">inds_sort</span><span class="p">]</span>
        <span class="n">charM_all</span> <span class="o">=</span> <span class="n">charM_all</span><span class="p">[</span><span class="n">inds_sort</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_index_from_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val_vect</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">val_overlap</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Given a value in an array, this method returns the index</span>
<span class="sd">        of the closest value in the array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        val_vect : ndarray</span>
<span class="sd">            The vector of values to which the closest index to val is sought.</span>

<span class="sd">        val: float</span>
<span class="sd">            A value for which the closest matched index in val_vect is to be</span>
<span class="sd">            returned.</span>

<span class="sd">        val_overlap: float</span>
<span class="sd">            An amount of overlap to include in search windows to ensure the</span>
<span class="sd">            search will return at least one index.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">inds_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">val_vect</span> <span class="o">&lt;=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">val_overlap</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">inds_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">val_vect</span> <span class="o">&gt;=</span> <span class="n">val</span> <span class="o">-</span> <span class="n">val_overlap</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">inds_l</span><span class="p">,</span> <span class="n">inds_h</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indo</span><span class="p">):</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">indo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No matching index was found.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ind</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_state_match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">solsM</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                         <span class="n">cvecti</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Given a matrix of possible states and a concentration vector,</span>
<span class="sd">        return the state that best-matches the concentration vector,</span>
<span class="sd">        along with an error for the comparison.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        solsM : ndarray</span>
<span class="sd">            A matrix with a set of steady-state solutions arranged in</span>
<span class="sd">            columns.</span>

<span class="sd">        cvecti : list</span>
<span class="sd">            A list of concentrations with which to compare with each</span>
<span class="sd">            steady-state in solsM, in order to select a best-match state</span>
<span class="sd">            from solsM to cvecti.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        state_best_match</span>
<span class="sd">            The index of the best-match state in solsM</span>
<span class="sd">        err</span>
<span class="sd">            The error to the match</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># now what we need is a pattern match from concentrations to the stable states:</span>
        <span class="n">errM</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">soli</span> <span class="ow">in</span> <span class="n">solsM</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="n">sdiff</span> <span class="o">=</span> <span class="n">soli</span> <span class="o">-</span> <span class="n">cvecti</span>
            <span class="n">errM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sdiff</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>
        <span class="n">errM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">errM</span><span class="p">)</span>
        <span class="n">state_best_match</span> <span class="o">=</span> <span class="p">(</span><span class="n">errM</span> <span class="o">==</span> <span class="n">errM</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">state_best_match</span><span class="p">,</span> <span class="n">errM</span><span class="p">[</span><span class="n">state_best_match</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_input_words_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">sig_test_set</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                        <span class="n">gene_list</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                        <span class="n">figsave</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">save_format</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                        <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;magma&#39;</span>

        <span class="n">state_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;I</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sig_test_set</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

        <span class="n">gene_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_labels</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">gene_labels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state_labels</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">state_labels</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
                 <span class="n">rotation_mode</span><span class="o">=</span><span class="s2">&quot;anchor&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Expression Level&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">figsave</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figsave</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">save_format</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">bnet</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initialize the <code>BoolStateMachine</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bnet</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="cellnition.science.network_models.boolean_networks.BooleanNet" href="../../1%29%20GRN%20Model%20Building/network_models_boolean_networks/#cellnition.science.network_models.boolean_networks.BooleanNet">BooleanNet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of <a class="autorefs autorefs-internal" href="../../1%29%20GRN%20Model%20Building/network_models_boolean_networks/#cellnition.science.network_models.boolean_networks.BooleanNet"><code>BooleanNet</code></a>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bnet</span><span class="p">:</span> <span class="n">BooleanNet</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Initialize the `BoolStateMachine`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bnet : BooleanNet</span>
<span class="sd">        An instance of [`BooleanNet`][cellnition.science.network_models.boolean_networks.BooleanNet].</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span> <span class="o">=</span> <span class="n">bnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">G_states</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># The state transition network</span>

    <span class="c1"># Path to load image assets:</span>
    <span class="n">GLYPH_DIR</span> <span class="o">=</span> <span class="n">get_data_png_glyph_stability_dir</span><span class="p">()</span>
    <span class="n">attractor_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_attractor.png&#39;</span><span class="p">)</span>
    <span class="n">limitcycle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_limit_cycle.png&#39;</span><span class="p">)</span>
    <span class="n">saddle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_saddle.png&#39;</span><span class="p">)</span>
    <span class="n">attractor_limitcycle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_attractor_limit_cycle.png&#39;</span><span class="p">)</span>
    <span class="n">repellor_limitcycle_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_repellor_limit_cycle.png&#39;</span><span class="p">)</span>
    <span class="n">repellor_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_repellor.png&#39;</span><span class="p">)</span>
    <span class="n">unknown_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_unknown.png&#39;</span><span class="p">)</span>
    <span class="n">hidden_fname</span> <span class="o">=</span> <span class="n">FileRelative</span><span class="p">(</span><span class="n">GLYPH_DIR</span><span class="p">,</span> <span class="s1">&#39;glyph_hidden.png&#39;</span><span class="p">)</span>

    <span class="c1"># Associate each equilibrium type with an image file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">attractor_fname</span><span class="p">),</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">limit_cycle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">limitcycle_fname</span><span class="p">),</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">saddle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">saddle_fname</span><span class="p">),</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor_limit_cycle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">attractor_limitcycle_fname</span><span class="p">),</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor_limit_cycle</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">repellor_limitcycle_fname</span><span class="p">),</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">repellor_fname</span><span class="p">),</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">undetermined</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">unknown_fname</span><span class="p">),</span>
        <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">hidden</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">hidden_fname</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.create_transition_network" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_transition_network</span><span class="p">(</span><span class="n">states_dict</span><span class="p">,</span> <span class="n">sig_test_set</span><span class="p">,</span> <span class="n">solsM_allo</span><span class="p">,</span> <span class="n">charM_allo</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_inaccessible_states</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_graph_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_max_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">output_nodes_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This method builds the Network Finite State Machine by starting the system
in different equilibrium states, applying different input signals, and seeing
which equilibrium state the system ends up in after
a time simulation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>states_dict</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys as tuples representing each input state, and values being the equilibrium
state index as the column index of <code>solsM</code>. This is returned by `steady_state_solutions_search'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sig_test_set</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array containing each of the input states (i.e. all binary-node-level combinations of
<code>BooleanNet.input_node_inds</code>) which were applied to the network, for which equilibrium states
of the network were found. This is returned by `steady_state_solutions_search'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solsM_allo</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix of unique equilibrium state solutions, with each solution appearing in columns, and each row
representing the node expression level. This is returned by `steady_state_solutions_search'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>charM_allo</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dynamic characterization of each equilibrium state in solsM, as a linear array of
<a class="autorefs autorefs-internal" href="../../1%29%20GRN%20Model%20Building/network_models_network_enums/#cellnition.science.network_models.network_enums.EquilibriumType"><code>EquilibriumType</code></a>
enumerations. This is returned by `steady_state_solutions_search'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print output while solving (<code>True</code>)?</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_inaccessible_states</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there are states in the NFSM that aren't reachable by any other state, remove them? (Don't think
this variable currently works).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_graph_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Full directory and filename to save a gml format graph of the resulting G-NFSM.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_max_steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of steps that the Boolean regulatory network solver should use in
determining each eq'm. It is recommended that <code>n_max_steps</code> be greater than twice the
total node number (i.e. <code>n_max_steps &gt;= 2*BooleanNet.N_nodes</code>).</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_nodes_only</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Define the uniqueness of equilibrium states using only the <code>BooleanNet.output_node_inds</code> (<code>True</code>) or
by using all non-input node inds using <code>BooleanNet.noninput_node_inds</code> (<code>False</code>)?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>transition_edges_set</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#set">set</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set containing tuples defining all edges representing transitions of the general-NFSM (G-NFSM).
Each tuple marks the transition from eq'm state i to j under the action of input state k, so (i, j, k).
Eq'm state indices are to the columns of <code>solsM_allo</code>, and input state indices are to <code>sig_test_set</code>.
Note, as new eq'm states
may be detected during the run of this method, <code>self._solsM_all</code> and <code>self._charM_all</code> should be used to
reference eq'm states and their characterization instead of the original <code>solsM_allo</code> and <code>charM_allo</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>perturbation_edges_set</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#set">set</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set containing tuples defining all edges representing transitions of the event-driven NFSM (E-NFSM).
Each tuple marks the transition from eq'm state i to j under the action of transiently held input state k,
where the system is returned to the base input state l, so (i, j, k, l).
Eq'm state indices are to the columns of <code>solsM_allo</code>, and input state indices are to <code>sig_test_set</code>.
Note, as new eq'm states may be detected during the run of this method,
<code>self._solsM_all</code> and <code>self._charM_all</code> should be used to
reference eq'm states and their characterization instead of the original <code>solsM_allo</code> and <code>charM_allo</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>GG</code></td>            <td>
                  <code><span title="networkx.MultiDiGraph">MultiDiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The networkx MultiDiGraph object representing the G-NFSM.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_transition_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">states_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                              <span class="n">sig_test_set</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                              <span class="n">solsM_allo</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                              <span class="n">charM_allo</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                              <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                              <span class="n">remove_inaccessible_states</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">save_graph_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">n_max_steps</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                              <span class="n">output_nodes_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                              <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">set</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="n">MultiDiGraph</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This method builds the Network Finite State Machine by starting the system</span>
<span class="sd">    in different equilibrium states, applying different input signals, and seeing</span>
<span class="sd">    which equilibrium state the system ends up in after</span>
<span class="sd">    a time simulation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    states_dict : dict</span>
<span class="sd">        A dictionary with keys as tuples representing each input state, and values being the equilibrium</span>
<span class="sd">        state index as the column index of `solsM`. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">    sig_test_set : list|ndarray</span>
<span class="sd">        An array containing each of the input states (i.e. all binary-node-level combinations of</span>
<span class="sd">        `BooleanNet.input_node_inds`) which were applied to the network, for which equilibrium states</span>
<span class="sd">        of the network were found. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">    solsM_allo : ndarray</span>
<span class="sd">        The matrix of unique equilibrium state solutions, with each solution appearing in columns, and each row</span>
<span class="sd">        representing the node expression level. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">    charM_allo : ndarray</span>
<span class="sd">        The dynamic characterization of each equilibrium state in solsM, as a linear array of</span>
<span class="sd">        [`EquilibriumType`][cellnition.science.network_models.network_enums.EquilibriumType]</span>
<span class="sd">        enumerations. This is returned by `steady_state_solutions_search&#39;.</span>
<span class="sd">    verbose : bool, default: True</span>
<span class="sd">        Print output while solving (`True`)?</span>
<span class="sd">    remove_inaccessible_states : bool, default: False</span>
<span class="sd">        If there are states in the NFSM that aren&#39;t reachable by any other state, remove them? (Don&#39;t think</span>
<span class="sd">        this variable currently works).</span>
<span class="sd">    save_graph_file: str|None, default: None</span>
<span class="sd">        Full directory and filename to save a gml format graph of the resulting G-NFSM.</span>
<span class="sd">    n_max_steps: int, default: 10</span>
<span class="sd">        The maximum number of steps that the Boolean regulatory network solver should use in</span>
<span class="sd">        determining each eq&#39;m. It is recommended that `n_max_steps` be greater than twice the</span>
<span class="sd">        total node number (i.e. `n_max_steps &gt;= 2*BooleanNet.N_nodes`).</span>
<span class="sd">    output_nodes_only: bool, default: False</span>
<span class="sd">        Define the uniqueness of equilibrium states using only the `BooleanNet.output_node_inds` (`True`) or</span>
<span class="sd">        by using all non-input node inds using `BooleanNet.noninput_node_inds` (`False`)?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    transition_edges_set : set</span>
<span class="sd">        Set containing tuples defining all edges representing transitions of the general-NFSM (G-NFSM).</span>
<span class="sd">        Each tuple marks the transition from eq&#39;m state i to j under the action of input state k, so (i, j, k).</span>
<span class="sd">        Eq&#39;m state indices are to the columns of `solsM_allo`, and input state indices are to `sig_test_set`.</span>
<span class="sd">        Note, as new eq&#39;m states</span>
<span class="sd">        may be detected during the run of this method, `self._solsM_all` and `self._charM_all` should be used to</span>
<span class="sd">        reference eq&#39;m states and their characterization instead of the original `solsM_allo` and `charM_allo`.</span>
<span class="sd">    perturbation_edges_set : set</span>
<span class="sd">        Set containing tuples defining all edges representing transitions of the event-driven NFSM (E-NFSM).</span>
<span class="sd">        Each tuple marks the transition from eq&#39;m state i to j under the action of transiently held input state k,</span>
<span class="sd">        where the system is returned to the base input state l, so (i, j, k, l).</span>
<span class="sd">        Eq&#39;m state indices are to the columns of `solsM_allo`, and input state indices are to `sig_test_set`.</span>
<span class="sd">        Note, as new eq&#39;m states may be detected during the run of this method,</span>
<span class="sd">        `self._solsM_all` and `self._charM_all` should be used to</span>
<span class="sd">        reference eq&#39;m states and their characterization instead of the original `solsM_allo` and `charM_allo`.</span>
<span class="sd">    GG : MultiDiGraph</span>
<span class="sd">        The networkx MultiDiGraph object representing the G-NFSM.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># make a copy of solsM_all:</span>
    <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">solsM_allo</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">charM_all</span> <span class="o">=</span> <span class="n">charM_allo</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># make a copy of the states dict that&#39;s only used for modifications:</span>
    <span class="n">states_dict_2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">states_dict</span><span class="p">)</span>

    <span class="c1"># If desired, states can be defined as &quot;unique&quot; with respect to the output nodes only:</span>
    <span class="k">if</span> <span class="n">output_nodes_only</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span><span class="p">):</span>
        <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span>

    <span class="c1"># States for perturbation of the zero state inputs</span>
    <span class="c1"># Let&#39;s start the system off in the zero vector, then</span>
    <span class="c1"># temporarily perturb the system with each signal set and see what the final state is after</span>
    <span class="c1"># the perturbation.</span>

    <span class="n">sig_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span>

    <span class="n">transition_edges_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">perturbation_edges_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">num_step</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># We want to step through all &#39;held&#39; signals and potentially multistable states:</span>
    <span class="c1"># The &quot;base&quot; refers to the base context of the system:</span>
    <span class="k">for</span> <span class="n">base_input_label</span><span class="p">,</span> <span class="p">(</span><span class="n">sig_base_set</span><span class="p">,</span> <span class="n">sc_dict</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

        <span class="n">states_set</span> <span class="o">=</span> <span class="n">sc_dict</span><span class="p">[</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>

        <span class="c1"># Get an integer label for the &#39;bitstring&#39; of signal node inds defining the base:</span>
        <span class="c1"># base_input_label = self._get_integer_label(sig_base_set)</span>
        <span class="c1"># We want to use each state in states_set as the initial condition:</span>
        <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">states_set</span><span class="p">:</span>
        <span class="c1"># for si, cvect_co in enumerate(solsM_all.T): # step through all stable states</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing State </span><span class="si">{</span><span class="n">si</span><span class="si">}</span><span class="s2"> in held context I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

            <span class="n">cvect_co</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="p">[:,</span> <span class="n">si</span><span class="p">]</span>

            <span class="c1"># Initial state vector, which will be held at the base_input context</span>
            <span class="n">cvect_co</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_base_set</span>
            <span class="c1"># ensure that this initial state is indeed stable in the context:</span>
            <span class="n">cvect_c</span><span class="p">,</span> <span class="n">char_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_state_compute</span><span class="p">(</span><span class="n">cvect_co</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                           <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                           <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                           <span class="n">constraint_vals</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sig_base_set</span><span class="p">),</span>
                                                           <span class="p">)</span>

            <span class="n">initial_state</span><span class="p">,</span> <span class="n">match_error_initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                  <span class="n">cvect_c</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">match_error_initial</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>  <span class="c1"># if held state is unmatched, send warning...</span>
                <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">cvect_c</span><span class="p">))</span>
                <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">charM_all</span><span class="p">,</span> <span class="n">char_c</span><span class="p">))</span>
                <span class="n">initial_state</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

                <span class="c1"># Update the states listing for this input state set</span>
                <span class="n">sc_dict2</span> <span class="o">=</span> <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>
                <span class="n">sc_dict2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
                <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc_dict2</span>

                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING: Initial state not found (error </span><span class="si">{</span><span class="n">match_error_initial</span><span class="si">}</span><span class="s1">);&#39;</span>
                          <span class="sa">f</span><span class="s1">&#39; adding new state </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> to the solution set...&#39;</span><span class="p">)</span>

            <span class="c1"># Add this transition to the state transition diagram:</span>
            <span class="n">transition_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">si</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">base_input_label</span><span class="p">))</span>

            <span class="c1"># We then step through all possible perturbation signals that act on the state in the set:</span>
            <span class="n">cvect_ho</span> <span class="o">=</span> <span class="n">cvect_c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">pert_input_label</span><span class="p">,</span> <span class="p">(</span><span class="n">sig_pert_set</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">states_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Step: </span><span class="si">{</span><span class="n">num_step</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;...State </span><span class="si">{</span><span class="n">si</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> via I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>


                <span class="n">cvect_ho</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_pert_set</span> <span class="c1"># apply the perturbation to the state</span>
                <span class="n">cvect_h</span><span class="p">,</span> <span class="n">char_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_state_compute</span><span class="p">(</span><span class="n">cvect_ho</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                           <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                           <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                           <span class="n">constraint_vals</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sig_pert_set</span><span class="p">),</span>
                                                           <span class="p">)</span>

                <span class="c1"># FIXME: the find_state_match method should use the equm&#39; char as well as the state values!</span>
                <span class="c1"># match the network state to one that only involves the hub nodes:</span>
                <span class="n">held_state</span><span class="p">,</span> <span class="n">match_error_held</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                            <span class="n">cvect_h</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">match_error_held</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span> <span class="c1"># if held state is unmatched, flag it with a nan</span>
                    <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">cvect_h</span><span class="p">))</span>
                    <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">charM_all</span><span class="p">,</span> <span class="n">char_h</span><span class="p">))</span>
                    <span class="n">held_state</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

                    <span class="n">sc_dict2</span> <span class="o">=</span> <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>
                    <span class="n">sc_dict2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">held_state</span><span class="p">)</span>
                    <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc_dict2</span>

                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING: Held state not found (error </span><span class="si">{</span><span class="n">match_error_held</span><span class="si">}</span><span class="s1">); &#39;</span>
                              <span class="sa">f</span><span class="s1">&#39;adding new state </span><span class="si">{</span><span class="n">held_state</span><span class="si">}</span><span class="s1"> to the solution set...&#39;</span><span class="p">)</span>

                <span class="n">transition_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">held_state</span><span class="p">,</span> <span class="n">pert_input_label</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;...State </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">held_state</span><span class="si">}</span><span class="s1"> via I</span><span class="si">{</span><span class="n">pert_input_label</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>

                <span class="c1"># Next, re-apply the initial context input state to the held state and see what final state results:</span>
                <span class="n">cvect_h</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_base_set</span>

                <span class="c1"># find the stable state that results from re-applying the context input state to the held state:</span>
                <span class="n">cvect_f</span><span class="p">,</span> <span class="n">char_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_state_compute</span><span class="p">(</span><span class="n">cvect_h</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                           <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                           <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                           <span class="n">constraint_vals</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sig_base_set</span><span class="p">),</span>
                                                           <span class="p">)</span>

                <span class="n">final_state</span><span class="p">,</span> <span class="n">match_error_final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                      <span class="n">cvect_f</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">])</span>
                <span class="c1"># held_state, match_error_held = self._find_state_match(solsM_all, c_held)</span>

                <span class="k">if</span> <span class="n">match_error_final</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span> <span class="c1"># if state is unmatched, flag it</span>
                    <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">cvect_f</span><span class="p">))</span>
                    <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">charM_all</span><span class="p">,</span> <span class="n">char_f</span><span class="p">))</span>
                    <span class="n">final_state</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="mi">1</span>

                    <span class="n">sc_dict2</span> <span class="o">=</span> <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span>
                    <span class="n">sc_dict2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_state</span><span class="p">)</span>
                    <span class="n">states_dict_2</span><span class="p">[</span><span class="n">sig_base_set</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc_dict2</span>

                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING: Final state not found (error </span><span class="si">{</span><span class="n">match_error_final</span><span class="si">}</span><span class="s1">); &#39;</span>
                              <span class="sa">f</span><span class="s1">&#39;adding new state </span><span class="si">{</span><span class="n">final_state</span><span class="si">}</span><span class="s1"> to the solution set...&#39;</span><span class="p">)</span>

                <span class="n">transition_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">held_state</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="n">base_input_label</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;...State </span><span class="si">{</span><span class="n">held_state</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">final_state</span><span class="si">}</span><span class="s1"> via I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Look for change in the system from initial to final state:</span>

                <span class="k">if</span> <span class="n">initial_state</span> <span class="o">!=</span> <span class="n">final_state</span><span class="p">:</span>  <span class="c1"># add this to the perturbed transitions:</span>
                    <span class="n">perturbation_edges_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="n">pert_input_label</span><span class="p">,</span> <span class="n">base_input_label</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Event-driven transition identified from State </span><span class="si">{</span><span class="n">initial_state</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">final_state</span><span class="si">}</span><span class="s1"> via &#39;</span>
                              <span class="sa">f</span><span class="s1">&#39;event I</span><span class="si">{</span><span class="n">pert_input_label</span><span class="si">}</span><span class="s1"> under context I</span><span class="si">{</span><span class="n">base_input_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">num_step</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># if verbose:</span>
                <span class="c1">#     # print(f&#39;Match errors {match_error_initial, match_error_held, match_error_final}&#39;)</span>
                <span class="c1">#     print(&#39;------&#39;)</span>

    <span class="c1"># The first thing we do after the construction of the</span>
    <span class="c1"># transition edges set is make a multidigraph and</span>
    <span class="c1"># use networkx to pre-process &amp; simplify it, removing inaccessible states</span>
    <span class="c1"># (states with no non-self input degree)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_solsM_all</span> <span class="o">=</span> <span class="n">solsM_all</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_states_dict</span> <span class="o">=</span> <span class="n">states_dict_2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sig_test_set</span> <span class="o">=</span> <span class="n">sig_test_set</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_charM_all</span> <span class="o">=</span> <span class="n">charM_all</span>
    <span class="c1"># self._charM_all = np.hstack((self._charM_all, charM_ext))</span>

    <span class="c1"># Create the multidigraph:</span>
    <span class="n">GG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">ndei</span><span class="p">,</span> <span class="n">ndej</span><span class="p">,</span> <span class="n">trans_label_ij</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">transition_edges_set</span><span class="p">):</span>
        <span class="c1"># Annoyingly, nodes must be strings in order to save properly...</span>
        <span class="n">GG</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ndei</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">ndej</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;I</span><span class="si">{</span><span class="n">trans_label_ij</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">remove_inaccessible_states</span><span class="p">:</span>
        <span class="c1"># Remove nodes that have no input degree other than their own self-loop:</span>
        <span class="n">nodes_with_selfloops</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">nodes_with_selfloops</span><span class="p">(</span><span class="n">GG</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">node_lab</span><span class="p">,</span> <span class="n">node_in_deg</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">GG</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">node_in_deg</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">node_lab</span> <span class="ow">in</span> <span class="n">nodes_with_selfloops</span><span class="p">)</span> <span class="ow">or</span> <span class="n">node_in_deg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">GG</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node_lab</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_graph_file</span><span class="p">:</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">write_gml</span><span class="p">(</span><span class="n">GG</span><span class="p">,</span> <span class="n">save_graph_file</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">G_states</span> <span class="o">=</span> <span class="n">GG</span>

    <span class="k">return</span> <span class="n">transition_edges_set</span><span class="p">,</span> <span class="n">perturbation_edges_set</span><span class="p">,</span> <span class="n">GG</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.get_state_distance_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_state_distance_matrix</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns a matrix representing the L2 norm 'distance'
between each state in the array of all possible states.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_state_distance_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solsM_all</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns a matrix representing the L2 norm &#39;distance&#39;</span>
<span class="sd">    between each state in the array of all possible states.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">num_sols</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">state_distance_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_sols</span><span class="p">,</span> <span class="n">num_sols</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sols</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sols</span><span class="p">):</span>
            <span class="c1"># d_states = np.sqrt(np.sum((solsM_all[:,i] - solsM_all[:, j])**2))</span>
            <span class="n">d_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">solsM_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                        <span class="n">solsM_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">state_distance_M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_states</span>

    <span class="k">return</span> <span class="n">state_distance_M</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_input_words_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_input_words_array</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">,</span> <span class="n">gene_list</span><span class="p">,</span> <span class="n">figsave</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_input_words_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">sig_test_set</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                    <span class="n">gene_list</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                    <span class="n">figsave</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">save_format</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                    <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;magma&#39;</span>

    <span class="n">state_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;I</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sig_test_set</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

    <span class="n">gene_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_labels</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">gene_labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state_labels</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">state_labels</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
             <span class="n">rotation_mode</span><span class="o">=</span><span class="s2">&quot;anchor&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Expression Level&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">figsave</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figsave</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">save_format</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_sequence_trajectory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_sequence_trajectory</span><span class="p">(</span><span class="n">c_time</span><span class="p">,</span> <span class="n">tvectr</span><span class="p">,</span> <span class="n">phase_inds</span><span class="p">,</span> <span class="n">matched_states</span><span class="p">,</span> <span class="n">char_states</span><span class="p">,</span> <span class="n">gene_plot_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">state_label_offset</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">glyph_zoom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">glyph_alignment</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_sequence_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">c_time</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                         <span class="n">tvectr</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                         <span class="n">phase_inds</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                         <span class="n">matched_states</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                         <span class="n">char_states</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                         <span class="n">gene_plot_inds</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                         <span class="n">state_label_offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
                         <span class="n">glyph_zoom</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
                         <span class="n">glyph_alignment</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">),</span>
                         <span class="n">fontsize</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                         <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">legend</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">gene_plot_inds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">main_c</span> <span class="o">=</span> <span class="n">c_time</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">main_c</span> <span class="o">=</span> <span class="n">c_time</span><span class="p">[:,</span> <span class="n">gene_plot_inds</span><span class="p">]</span>

    <span class="n">N_plot_genes</span> <span class="o">=</span> <span class="n">main_c</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Resize the figure to fit the panel of plotted genes:</span>
    <span class="n">fig_width</span> <span class="o">=</span> <span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fig_height</span> <span class="o">=</span> <span class="n">figsize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="o">*</span><span class="n">N_plot_genes</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">N_plot_genes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">main_c</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
        <span class="c1"># gene_lab = f&#39;Gene {ii}&#39;</span>
        <span class="n">gene_lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">nodes_list</span><span class="p">)[</span><span class="n">gene_plot_inds</span><span class="p">[</span><span class="n">ii</span><span class="p">]]</span>
        <span class="n">lineplt</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tvectr</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">gene_lab</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span>  <span class="c1"># plot the time series</span>
        <span class="c1"># annotate the plot with the matched state:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">pj</span><span class="p">),</span> <span class="n">stateio</span><span class="p">,</span> <span class="n">chario</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">phase_inds</span><span class="p">,</span> <span class="n">matched_states</span><span class="p">,</span> <span class="n">char_states</span><span class="p">):</span>
            <span class="n">statei</span> <span class="o">=</span> <span class="n">stateio</span>

            <span class="n">char_i</span> <span class="o">=</span> <span class="n">chario</span><span class="o">.</span><span class="n">name</span>
            <span class="n">char_i_fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">char_i</span><span class="p">]</span>
            <span class="n">logo</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">char_i_fname</span><span class="p">)</span>
            <span class="n">imagebox</span> <span class="o">=</span> <span class="n">OffsetImage</span><span class="p">(</span><span class="n">logo</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">glyph_zoom</span><span class="p">)</span>
            <span class="n">pmid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">pi</span> <span class="o">+</span> <span class="n">pj</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">tmid</span> <span class="o">=</span> <span class="n">tvectr</span><span class="p">[</span><span class="n">pmid</span><span class="p">]</span>
            <span class="n">cc_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="n">pi</span><span class="p">:</span><span class="n">pj</span><span class="p">])</span>
            <span class="n">cmid</span> <span class="o">=</span> <span class="n">cc_max</span> <span class="o">+</span> <span class="n">state_label_offset</span>

            <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">tmid</span><span class="p">,</span> <span class="n">cmid</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">statei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

            <span class="n">ab</span> <span class="o">=</span> <span class="n">AnnotationBbox</span><span class="p">(</span><span class="n">imagebox</span><span class="p">,</span>
                                <span class="p">(</span><span class="n">tmid</span><span class="p">,</span> <span class="n">cmid</span><span class="p">),</span>
                                <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">box_alignment</span><span class="o">=</span><span class="n">glyph_alignment</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>

            <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Expression Probability&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_state_perturbation_network" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_state_perturbation_network</span><span class="p">(</span><span class="n">pert_edges_set</span><span class="p">,</span> <span class="n">charM_all</span><span class="p">,</span> <span class="n">nodes_listo</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph_layout</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="n">mono_edge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">concentrate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mf">18.0</span><span class="p">,</span> <span class="n">node_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;rainbow_r&#39;</span><span class="p">,</span> <span class="n">transp_str</span><span class="o">=</span><span class="s1">&#39;80&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This method creates a plot of an event-driven network finite state machine (E-NFSM), which has nodes representing
equilibrium states of a regulatory network, edges as the transition between two equilibrium states occuring under
the application of a transiently applied input signal, and a more 'permanent' input signal to which the
system returns after the transient perturbation.</p>
<p>An input state can be associated with several possible equilibrium
states if the network has multistability. If this is the case, then the
equilibrium state that the system transitions to depends not only on the applied input
state, but also the equilibrium state that the system is in to begin with.</p>
<p>To capture this path dependency, here we create a graph with subgraphs, where each subgraph
represents the possible states for a
held input state (the 'held context' case is represented by the subgraph).
In the case of multistability, temporary
perturbations to the held input state can result in transitions between
the multistable states. The
sub-graph indicates which temporarily-applied input signal leads to which state
transition via the edge label. Input signal states are represented as
integers, where the integer codes for a binary bit string of signal state values; equilibrium states
are indexed according to their column index in solsM_all.</p>
<p>The result is saved to an image file on disk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes_listo</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of nodes forming the E-NFSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pert_edges_set</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#set">set</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of edges forming the E-NFSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>charM_all</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dynamic characteristic of all unique equilbrium states.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The complete directory and filename to save an image of the E-NFSM graph (as 'png' or 'svg').</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>graph_layout</code>
            </td>
            <td>
                  <code>str, default:&#39;dot&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz layout for the graph.</p>
              </div>
            </td>
            <td>
                  <code>&#39;dot&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mono_edge</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Merge close edges into a single path (<code>True</code>)?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rank</code>
            </td>
            <td>
                  <code>str, default:&#39;same&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz rank key.</p>
              </div>
            </td>
            <td>
                  <code>&#39;same&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>constraint</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz constraint key.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concentrate</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz concentrate key.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fontsize</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font size to use on node labels.</p>
              </div>
            </td>
            <td>
                  <code>18.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node_colors</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values that should be mapped to nodes (e.g. these may be distance from a 'cancer' state).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cmap_str</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colormap to use to color the nodes.</p>
              </div>
            </td>
            <td>
                  <code>&#39;rainbow_r&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transp_str</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transparancy (as a hex value) to lighten the node coloring.</p>
              </div>
            </td>
            <td>
                  <code>&#39;80&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pygraphviz.AGraph">AGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pygraphviz object representing the E-NFSM.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_state_perturbation_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                   <span class="n">pert_edges_set</span><span class="p">:</span> <span class="nb">set</span><span class="p">,</span>
                                   <span class="n">charM_all</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                                   <span class="n">nodes_listo</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                                   <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">graph_layout</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;dot&#39;</span><span class="p">,</span>
                                   <span class="n">mono_edge</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">rank</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;same&#39;</span><span class="p">,</span>
                                   <span class="n">constraint</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">concentrate</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">18.0</span><span class="p">,</span>
                                   <span class="n">node_colors</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                    <span class="n">cmap_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;rainbow_r&#39;</span><span class="p">,</span>
                                    <span class="n">transp_str</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;80&#39;</span><span class="p">,</span>
                                    <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This method creates a plot of an event-driven network finite state machine (E-NFSM), which has nodes representing</span>
<span class="sd">    equilibrium states of a regulatory network, edges as the transition between two equilibrium states occuring under</span>
<span class="sd">    the application of a transiently applied input signal, and a more &#39;permanent&#39; input signal to which the</span>
<span class="sd">    system returns after the transient perturbation.</span>

<span class="sd">    An input state can be associated with several possible equilibrium</span>
<span class="sd">    states if the network has multistability. If this is the case, then the</span>
<span class="sd">    equilibrium state that the system transitions to depends not only on the applied input</span>
<span class="sd">    state, but also the equilibrium state that the system is in to begin with.</span>

<span class="sd">    To capture this path dependency, here we create a graph with subgraphs, where each subgraph</span>
<span class="sd">    represents the possible states for a</span>
<span class="sd">    held input state (the &#39;held context&#39; case is represented by the subgraph).</span>
<span class="sd">    In the case of multistability, temporary</span>
<span class="sd">    perturbations to the held input state can result in transitions between</span>
<span class="sd">    the multistable states. The</span>
<span class="sd">    sub-graph indicates which temporarily-applied input signal leads to which state</span>
<span class="sd">    transition via the edge label. Input signal states are represented as</span>
<span class="sd">    integers, where the integer codes for a binary bit string of signal state values; equilibrium states</span>
<span class="sd">    are indexed according to their column index in solsM_all.</span>

<span class="sd">    The result is saved to an image file on disk.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nodes_listo : list</span>
<span class="sd">        List of nodes forming the E-NFSM.</span>
<span class="sd">    pert_edges_set : set</span>
<span class="sd">        List of edges forming the E-NFSM.</span>
<span class="sd">    charM_all : list|ndarray</span>
<span class="sd">        The dynamic characteristic of all unique equilbrium states.</span>
<span class="sd">    save_file : str|None, default: None</span>
<span class="sd">        The complete directory and filename to save an image of the E-NFSM graph (as &#39;png&#39; or &#39;svg&#39;).</span>
<span class="sd">    graph_layout : str, default:&#39;dot&#39;</span>
<span class="sd">        Graphviz layout for the graph.</span>
<span class="sd">    mono_edge : bool, default: False</span>
<span class="sd">        Merge close edges into a single path (`True`)?</span>
<span class="sd">    rank : str, default:&#39;same&#39;</span>
<span class="sd">        Graphviz rank key.</span>
<span class="sd">    constraint : bool, default: False</span>
<span class="sd">        Graphviz constraint key.</span>
<span class="sd">    concentrate : bool, default: True</span>
<span class="sd">        Graphviz concentrate key.</span>
<span class="sd">    fontsize : float, default: 18.0</span>
<span class="sd">        Font size to use on node labels.</span>
<span class="sd">    node_colors : list|None, default: None</span>
<span class="sd">        Values that should be mapped to nodes (e.g. these may be distance from a &#39;cancer&#39; state).</span>
<span class="sd">    cmap_str : str, default: &#39;rainbow_r&#39;</span>
<span class="sd">        Colormap to use to color the nodes.</span>
<span class="sd">    transp_str : str, default: &#39;80&#39;</span>
<span class="sd">        Transparancy (as a hex value) to lighten the node coloring.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    AGraph</span>
<span class="sd">        The pygraphviz object representing the E-NFSM.</span>
<span class="sd">    &#39;&#39;&#39;</span>


    <span class="n">nodes_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">nodes_listo</span><span class="p">]</span> <span class="c1"># convert nodes from string to int</span>

    <span class="n">img_pos</span> <span class="o">=</span> <span class="s1">&#39;bc&#39;</span>  <span class="c1"># position of the glyph in the node</span>
    <span class="n">subcluster_font</span> <span class="o">=</span> <span class="s1">&#39;DejaVu Sans Bold&#39;</span>
    <span class="n">node_shape</span> <span class="o">=</span> <span class="s1">&#39;ellipse&#39;</span>
    <span class="n">clr_map</span> <span class="o">=</span> <span class="n">cmap_str</span>
    <span class="n">nde_font_color</span> <span class="o">=</span> <span class="s1">&#39;Black&#39;</span>
    <span class="n">hex_transparency</span> <span class="o">=</span> <span class="n">transp_str</span>

    <span class="c1"># Make a nested graph with compound=True keyword:</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">pgv</span><span class="o">.</span><span class="n">AGraph</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="n">mono_edge</span><span class="p">,</span>
                   <span class="n">fontname</span><span class="o">=</span><span class="n">subcluster_font</span><span class="p">,</span>
                   <span class="n">splines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">concentrate</span><span class="o">=</span><span class="n">concentrate</span><span class="p">,</span>
                   <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span>
                   <span class="n">compound</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">rank</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span>
                   <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormaps</span><span class="p">[</span><span class="n">clr_map</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">node_colors</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">node_colors</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">st_i</span><span class="p">,</span> <span class="n">st_f</span><span class="p">,</span> <span class="n">i_pert</span><span class="p">,</span> <span class="n">i_base</span> <span class="ow">in</span> <span class="n">pert_edges_set</span><span class="p">:</span>
        <span class="c1"># Add in a subgraph box for the &quot;held&quot; input node state:</span>
        <span class="n">Gsub</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">add_subgraph</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;cluster_</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Held at I</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># next add-in nodes for the initial state:</span>
        <span class="n">nde_i_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">st_i</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span> <span class="c1"># node name is in terms of the subgraph box index</span>
        <span class="n">nde_i_lab</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">st_i</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nde_i_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">st_i</span><span class="p">)))</span>
            <span class="n">nde_f_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">st_f</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nde_i_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">node_colors</span><span class="p">[</span><span class="n">st_i</span><span class="p">])))</span>
            <span class="n">nde_f_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">node_colors</span><span class="p">[</span><span class="n">st_f</span><span class="p">])))</span>

        <span class="n">nde_i_color</span> <span class="o">+=</span> <span class="n">hex_transparency</span>  <span class="c1"># add some transparency to the node</span>
        <span class="n">nde_f_color</span> <span class="o">+=</span> <span class="n">hex_transparency</span>  <span class="c1"># add some transparency to the node</span>

        <span class="n">chr_i</span> <span class="o">=</span> <span class="n">charM_all</span><span class="p">[</span><span class="n">st_i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

        <span class="n">Gsub</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">nde_i_name</span><span class="p">,</span>
                      <span class="n">label</span><span class="o">=</span><span class="n">nde_i_lab</span><span class="p">,</span>
                      <span class="n">labelloc</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                      <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">chr_i</span><span class="p">],</span>
                      <span class="n">imagepos</span><span class="o">=</span><span class="n">img_pos</span><span class="p">,</span>
                      <span class="n">shape</span><span class="o">=</span><span class="n">node_shape</span><span class="p">,</span>
                      <span class="n">fontcolor</span><span class="o">=</span><span class="n">nde_font_color</span><span class="p">,</span>
                      <span class="n">style</span><span class="o">=</span><span class="s1">&#39;filled&#39;</span><span class="p">,</span>
                      <span class="n">fillcolor</span><span class="o">=</span><span class="n">nde_i_color</span>
                      <span class="p">)</span>

        <span class="c1"># ...and for the final state:</span>
        <span class="n">nde_f_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">st_f</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">i_base</span><span class="si">}</span><span class="s1">&#39;</span> <span class="c1"># node name is in terms of the subgraph box index</span>
        <span class="n">nde_f_lab</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">st_f</span><span class="si">}</span><span class="s1">&#39;</span>


        <span class="n">chr_f</span> <span class="o">=</span> <span class="n">charM_all</span><span class="p">[</span><span class="n">st_f</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

        <span class="n">Gsub</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">nde_f_name</span><span class="p">,</span>
                      <span class="n">label</span><span class="o">=</span><span class="n">nde_f_lab</span><span class="p">,</span>
                      <span class="n">labelloc</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                      <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">chr_f</span><span class="p">],</span>
                      <span class="n">imagepos</span><span class="o">=</span><span class="n">img_pos</span><span class="p">,</span>
                      <span class="n">shape</span><span class="o">=</span><span class="n">node_shape</span><span class="p">,</span>
                      <span class="n">fontcolor</span><span class="o">=</span><span class="n">nde_font_color</span><span class="p">,</span>
                      <span class="n">style</span><span class="o">=</span><span class="s1">&#39;filled&#39;</span><span class="p">,</span>
                      <span class="n">fillcolor</span><span class="o">=</span><span class="n">nde_f_color</span>
                      <span class="p">)</span>

        <span class="n">Gsub</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">nde_i_name</span><span class="p">,</span> <span class="n">nde_f_name</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;I</span><span class="si">{</span><span class="n">i_pert</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">G</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="n">graph_layout</span><span class="p">)</span>
        <span class="n">G</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.plot_state_transition_network" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_state_transition_network</span><span class="p">(</span><span class="n">nodes_listo</span><span class="p">,</span> <span class="n">edges_list</span><span class="p">,</span> <span class="n">charM_all</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph_layout</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="n">mono_edge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">concentrate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mf">18.0</span><span class="p">,</span> <span class="n">node_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap_str</span><span class="o">=</span><span class="s1">&#39;rainbow_r&#39;</span><span class="p">,</span> <span class="n">transp_str</span><span class="o">=</span><span class="s1">&#39;80&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This method creates a plot of a general network finite state machine (G-NFSM), which has nodes representing
equilibrium states of a regulatory network, edges as the transition between two equilibrium states, and
the label on each edge representing the input state index applied and held to transition the network
between the two equilibrium states. The result is saved to an image file on disk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes_listo</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of nodes forming the G-NFSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>edges_list</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of edges forming the G-NFSM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>charM_all</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dynamic characteristic of all unique equilbrium states.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The complete directory and filename to save an image of the G-NFSM graph (as 'png' or 'svg').</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>graph_layout</code>
            </td>
            <td>
                  <code>str, default:&#39;dot&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz layout for the graph.</p>
              </div>
            </td>
            <td>
                  <code>&#39;dot&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mono_edge</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Merge close edges into a single path (<code>True</code>)?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rank</code>
            </td>
            <td>
                  <code>str, default:&#39;same&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz rank key.</p>
              </div>
            </td>
            <td>
                  <code>&#39;same&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>constraint</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz constraint key.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>concentrate</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graphviz concentrate key.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fontsize</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Font size to use on node labels.</p>
              </div>
            </td>
            <td>
                  <code>18.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node_colors</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values that should be mapped to nodes (e.g. these may be distance from a 'cancer' state).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cmap_str</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colormap to use to color the nodes.</p>
              </div>
            </td>
            <td>
                  <code>&#39;rainbow_r&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transp_str</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transparancy (as a hex value) to lighten the node coloring.</p>
              </div>
            </td>
            <td>
                  <code>&#39;80&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pygraphviz.AGraph">AGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pygraphviz object representing the G-NFSM.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_state_transition_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">nodes_listo</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                                  <span class="n">edges_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                                  <span class="n">charM_all</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="n">ndarray</span><span class="p">,</span>
                                  <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">graph_layout</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span>
                                  <span class="n">mono_edge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                  <span class="n">rank</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
                                  <span class="n">constraint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                  <span class="n">concentrate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">18.0</span><span class="p">,</span>
                                  <span class="n">node_colors</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">cmap_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;rainbow_r&#39;</span><span class="p">,</span>
                                  <span class="n">transp_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;80&#39;</span><span class="p">,</span>
                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This method creates a plot of a general network finite state machine (G-NFSM), which has nodes representing</span>
<span class="sd">    equilibrium states of a regulatory network, edges as the transition between two equilibrium states, and</span>
<span class="sd">    the label on each edge representing the input state index applied and held to transition the network</span>
<span class="sd">    between the two equilibrium states. The result is saved to an image file on disk.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nodes_listo : list</span>
<span class="sd">        List of nodes forming the G-NFSM.</span>
<span class="sd">    edges_list : list</span>
<span class="sd">        List of edges forming the G-NFSM.</span>
<span class="sd">    charM_all : list|ndarray</span>
<span class="sd">        The dynamic characteristic of all unique equilbrium states.</span>
<span class="sd">    save_file : str|None, default: None</span>
<span class="sd">        The complete directory and filename to save an image of the G-NFSM graph (as &#39;png&#39; or &#39;svg&#39;).</span>
<span class="sd">    graph_layout : str, default:&#39;dot&#39;</span>
<span class="sd">        Graphviz layout for the graph.</span>
<span class="sd">    mono_edge : bool, default: False</span>
<span class="sd">        Merge close edges into a single path (`True`)?</span>
<span class="sd">    rank : str, default:&#39;same&#39;</span>
<span class="sd">        Graphviz rank key.</span>
<span class="sd">    constraint : bool, default: False</span>
<span class="sd">        Graphviz constraint key.</span>
<span class="sd">    concentrate : bool, default: True</span>
<span class="sd">        Graphviz concentrate key.</span>
<span class="sd">    fontsize : float, default: 18.0</span>
<span class="sd">        Font size to use on node labels.</span>
<span class="sd">    node_colors : list|None, default: None</span>
<span class="sd">        Values that should be mapped to nodes (e.g. these may be distance from a &#39;cancer&#39; state).</span>
<span class="sd">    cmap_str : str, default: &#39;rainbow_r&#39;</span>
<span class="sd">        Colormap to use to color the nodes.</span>
<span class="sd">    transp_str : str, default: &#39;80&#39;</span>
<span class="sd">        Transparancy (as a hex value) to lighten the node coloring.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    AGraph</span>
<span class="sd">        The pygraphviz object representing the G-NFSM.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Convert nodes from string to int</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_charM_all</span> <span class="o">=</span> <span class="n">charM_all</span>
    <span class="n">nodes_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">nodes_listo</span><span class="p">]</span>
    <span class="n">img_pos</span> <span class="o">=</span> <span class="s1">&#39;bc&#39;</span>  <span class="c1"># position of the glyph in the node</span>
    <span class="n">subcluster_font</span> <span class="o">=</span> <span class="s1">&#39;DejaVu Sans Bold&#39;</span>
    <span class="n">node_shape</span> <span class="o">=</span> <span class="s1">&#39;ellipse&#39;</span>
    <span class="n">clr_map</span> <span class="o">=</span> <span class="n">cmap_str</span>
    <span class="n">nde_font_color</span> <span class="o">=</span> <span class="s1">&#39;Black&#39;</span>
    <span class="n">hex_transparency</span> <span class="o">=</span> <span class="n">transp_str</span>

    <span class="c1"># Try to make a nested graph:</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">pgv</span><span class="o">.</span><span class="n">AGraph</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="n">mono_edge</span><span class="p">,</span>
                   <span class="n">fontname</span><span class="o">=</span><span class="n">subcluster_font</span><span class="p">,</span>
                   <span class="n">splines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">concentrate</span><span class="o">=</span><span class="n">concentrate</span><span class="p">,</span>
                   <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span>
                   <span class="n">rank</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span>
                   <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormaps</span><span class="p">[</span><span class="n">clr_map</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_solsM_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">node_colors</span><span class="p">),</span>
                                <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">node_colors</span><span class="p">))</span>

    <span class="c1"># Add all the nodes:</span>
    <span class="k">for</span> <span class="n">nde_i</span> <span class="ow">in</span> <span class="n">nodes_list</span><span class="p">:</span>
        <span class="n">nde_lab</span> <span class="o">=</span> <span class="n">nde_i</span>
        <span class="n">nde_index</span> <span class="o">=</span> <span class="n">nodes_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nde_i</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">node_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nde_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">nde_lab</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nde_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">node_colors</span><span class="p">[</span><span class="n">nde_lab</span><span class="p">])))</span>

        <span class="n">nde_color</span> <span class="o">+=</span> <span class="n">hex_transparency</span>  <span class="c1"># add some transparancy to the node</span>

        <span class="n">char_i</span> <span class="o">=</span> <span class="n">charM_all</span><span class="p">[</span><span class="n">nde_i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="c1"># Get the stability characterization for this state</span>

        <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">nde_i</span><span class="p">,</span>
                       <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">nde_lab</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                       <span class="n">labelloc</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                       <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_image_dict</span><span class="p">[</span><span class="n">char_i</span><span class="p">],</span>
                       <span class="n">imagepos</span><span class="o">=</span><span class="n">img_pos</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="n">node_shape</span><span class="p">,</span>
                       <span class="n">fontcolor</span><span class="o">=</span><span class="n">nde_font_color</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s1">&#39;filled&#39;</span><span class="p">,</span>
                       <span class="n">fillcolor</span><span class="o">=</span><span class="n">nde_color</span><span class="p">)</span>


    <span class="c1"># Add all the edges:</span>
    <span class="k">for</span> <span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">,</span> <span class="n">trans_ij</span> <span class="ow">in</span> <span class="n">edges_list</span><span class="p">:</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">trans_ij</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">G</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="n">graph_layout</span><span class="p">)</span>
        <span class="n">G</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.sim_sequence_trajectory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sim_sequence_trajectory</span><span class="p">(</span><span class="n">starting_state</span><span class="p">,</span> <span class="n">solsM_all</span><span class="p">,</span> <span class="n">inputs_list</span><span class="p">,</span> <span class="n">sig_test_set</span><span class="p">,</span> <span class="n">n_seq_steps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">match_tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sim_sequence_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">starting_state</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                            <span class="n">solsM_all</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                            <span class="n">inputs_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                            <span class="n">sig_test_set</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                            <span class="n">n_seq_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">match_tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.1</span>
                            <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cc_o</span> <span class="o">=</span> <span class="n">solsM_all</span><span class="p">[:,</span> <span class="n">starting_state</span><span class="p">]</span> <span class="c1"># obtain the starting state of the system</span>

    <span class="n">sigs_vect_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sig_nme</span> <span class="ow">in</span> <span class="n">inputs_list</span><span class="p">:</span>
        <span class="n">sig_i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sig_nme</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="c1"># get the integer representing the input state</span>
        <span class="n">sigs_vect_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">[</span><span class="n">sig_i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="c1"># append the complete input signal to the list</span>

    <span class="n">seq_tvect</span><span class="p">,</span> <span class="n">seq_res</span><span class="p">,</span> <span class="n">sol_res</span><span class="p">,</span> <span class="n">sol_char_res</span><span class="p">,</span> <span class="n">phase_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">net_multisequence_compute</span><span class="p">(</span><span class="n">cc_o</span><span class="p">,</span>
                                                                          <span class="n">sigs_vect_list</span><span class="p">,</span>
                                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                                          <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_seq_steps</span><span class="p">,</span>
                                                                          <span class="n">constraint_inds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span>
                                                                          <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">matched_states</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">matched_char</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">cc_new</span><span class="p">,</span> <span class="n">char_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sol_res</span><span class="p">,</span> <span class="n">sol_char_res</span><span class="p">):</span>
        <span class="n">new_state</span><span class="p">,</span> <span class="n">match_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                       <span class="n">cc_new</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">])</span>
        <span class="n">matched_states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
        <span class="n">matched_char</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char_new</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">match_error</span> <span class="o">&lt;</span> <span class="n">match_tol</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Detected State </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s1">, with error </span><span class="si">{</span><span class="n">match_error</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WARNING! Best match State </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s1"> exceeds match_error with error </span><span class="si">{</span><span class="n">match_error</span><span class="si">}</span><span class="s1">!&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">seq_tvect</span><span class="p">,</span> <span class="n">seq_res</span><span class="p">,</span> <span class="n">matched_states</span><span class="p">,</span> <span class="n">matched_char</span><span class="p">,</span> <span class="n">phase_inds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.networks_toolbox.boolean_state_machine.BoolStateMachine.steady_state_solutions_search" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">steady_state_solutions_search</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">search_main_nodes_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_max_steps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">order_by_distance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">node_num_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_nodes_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Search through all possible (binary valued) combinations of input nodes
(<code>BooleanNet.input_node_inds</code>) to find and dynamically characterize equilibrium
state of the regulatory network system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print output while solving (<code>True</code>)?</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>search_main_nodes_only</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search only the <code>BooleanNet.main_nodes</code> (<code>True</code>) or search all noninput nodes,
<code>BooleanNet.noninput_node_inds</code> nodes (<code>False</code>)?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_max_steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of steps that the Boolean regulatory network solver should use in
determining each eq'm. It is recommended that <code>n_max_steps</code> be greater than twice the
total node number (i.e. <code>n_max_steps &gt;= 2*BooleanNet.N_nodes</code>).</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order_by_distance</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order states by increasing distance from the zero state (<code>True</code>)?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node_num_max</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>n_max_steps</code> is <code>True</code>, further limit the search space dimensions to the first node_num_max
nodes according to their hierarchical level (i.e. according to <code>BooleanNet.hier_node_level</code>)?
We have found that all equilibrium solutions can be returned by selecting the a subset of nodes
with the ones with the highest hierarchical level (i.e. closest to inputs) having maximum influence
on the network.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_nodes_only</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Define the uniqueness of equilibrium states using only the <code>BooleanNet.output_node_inds</code> (<code>True</code>) or
by using all non-input node inds using <code>BooleanNet.noninput_node_inds</code> (<code>False</code>)?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>solsM</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix of unique equilibrium state solutions, with each solution appearing in columns, and each row
representing the node expression level.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>charM_all</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dynamic characterization of each equilibrium state in solsM, as a linear array of
<a class="autorefs autorefs-internal" href="../../1%29%20GRN%20Model%20Building/network_models_network_enums/#cellnition.science.network_models.network_enums"><code>EquilibriumType</code></a>
enumerations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>sols_list</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of all (non-unique) equilibrium state solutions in the order that they were found.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>states_dict</code></td>            <td>
                  <code><a class="autorefs autorefs-external" title="collections.OrderedDict" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict">OrderedDict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys as tuples representing each input state, and values being the equilibrium
state index as the column index of <code>solsM</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>sig_test_set</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array containing each of the input states (i.e. all binary-node-level combinations of
<code>BooleanNet.input_node_inds</code>) which were applied to the network, for which equilibrium states
of the network were found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/networks_toolbox/boolean_state_machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">steady_state_solutions_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">search_main_nodes_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                  <span class="n">n_max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                                  <span class="n">order_by_distance</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">node_num_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">output_nodes_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Search through all possible (binary valued) combinations of input nodes</span>
<span class="sd">    (`BooleanNet.input_node_inds`) to find and dynamically characterize equilibrium</span>
<span class="sd">    state of the regulatory network system.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbose : bool, default: True</span>
<span class="sd">        Print output while solving (`True`)?</span>
<span class="sd">    search_main_nodes_only : bool, default: False</span>
<span class="sd">        Search only the `BooleanNet.main_nodes` (`True`) or search all noninput nodes,</span>
<span class="sd">        `BooleanNet.noninput_node_inds` nodes (`False`)?</span>
<span class="sd">    n_max_steps : int, default: 20</span>
<span class="sd">        The maximum number of steps that the Boolean regulatory network solver should use in</span>
<span class="sd">        determining each eq&#39;m. It is recommended that `n_max_steps` be greater than twice the</span>
<span class="sd">        total node number (i.e. `n_max_steps &gt;= 2*BooleanNet.N_nodes`).</span>
<span class="sd">    order_by_distance : bool, default: False</span>
<span class="sd">        Order states by increasing distance from the zero state (`True`)?</span>
<span class="sd">    node_num_max : int|None, default: None</span>
<span class="sd">        If `n_max_steps` is `True`, further limit the search space dimensions to the first node_num_max</span>
<span class="sd">        nodes according to their hierarchical level (i.e. according to `BooleanNet.hier_node_level`)?</span>
<span class="sd">        We have found that all equilibrium solutions can be returned by selecting the a subset of nodes</span>
<span class="sd">        with the ones with the highest hierarchical level (i.e. closest to inputs) having maximum influence</span>
<span class="sd">        on the network.</span>
<span class="sd">    output_nodes_only : bool, default: False</span>
<span class="sd">        Define the uniqueness of equilibrium states using only the `BooleanNet.output_node_inds` (`True`) or</span>
<span class="sd">        by using all non-input node inds using `BooleanNet.noninput_node_inds` (`False`)?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    solsM : ndarray</span>
<span class="sd">        The matrix of unique equilibrium state solutions, with each solution appearing in columns, and each row</span>
<span class="sd">        representing the node expression level.</span>
<span class="sd">    charM_all : ndarray</span>
<span class="sd">        The dynamic characterization of each equilibrium state in solsM, as a linear array of</span>
<span class="sd">        [`EquilibriumType`][cellnition.science.network_models.network_enums]</span>
<span class="sd">        enumerations.</span>
<span class="sd">    sols_list : list</span>
<span class="sd">        The list of all (non-unique) equilibrium state solutions in the order that they were found.</span>
<span class="sd">    states_dict : OrderedDict</span>
<span class="sd">        A dictionary with keys as tuples representing each input state, and values being the equilibrium</span>
<span class="sd">        state index as the column index of `solsM`.</span>
<span class="sd">    sig_test_set : ndarray</span>
<span class="sd">        An array containing each of the input states (i.e. all binary-node-level combinations of</span>
<span class="sd">        `BooleanNet.input_node_inds`) which were applied to the network, for which equilibrium states</span>
<span class="sd">        of the network were found.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The BooleanNetwork object needs to have an analytical model constructed using&quot;</span>
                        <span class="s2">&quot;the build_boolean_model method.&quot;</span><span class="p">)</span>

    <span class="n">sig_lin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">sig_lin_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">sig_lin</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">]</span>

    <span class="n">sigGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">sig_lin_set</span><span class="p">)</span>

    <span class="n">N_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigGrid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

    <span class="n">sig_test_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_vocab</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sigM</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sigGrid</span><span class="p">):</span>
        <span class="n">sig_test_set</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigM</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="c1"># solsM_allo = np.zeros((self._bnet.N_nodes, 1))</span>
    <span class="c1"># charM_allo = [EquilibriumType.undetermined]</span>
    <span class="n">solsM_allo</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">charM_allo</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sols_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sigis</span> <span class="ow">in</span> <span class="n">sig_test_set</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Signals: </span><span class="si">{</span><span class="n">sigis</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sols_M</span><span class="p">,</span> <span class="n">sols_char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">solve_system_equms</span><span class="p">(</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">_A_bool_f</span><span class="p">,</span>
                                                    <span class="n">constraint_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                    <span class="n">constraint_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                    <span class="n">signal_constr_vals</span><span class="o">=</span><span class="n">sigis</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                                                    <span class="n">search_main_nodes_only</span><span class="o">=</span><span class="n">search_main_nodes_only</span><span class="p">,</span>
                                                    <span class="n">n_max_steps</span><span class="o">=</span><span class="n">n_max_steps</span><span class="p">,</span>
                                                    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                    <span class="n">node_num_max</span><span class="o">=</span><span class="n">node_num_max</span>
                                                    <span class="p">)</span>
        <span class="k">if</span> <span class="n">solsM_allo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">solsM_allo</span> <span class="o">=</span> <span class="n">sols_M</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">solsM_allo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">solsM_allo</span><span class="p">,</span> <span class="n">sols_M</span><span class="p">))</span>  <span class="c1"># append all unique sols</span>
        <span class="n">charM_allo</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sols_char</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>  <span class="c1"># append the sol stability characterization tags</span>
        <span class="n">sols_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols_M</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">sols_M</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----&#39;</span><span class="p">)</span>

    <span class="c1"># If desired, states can be defined as &quot;unique&quot; with respect to the output nodes only:</span>
    <span class="k">if</span> <span class="n">output_nodes_only</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span><span class="p">):</span>
        <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">output_node_inds</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">state_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bnet</span><span class="o">.</span><span class="n">noninput_node_inds</span>

    <span class="c1"># Eliminate duplicate states, but stack on strings of the eqm char</span>
    <span class="c1"># so we don&#39;t lose states with the same values but with different eq&#39;m:</span>
    <span class="c1"># chrm = [eqt.name for eqt in charM_allo]</span>
    <span class="c1"># checkM = np.vstack((solsM_allo[state_node_inds, :], chrm))</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">inds_solsM_all_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">solsM_allo</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">solsM_all</span> <span class="o">=</span> <span class="n">solsM_allo</span><span class="p">[:,</span> <span class="n">inds_solsM_all_unique</span><span class="p">]</span>
    <span class="n">charM_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">charM_allo</span><span class="p">)[</span><span class="n">inds_solsM_all_unique</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">order_by_distance</span><span class="p">:</span>
        <span class="c1"># Order states by distance from the zero vector</span>
        <span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_states_by_distance</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span><span class="p">)</span>

    <span class="n">states_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">sigi</span> <span class="ow">in</span> <span class="n">sig_test_set</span><span class="p">:</span>
        <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;Stability&#39;</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="k">for</span> <span class="n">sigi</span><span class="p">,</span> <span class="n">state_subseto</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sig_test_set</span><span class="p">,</span> <span class="n">sols_list</span><span class="p">):</span>
        <span class="n">state_subset</span> <span class="o">=</span> <span class="n">state_subseto</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">for</span> <span class="n">target_state</span> <span class="ow">in</span> <span class="n">state_subset</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
            <span class="n">state_match_index</span><span class="p">,</span> <span class="n">err_match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_state_match</span><span class="p">(</span><span class="n">solsM_all</span><span class="p">[</span><span class="n">state_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                                                  <span class="n">target_state</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">state_match_index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)][</span><span class="s1">&#39;States&#39;</span><span class="p">]:</span>
                <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)][</span><span class="s1">&#39;States&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state_match_index</span><span class="p">)</span>
                <span class="n">states_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sigi</span><span class="p">)][</span><span class="s1">&#39;Stability&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">charM_all</span><span class="p">[</span><span class="n">state_match_index</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">solsM_all</span><span class="p">,</span> <span class="n">charM_all</span><span class="p">,</span> <span class="n">sols_list</span><span class="p">,</span> <span class="n">states_dict</span><span class="p">,</span> <span class="n">sig_test_set</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>