
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../network_models_network_enums/">
      
      
        <link rel="next" href="../../2%29%20Construction%20of%20NFSMs/networks_toolbox_boolean_state_machine/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Continuous Network Model - Cellnition</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#continuous-network-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cellnition" class="md-header__button md-logo" aria-label="Cellnition" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cellnition
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Continuous Network Model
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cellnition" class="md-nav__button md-logo" aria-label="Cellnition" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cellnition
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Background
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    1) GRN Model Building
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            1) GRN Model Building
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_models_boolean_networks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boolean Network Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_models_interaction_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interaction Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_models_network_abc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Base Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_models_network_enums/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Enumerations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Continuous Network Model
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Continuous Network Model
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet" class="md-nav__link">
    <span class="md-ellipsis">
      ProbabilityNet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.build_adjacency_from_edge_type_list" class="md-nav__link">
    <span class="md-ellipsis">
      build_adjacency_from_edge_type_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.build_analytical_model" class="md-nav__link">
    <span class="md-ellipsis">
      build_analytical_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.create_numerical_dcdt" class="md-nav__link">
    <span class="md-ellipsis">
      create_numerical_dcdt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.edges_from_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      edges_from_adjacency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.find_attractor_sols" class="md-nav__link">
    <span class="md-ellipsis">
      find_attractor_sols
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.generate_state_space" class="md-nav__link">
    <span class="md-ellipsis">
      generate_state_space
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_adjacency_randomly" class="md-nav__link">
    <span class="md-ellipsis">
      get_adjacency_randomly
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_all_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_intervals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_function_args" class="md-nav__link">
    <span class="md-ellipsis">
      get_function_args
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_interval_inds" class="md-nav__link">
    <span class="md-ellipsis">
      get_interval_inds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_visual_equations" class="md-nav__link">
    <span class="md-ellipsis">
      get_visual_equations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.make_numerical_params" class="md-nav__link">
    <span class="md-ellipsis">
      make_numerical_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.make_pulsed_signals_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      make_pulsed_signals_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.make_time_vects" class="md-nav__link">
    <span class="md-ellipsis">
      make_time_vects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.multiround" class="md-nav__link">
    <span class="md-ellipsis">
      multiround
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.process_full_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      process_full_adjacency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.pulses" class="md-nav__link">
    <span class="md-ellipsis">
      pulses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.reduce_model_dimensions" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_model_dimensions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.run_time_sim" class="md-nav__link">
    <span class="md-ellipsis">
      run_time_sim
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.save_model_equations" class="md-nav__link">
    <span class="md-ellipsis">
      save_model_equations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.solve_probability_equms" class="md-nav__link">
    <span class="md-ellipsis">
      solve_probability_equms
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2) Construction of NFSMs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            2) Construction of NFSMs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2%29%20Construction%20of%20NFSMs/networks_toolbox_boolean_state_machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boolean Finite State Machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2%29%20Construction%20of%20NFSMs/networks_toolbox_state_machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continuous Finite State Machine
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    3) Additional GRN Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            3) Additional GRN Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/network_models_basic_network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/network_models_network_library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Library
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/networks_toolbox_gene_knockout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gene Knockout Simulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%29%20Additional%20GRN%20Resources/networks_toolbox_netplot_plotnetwork/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet" class="md-nav__link">
    <span class="md-ellipsis">
      ProbabilityNet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.build_adjacency_from_edge_type_list" class="md-nav__link">
    <span class="md-ellipsis">
      build_adjacency_from_edge_type_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.build_analytical_model" class="md-nav__link">
    <span class="md-ellipsis">
      build_analytical_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.create_numerical_dcdt" class="md-nav__link">
    <span class="md-ellipsis">
      create_numerical_dcdt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.edges_from_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      edges_from_adjacency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.find_attractor_sols" class="md-nav__link">
    <span class="md-ellipsis">
      find_attractor_sols
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.generate_state_space" class="md-nav__link">
    <span class="md-ellipsis">
      generate_state_space
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_adjacency_randomly" class="md-nav__link">
    <span class="md-ellipsis">
      get_adjacency_randomly
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_all_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_intervals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_function_args" class="md-nav__link">
    <span class="md-ellipsis">
      get_function_args
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_interval_inds" class="md-nav__link">
    <span class="md-ellipsis">
      get_interval_inds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.get_visual_equations" class="md-nav__link">
    <span class="md-ellipsis">
      get_visual_equations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.make_numerical_params" class="md-nav__link">
    <span class="md-ellipsis">
      make_numerical_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.make_pulsed_signals_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      make_pulsed_signals_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.make_time_vects" class="md-nav__link">
    <span class="md-ellipsis">
      make_time_vects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.multiround" class="md-nav__link">
    <span class="md-ellipsis">
      multiround
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.process_full_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      process_full_adjacency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.pulses" class="md-nav__link">
    <span class="md-ellipsis">
      pulses
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.reduce_model_dimensions" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_model_dimensions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.run_time_sim" class="md-nav__link">
    <span class="md-ellipsis">
      run_time_sim
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.save_model_equations" class="md-nav__link">
    <span class="md-ellipsis">
      save_model_equations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cellnition.science.network_models.probability_networks.ProbabilityNet.solve_probability_equms" class="md-nav__link">
    <span class="md-ellipsis">
      solve_probability_equms
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="continuous-network-model">Continuous Network Model</h1>


<div class="doc doc-object doc-class">



<a id="cellnition.science.network_models.probability_networks.ProbabilityNet"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="cellnition.science.network_models.network_abc.NetworkABC" href="../network_models_network_abc/#cellnition.science.network_models.network_abc.NetworkABC">NetworkABC</a></code></p>


        <p>This class builds a fully-continuous, differential-equation based model of a regulatory network
from a directed graph. The class can produce and characterize the directed graph upon which the continuous model
is based by importing from the Cellnition <a class="autorefs autorefs-internal" href="../../3%29%20Additional%20GRN%20Resources/network_models_network_library/#cellnition.science.network_models.network_library"><code>network_library</code></a>,
from user-defined edges, or by using procedurally generated
graphs. Once the directed graph representing the regulatory network is formed, <code>ProbabilityNet</code> generates
a continuous, differential-equation based analytic model of the regulatory network,
along with numerical counterparts for general simulation in time or in equilibrium state search.
The simulation object produced by this class can be used to build Network Finite State Machines (NFSMs) using the
<a class="autorefs autorefs-internal" href="../../2%29%20Construction%20of%20NFSMs/networks_toolbox_state_machine/#cellnition.science.networks_toolbox.state_machine.StateMachine"><code>StateMachine</code></a> class.</p>
<p>This class is called a "probability network", as the differential equations specifying change in regulatory
network node expression level produce output that is always limited to the range of 0.0 and 1.0, thereby
effectively computing the probability of seeing a gene product (node expression level) rather than an absolute
protein concentration (i.e. a node level = 0.21 represents a 21% probability of node expression).</p>







              <details class="quote">
                <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityNet</span><span class="p">(</span><span class="n">NetworkABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class builds a fully-continuous, differential-equation based model of a regulatory network</span>
<span class="sd">    from a directed graph. The class can produce and characterize the directed graph upon which the continuous model</span>
<span class="sd">    is based by importing from the Cellnition [`network_library`][cellnition.science.network_models.network_library],</span>
<span class="sd">    from user-defined edges, or by using procedurally generated</span>
<span class="sd">    graphs. Once the directed graph representing the regulatory network is formed, `ProbabilityNet` generates</span>
<span class="sd">    a continuous, differential-equation based analytic model of the regulatory network,</span>
<span class="sd">    along with numerical counterparts for general simulation in time or in equilibrium state search.</span>
<span class="sd">    The simulation object produced by this class can be used to build Network Finite State Machines (NFSMs) using the</span>
<span class="sd">    [`StateMachine`][cellnition.science.networks_toolbox.state_machine.StateMachine] class.</span>

<span class="sd">    This class is called a &quot;probability network&quot;, as the differential equations specifying change in regulatory</span>
<span class="sd">    network node expression level produce output that is always limited to the range of 0.0 and 1.0, thereby</span>
<span class="sd">    effectively computing the probability of seeing a gene product (node expression level) rather than an absolute</span>
<span class="sd">    protein concentration (i.e. a node level = 0.21 represents a 21% probability of node expression).</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">N_nodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">interaction_function_type</span><span class="p">:</span> <span class="n">InterFuncType</span> <span class="o">=</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">logistic</span><span class="p">,</span>
                 <span class="n">node_expression_levels</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialize the ProbabilityNet class.</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span> <span class="o">=</span> <span class="n">N_nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regular_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_list</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;G</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>

        <span class="c1"># Initialize some object state variables:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reduced_dims</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Indicate that model is full dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solved_analytically</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Indicate that the model does not have an analytical solution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Initialize this to None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_params_s</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># initialize this to be an empty list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge_types</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span> <span class="o">=</span> <span class="mf">1.0e-6</span> <span class="c1"># small nonzero element for working with Hill versions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_push_away_from_zero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span> <span class="c1"># smallish constant to push initial guess of fsolve away from zero</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>  <span class="c1"># Initialize the base class</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="o">=</span> <span class="n">interaction_function_type</span>

        <span class="k">if</span> <span class="n">node_expression_levels</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Node expression levels must be greater than 1!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_node_expression_levels</span> <span class="o">=</span> <span class="n">node_expression_levels</span>

        <span class="c1"># Matrix Equations:</span>
        <span class="c1"># Matrix symbols to construct matrix equation bases:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;M_n&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;M_beta&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;M_p&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>

        <span class="c1"># Define symbolic adjacency matrices to use as masks in defining multi and add matrices:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_A_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;A_add&#39;</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;A_mul&#39;</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">)</span>

        <span class="c1"># Now we can define symbolic matrices that use the add and mul adjacencies to mask which</span>
        <span class="c1"># n-parameters to use:</span>
        <span class="n">M_n_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_add_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">)</span>
        <span class="n">M_n_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">)</span>

        <span class="c1"># And functions can be plugged in as matrix equations; these are the fundamental</span>
        <span class="c1"># model building functions:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="ow">is</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">hill</span><span class="p">:</span>
            <span class="c1"># For Hill Functions:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                      <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="o">-</span><span class="n">M_n_add_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                      <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="o">-</span><span class="n">M_n_mul_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For Logistic Functions:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                      <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">M_n_add_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                      <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">M_n_mul_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))))</span>

        <span class="c1"># Symbolic model parameters:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_d_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Maximum rate of decay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_p_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Probability of gene product</span>

        <span class="c1"># Vectorized node-parameters and variables:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>  <span class="c1"># maximum rate of decay for each node</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_p_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)])</span>  <span class="c1"># gene product probability for each node</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_beta_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Hill centre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Hill coupling</span>

        <span class="c1"># Create a matrix out of the n_s symbols:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span>
                                <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span>
                                   <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

        <span class="c1"># Define vector of ones to use in matrix operations:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>

        <span class="c1"># Create a matrix that allows us to access the concentration vectors</span>
        <span class="c1"># duplicated along columns:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_adjacency_from_edge_type_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">edge_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">EdgeType</span><span class="p">],</span>
                        <span class="n">edges_index</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]],</span>
                        <span class="n">coupling_type</span><span class="p">:</span> <span class="n">CouplingType</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">specified</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Build A_full_s, an adjacency matrix that doesn&#39;t distinguish between additive</span>
        <span class="c1"># and multiplicative interactions:</span>
        <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">((</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">),</span> <span class="n">etype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">edges_index</span><span class="p">,</span> <span class="n">edge_types</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                <span class="n">A_full_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                <span class="n">A_full_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">((</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">),</span> <span class="n">etype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">edges_index</span><span class="p">,</span> <span class="n">edge_types</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">specified</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span><span class="p">:</span>
                    <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span><span class="p">:</span>
                    <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                    <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                    <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">additive</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                    <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                    <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">multiplicative</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                    <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                    <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                    <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                    <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">)</span>
        <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_mul_s</span><span class="p">)</span>
        <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_full_s</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">,</span> <span class="n">A_full_s</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_adjacency_randomly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coupling_type</span><span class="p">:</span> <span class="n">CouplingType</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">,</span> <span class="n">set_autoactivation</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return a randomly-generated full adjacency matrix.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">set_autoactivation</span><span class="p">:</span>
            <span class="c1"># Make it so that any diagonal elements are self-activating rather than self-inhibiting</span>
            <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span>
                                 <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">j</span> <span class="k">else</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>

        <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_full_adjacency</span><span class="p">(</span><span class="n">A_full_s</span><span class="p">,</span> <span class="n">coupling_type</span><span class="o">=</span><span class="n">coupling_type</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">,</span> <span class="n">A_full_s</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">edges_from_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A_add_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns edge type and edge index from adjacency matrices.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">edges_type</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges_index</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">A_add_s</span> <span class="o">+</span> <span class="n">A_mul_s</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
                <span class="n">afull_ij</span> <span class="o">=</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">afull_ij</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">edges_index</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">edges_index</span><span class="p">,</span> <span class="n">edges_type</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">process_full_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A_full_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span> <span class="n">coupling_type</span><span class="p">:</span> <span class="n">CouplingType</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Process a full adjacency matrix into additive and multiplicative components</span>
<span class="sd">        based on a specified coupling type.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
                <span class="n">afull_ij</span> <span class="o">=</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">afull_ij</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">additive</span> <span class="ow">or</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">:</span>
                        <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">multiplicative</span><span class="p">:</span>
                        <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;CouplingType.specified is not supported in this method.&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">afull_ij</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">additive</span><span class="p">:</span>
                        <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">multiplicative</span> <span class="ow">or</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">:</span>
                        <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;CouplingType.specified is not supported in this method.&#39;</span><span class="p">)</span>

        <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">)</span>
        <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_mul_s</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">build_analytical_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">A_add_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span>
                 <span class="n">A_mul_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span>
                               <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Initialize a list of node indices that should be constrained (removed from solution searches)</span>
        <span class="c1"># due to their lack of regulation:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">A_add_s</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Shape of A_add_s is not in terms of network node number!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">A_mul_s</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Shape of A_add_s is not in terms of network node number!&quot;</span><span class="p">)</span>

        <span class="n">M_funk_add_si</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_add_so</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
            <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_s</span><span class="p">),</span>
             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_s</span><span class="p">),</span>
             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_s</span><span class="p">),</span>
             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_add_so</span><span class="p">,</span> <span class="n">A_add_s</span><span class="p">)])</span>

        <span class="n">M_funk_mul_si</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_mul_so</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
            <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_s</span><span class="p">),</span>
             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_s</span><span class="p">),</span>
             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_s</span><span class="p">),</span>
             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_so</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">)])</span>

        <span class="c1"># Filter out the 1/2 terms and set to 0 (addiditive) or 1 (multiplicative):</span>
        <span class="n">M_funk_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="n">M_funk_add_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">M_funk_add_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>

        <span class="n">M_funk_mul_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">(</span>
            <span class="p">(</span><span class="n">M_funk_mul_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">M_funk_mul_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>

        <span class="c1"># As A_add_s is a signed adjacency matrix, we need to get the absolute value to count edges:</span>
        <span class="n">abs_A_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_add_s</span><span class="p">)</span>

        <span class="c1"># Count the nodes interacting (on input) with each node:</span>
        <span class="n">n_add_edges_i</span> <span class="o">=</span> <span class="n">abs_A_add_s</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span><span class="o">.</span><span class="n">T</span>
        <span class="c1"># Correct for any zeros in the n_add_edges and create a normalization object:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                      <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">((</span><span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_add_edges_i</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">n_add_edges_i</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">),</span>
                                                          <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>
        <span class="n">add_terms_i</span> <span class="o">=</span> <span class="n">M_funk_add_s</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span><span class="o">.</span><span class="n">T</span>

        <span class="c1"># The add_terms need to be normalized to keep concentrations between 0 and 1:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">,</span> <span class="n">add_terms_i</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">M_funk_mul_s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># if there&#39;s no add term and no mul term</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># set the rate of change of this unregulated node to zero</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1"># append this node to the list of nodes that should be constrained</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># remove the null add term to avoid nulling all growth</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># the node is a mix of additive and potential multiplicative regulation:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># This is an &quot;energy&quot; function to be minimized at the equilibrium points:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_opti_s</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">))[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Create linearized lists of symbolic parameters that are needed to solve the model (exclude the</span>
        <span class="c1"># zero entries of the M_n and M_beta matrices:</span>
        <span class="c1"># FIXME: need to rebuild the graph model if edges index changes...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="k">for</span> <span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="k">for</span> <span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_A_add_s</span> <span class="o">=</span> <span class="n">A_add_s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_s</span> <span class="o">=</span> <span class="n">A_mul_s</span>

        <span class="c1"># get the &quot;regular&quot; nodes:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">)</span>

        <span class="c1"># As we scale-down all concentrations for additive interactions so that the</span>
        <span class="c1"># concentration ranges between 0.0 and 1.0, we need to scale the out edge</span>
        <span class="c1"># beta parameter for these scaled-down nodes so that they signal as they would in</span>
        <span class="c1"># a fully dimensionalized model:</span>
        <span class="n">subs_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">(</span><span class="n">ndei</span><span class="p">,</span> <span class="n">ndej</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">[</span><span class="n">ndei</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="ow">is</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">logistic</span><span class="p">:</span>
                    <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">],</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">[</span><span class="n">ndei</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">],</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">[</span><span class="n">ndei</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_s_viz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcdt_vect_s_viz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visual_equations</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_numerical_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                       <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span>
                       <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                       <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Scrape the network for base parameters to initialize numerical parameters.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Node parameters:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">d_base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_base</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="s2">&quot;Length of d_base not equal to node number!&quot;</span>
            <span class="n">d_vect</span> <span class="o">=</span> <span class="n">d_base</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_base</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>

        <span class="c1"># Edge parameters:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">n_base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_base</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">,</span> <span class="s2">&quot;Length of n_base not equal to edge number!&quot;</span>
            <span class="n">n_vect</span> <span class="o">=</span> <span class="n">n_base</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_base</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta_base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">beta_base</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">,</span> <span class="s2">&quot;Length of n_base not equal to edge number!&quot;</span>
            <span class="n">beta_vect</span> <span class="o">=</span> <span class="n">beta_base</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">beta_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">beta_base</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">d_vect</span><span class="p">,</span> <span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_numerical_dcdt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">constrained_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">constrained_vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># First, lambdify the change vector in a way that supports any constraints:</span>
        <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">constrained_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Compute the symbolic Jacobian:</span>
            <span class="n">dcdt_jac_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">)</span> <span class="c1"># analytical Jacobian</span>

            <span class="n">dcdt_vect_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">),</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span>

            <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">),</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                     <span class="n">dcdt_jac_s</span><span class="p">)</span>


        <span class="k">else</span><span class="p">:</span> <span class="c1"># If there are constraints split the p-vals into an arguments and to-solve set:</span>
            <span class="n">c_vect_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">))[</span><span class="n">constrained_inds</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">c_vect_solve</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">))[</span><span class="n">unconstrained_inds</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

            <span class="c1"># truncate the change vector to only be for unconstrained inds:</span>
            <span class="n">dcdt_vect_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)[</span><span class="n">unconstrained_inds</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

            <span class="c1"># Compute the symbolic Jacobian:</span>
            <span class="n">dcdt_jac_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">c_vect_solve</span><span class="p">)</span> <span class="c1"># analytical Jacobian</span>

            <span class="n">dcdt_vect_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">c_vect_solve</span><span class="p">,</span>
                                       <span class="n">c_vect_args</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                      <span class="n">dcdt_vect_s</span><span class="p">)</span>

            <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">c_vect_solve</span><span class="p">,</span>
                                      <span class="n">c_vect_args</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                     <span class="n">dcdt_jac_s</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dcdt_vect_f</span><span class="p">,</span> <span class="n">dcdt_jac_f</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_function_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">constraint_vals</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                          <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
                          <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d_vect</span><span class="p">,</span> <span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_numerical_params</span><span class="p">(</span><span class="n">d_base</span><span class="p">,</span> <span class="n">n_base</span><span class="p">,</span> <span class="n">beta_base</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">constraint_vals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">function_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">constraint_vals</span><span class="p">,</span> <span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span><span class="p">,</span> <span class="n">d_vect</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">function_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span><span class="p">,</span> <span class="n">d_vect</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">function_args</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">c_inds</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                             <span class="n">N_space</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                             <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a discrete state space over the range of probabilities of</span>
<span class="sd">        each individual gene in the network.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c_lins</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c_inds</span><span class="p">:</span>
            <span class="n">c_lins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_min</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">N_space</span><span class="p">))</span>

        <span class="n">cGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">c_lins</span><span class="p">)</span>

        <span class="n">N_pts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cGrid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

        <span class="n">cM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_pts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cGrid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">c_inds</span><span class="p">,</span> <span class="n">cGrid</span><span class="p">):</span>
            <span class="n">cM</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cGrid</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">cM</span><span class="p">,</span> <span class="n">c_lins</span><span class="p">,</span> <span class="n">cGrid</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_probability_equms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">constraint_inds</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="n">constraint_vals</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="n">signal_constr_vals</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                                <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.0</span><span class="p">,</span>
                                <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
                                <span class="n">N_space</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="n">search_tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0e-15</span><span class="p">,</span>
                                <span class="n">sol_tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0e-1</span><span class="p">,</span>
                                <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="n">return_saddles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                <span class="n">search_main_nodes_only</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">node_num_max</span><span class="p">:</span> <span class="nb">int</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
                                <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Solve for the equilibrium points of gene product probabilities in</span>
<span class="sd">        terms of a given set of numerical parameters.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># For any network, there may be nodes without regulation that require constraints</span>
        <span class="c1"># (these are in self._constrained_nodes). Therefore, add these to any user-supplied</span>
        <span class="c1"># constraints:</span>
        <span class="n">constrained_inds</span><span class="p">,</span> <span class="n">constrained_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_constrained_nodes</span><span class="p">(</span><span class="n">constraint_inds</span><span class="p">,</span>
                                                                            <span class="n">constraint_vals</span><span class="p">,</span>
                                                                            <span class="n">signal_constr_vals</span><span class="o">=</span><span class="n">signal_constr_vals</span><span class="p">)</span>

        <span class="n">dcdt_vect_f</span><span class="p">,</span> <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_numerical_dcdt</span><span class="p">(</span><span class="n">constrained_inds</span><span class="o">=</span><span class="n">constrained_inds</span><span class="p">,</span>
                                                             <span class="n">constrained_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">node_num_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sort_hier_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hier_node_level</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">influence_node_inds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">)[</span><span class="n">sort_hier_inds</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">node_num_max</span><span class="p">])</span>


        <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">constrained_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">search_main_nodes_only</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="n">unconstrained_inds</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">node_num_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">node_num_max</span><span class="p">:</span>
                    <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">influence_node_inds</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No main nodes; cannot perform state search with &quot;</span>
                                <span class="s2">&quot;search_main_nodes_only=True.&quot;</span><span class="p">)</span>

        <span class="n">sol_Mo</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">function_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function_args</span><span class="p">(</span><span class="n">constraint_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">,</span>
                                               <span class="n">d_base</span><span class="o">=</span><span class="n">d_base</span><span class="p">,</span>
                                               <span class="n">n_base</span><span class="o">=</span><span class="n">n_base</span><span class="p">,</span>
                                               <span class="n">beta_base</span><span class="o">=</span><span class="n">beta_base</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_function_args</span> <span class="o">=</span> <span class="n">function_args</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cvecto</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">M_pstates</span><span class="p">):</span> <span class="c1"># for each test vector:</span>
            <span class="c1"># get values for the genes we&#39;re solving for...</span>
            <span class="c1"># Note: fsolve doesn&#39;t allow us to impose constraints so we need to push this initial guess</span>
            <span class="c1"># quite far away from zero with the added constant:</span>
            <span class="n">c_vect_sol</span> <span class="o">=</span> <span class="n">cvecto</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_push_away_from_zero</span>
            <span class="n">sol_roots</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">dcdt_vect_f</span><span class="p">,</span>
                               <span class="n">c_vect_sol</span><span class="p">,</span>
                               <span class="n">args</span><span class="o">=</span><span class="n">function_args</span><span class="p">,</span>
                               <span class="n">xtol</span><span class="o">=</span><span class="n">search_tol</span><span class="p">,</span>
                               <span class="n">fprime</span><span class="o">=</span><span class="n">dcdt_jac_f</span><span class="p">,</span>
                               <span class="n">col_deriv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="p">)</span>

            <span class="c1"># Find any roots below zero and constrain them to 0.0:</span>
            <span class="n">sol_roots</span><span class="p">[(</span><span class="n">sol_roots</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span>

            <span class="n">c_eqms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>
            <span class="n">c_eqms</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_roots</span>

            <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">constrained_vals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">c_eqms</span><span class="p">[</span><span class="n">constrained_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">constrained_vals</span>

            <span class="c1"># c_eqms = self.multiround(c_eqms)</span>

            <span class="n">sol_Mo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_eqms</span><span class="p">)</span>

        <span class="c1"># _, unique_inds = np.unique(np.round(sol_Mo, 2), axis=0, return_index=True)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">unique_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiround</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_Mo</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">sol_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_Mo</span><span class="p">)[</span><span class="n">unique_inds</span><span class="p">]</span>

        <span class="n">stable_sol_M</span><span class="p">,</span> <span class="n">sol_M_char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_attractor_sols</span><span class="p">(</span><span class="n">sol_M</span><span class="p">,</span>
                                                             <span class="n">dcdt_vect_f</span><span class="p">,</span>
                                                             <span class="n">dcdt_jac_f</span><span class="p">,</span>
                                                             <span class="n">function_args</span><span class="p">,</span>
                                                             <span class="n">constrained_inds</span><span class="o">=</span><span class="n">constrained_inds</span><span class="p">,</span>
                                                             <span class="n">tol</span><span class="o">=</span> <span class="n">sol_tol</span><span class="p">,</span>
                                                             <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                                                             <span class="n">save_file</span> <span class="o">=</span> <span class="n">save_file</span><span class="p">,</span>
                                                             <span class="n">return_saddles</span><span class="o">=</span><span class="n">return_saddles</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">stable_sol_M</span><span class="p">,</span> <span class="n">sol_M_char</span><span class="p">,</span> <span class="n">sol_M</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">find_attractor_sols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">sols_0</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                             <span class="n">dcdt_vect_f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
                             <span class="n">jac_f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
                             <span class="n">func_args</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                             <span class="n">constrained_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0e-1</span><span class="p">,</span>
                             <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">return_saddles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                             <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0e-20</span> <span class="c1"># Small value to avoid divide-by-zero in the jacobian</span>

        <span class="n">sol_dicts_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pminso</span> <span class="ow">in</span> <span class="n">sols_0</span><span class="p">:</span>

            <span class="n">solution_dict</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Minima Values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pminso</span>

            <span class="n">pmins</span> <span class="o">=</span> <span class="n">pminso</span> <span class="o">+</span> <span class="n">eps</span> <span class="c1"># add the small amount here, before calculating the jacobian</span>

            <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Change at Minima&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcdt_vect_f</span><span class="p">(</span><span class="n">pmins</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">],</span> <span class="o">*</span><span class="n">func_args</span><span class="p">)</span>

            <span class="n">jac</span> <span class="o">=</span> <span class="n">jac_f</span><span class="p">(</span><span class="n">pmins</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">],</span> <span class="o">*</span><span class="n">func_args</span><span class="p">)</span>
            <span class="c1"># get the eigenvalues of the jacobian at this equillibrium point:</span>
            <span class="n">eig_valso</span><span class="p">,</span> <span class="n">eig_vects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">jac</span><span class="p">)</span>

            <span class="c1"># round the eigenvalues so we don&#39;t have issue with small imaginary components</span>
            <span class="n">eig_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_valso</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_valso</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span>

            <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Jacobian Eigenvalues&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eig_vals</span>
            <span class="c1"># print(eig_vals)</span>

            <span class="c1"># get the indices of eigenvalues that have only real components:</span>
            <span class="n">real_eig_inds</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># If all eigenvalues are real and they&#39;re all negative then its an attractor:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_eig_inds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor</span><span class="o">.</span><span class="n">name</span>

            <span class="c1"># If all eigenvalues are real and they&#39;re all positive then its a repellor:</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_eig_inds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor</span><span class="o">.</span><span class="n">name</span>

            <span class="c1"># If all eigenvalues are real and they&#39;re a mix of positive and negative, then it&#39;s a saddle:</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_eig_inds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">[</span><span class="n">real_eig_inds</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)):</span>
                <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">saddle</span><span class="o">.</span><span class="n">name</span>

            <span class="c1"># If there are imaginary eigenvalue components and all real components are less than zero we</span>
            <span class="c1"># have a stable limit cycle:</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor_limit_cycle</span><span class="o">.</span><span class="n">name</span>

            <span class="c1"># If there are imaginary eigenvalue components and all real components are less than zero we</span>
            <span class="c1"># have a stable limit cycle:</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor_limit_cycle</span><span class="o">.</span><span class="n">name</span>

            <span class="c1"># If there are imaginary eigenvalues and a mix of real component signs, we only know its a limit cycle but can&#39;t say</span>
            <span class="c1"># anything certain about stability:</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">limit_cycle</span><span class="o">.</span><span class="n">name</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">undetermined</span><span class="o">.</span><span class="n">name</span>

            <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Stability Characteristic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">char_tag</span>

            <span class="n">sol_dicts_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solution_dict</span><span class="p">)</span>

        <span class="n">solsM</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sol_char_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sol_char_error</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">sol_dic</span> <span class="ow">in</span> <span class="n">sol_dicts_list</span><span class="p">:</span>
            <span class="c1"># print(&quot;Computing the reporting stuff&quot;)</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_dic</span><span class="p">[</span><span class="s1">&#39;Change at Minima&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">char</span> <span class="o">=</span> <span class="n">sol_dic</span><span class="p">[</span><span class="s1">&#39;Stability Characteristic&#39;</span><span class="p">]</span>
            <span class="n">sols</span> <span class="o">=</span> <span class="n">sol_dic</span><span class="p">[</span><span class="s1">&#39;Minima Values&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">return_saddles</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">char</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">saddle</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">error</span> <span class="o">&lt;=</span> <span class="n">tol</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Soln </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sols</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">solsM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols</span><span class="p">)</span>
                    <span class="n">sol_char_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                    <span class="n">sol_char_error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">error</span> <span class="o">&lt;=</span> <span class="n">tol</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Soln </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sols</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">solsM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols</span><span class="p">)</span>
                    <span class="n">sol_char_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                    <span class="n">sol_char_error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="n">solsM_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solsM</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">sol_char_list_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_char_list</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

        <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">solsMi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solsM</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solsMi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">csvwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>  <span class="c1"># create a csvwriter object</span>
                <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>  <span class="c1"># write the header</span>
                <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">sol_char_error</span><span class="p">)</span>  <span class="c1"># write the root error at steady-state</span>
                <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">sol_char_list</span><span class="p">)</span>  <span class="c1"># write the attractor characterization</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">solsMi</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
                    <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>  <span class="c1"># write the soln data rows for each gene</span>

        <span class="k">return</span> <span class="n">solsM_return</span><span class="p">,</span> <span class="n">sol_char_list_return</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_handle_constrained_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">constr_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">constr_vals</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">signal_constr_vals</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Networks will often have nodes without regulation that need to</span>
<span class="sd">        be constrained during optimization. This helper-method augments</span>
<span class="sd">        these naturally-occuring nodes with any additional constraints</span>
<span class="sd">        supplied by the user.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">len_constr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">signal_constr_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># default to zero</span>
            <span class="n">sig_vals</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_min</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">len_constr</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig_vals</span> <span class="o">=</span> <span class="n">signal_constr_vals</span>

        <span class="k">if</span> <span class="n">len_constr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">constr_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">constr_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">constrained_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">constrained_vals</span> <span class="o">=</span> <span class="n">sig_vals</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">constrained_inds</span> <span class="o">=</span> <span class="n">constr_inds</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">constrained_vals</span> <span class="o">=</span> <span class="n">constr_vals</span> <span class="o">+</span> <span class="n">sig_vals</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">constr_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">constr_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">constrained_inds</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">constrained_vals</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">constrained_inds</span> <span class="o">=</span> <span class="n">constr_inds</span><span class="o">*</span><span class="mi">1</span>
                <span class="n">constrained_vals</span> <span class="o">=</span> <span class="n">constr_vals</span><span class="o">*</span><span class="mi">1</span>

        <span class="k">return</span> <span class="n">constrained_inds</span><span class="p">,</span> <span class="n">constrained_vals</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">run_time_sim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">tvect</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                     <span class="n">tvectr</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                     <span class="n">cvecti</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                     <span class="n">sig_inds</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">sig_vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="n">lil_array</span><span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">constrained_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">constrained_vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                     <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.0</span><span class="p">,</span>
                     <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>
                     <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="n">tvect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tvect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sig_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">sig_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sig_inds</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sig_vals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">concs_time</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">dcdt_vect_f</span><span class="p">,</span> <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_numerical_dcdt</span><span class="p">(</span><span class="n">constrained_inds</span><span class="o">=</span><span class="n">constrained_inds</span><span class="p">,</span>
                                                             <span class="n">constrained_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">)</span>

        <span class="n">function_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function_args</span><span class="p">(</span><span class="n">constraint_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">,</span>
                                               <span class="n">d_base</span><span class="o">=</span><span class="n">d_base</span><span class="p">,</span>
                                               <span class="n">n_base</span><span class="o">=</span><span class="n">n_base</span><span class="p">,</span>
                                               <span class="n">beta_base</span><span class="o">=</span><span class="n">beta_base</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ti</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvect</span><span class="p">):</span>
            <span class="n">dcdt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dcdt_vect_f</span><span class="p">(</span><span class="n">cvecti</span><span class="p">,</span> <span class="o">*</span><span class="n">function_args</span><span class="p">))</span>
            <span class="n">cvecti</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dcdt</span>

            <span class="c1"># manually set the signal node values:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sig_vals</span><span class="p">)</span> <span class="ow">is</span> <span class="n">lil_array</span><span class="p">:</span>
                <span class="n">cvecti</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">,</span> <span class="n">sig_inds</span><span class="p">]</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cvecti</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">,</span> <span class="n">sig_inds</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">tvectr</span><span class="p">:</span>
                <span class="n">concs_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cvecti</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">concs_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">concs_time</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">concs_time</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_visual_equations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c_vect_viz</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">subs_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">nde_lab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_list</span><span class="p">):</span>
            <span class="n">nde_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nde_lab</span><span class="p">))</span>
            <span class="n">c_vect_viz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nde_sym</span><span class="p">)</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pi</span><span class="p">,</span> <span class="n">nde_sym</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nde_sym</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">(</span><span class="n">nij</span><span class="p">,</span> <span class="n">bij</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">)):</span>
            <span class="n">b_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;beta_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">n_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bij</span><span class="p">,</span> <span class="n">b_sym</span><span class="p">))</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nij</span><span class="p">,</span> <span class="n">n_sym</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_sym</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_sym</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ndei</span><span class="p">,</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">):</span>
            <span class="n">d_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;d_</span><span class="si">{</span><span class="n">ndei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">di</span><span class="p">,</span> <span class="n">d_sym</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_sym</span><span class="p">)</span>

        <span class="n">dcdt_vect_s_viz</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">c_vect_viz</span><span class="p">,</span> <span class="n">dcdt_vect_s_viz</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">save_model_equations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">save_eqn_image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                             <span class="n">save_reduced_eqn_image</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">save_eqn_csv</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">substitute_node_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                             <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Save images of the model equations, as well as a csv file that has</span>
<span class="sd">        model equations written in LaTeX format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        save_eqn_image : str</span>
<span class="sd">            The path and filename to save the main model equations as an image.</span>

<span class="sd">        save_reduced_eqn_image : str|None = None</span>
<span class="sd">            The path and filename to save the reduced main model equations as an image (if model is reduced).</span>

<span class="sd">        save_eqn_csv : str|None = None</span>
<span class="sd">            The path and filename to save the main and reduced model equations as LaTex in a csv file.</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">substitute_node_labels</span><span class="p">:</span>
            <span class="n">subs_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">nde_lab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_list</span><span class="p">):</span>
                <span class="n">nde_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">nde_lab</span><span class="p">)</span>
                <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pi</span><span class="p">,</span> <span class="n">nde_sym</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">(</span><span class="n">nij</span><span class="p">,</span> <span class="n">bij</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">)):</span>
                <span class="n">b_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;beta_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">n_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bij</span><span class="p">,</span> <span class="n">b_sym</span><span class="p">))</span>
                <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nij</span><span class="p">,</span> <span class="n">n_sym</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">ndei</span><span class="p">,</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">):</span>
                <span class="n">d_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;d_</span><span class="si">{</span><span class="n">ndei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">di</span><span class="p">,</span> <span class="n">d_sym</span><span class="p">))</span>

            <span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>
            <span class="n">_c_vect_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>
                <span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span>
            <span class="n">_c_vect_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span>
                <span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span>


        <span class="n">t_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="n">c_change</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">sp</span><span class="o">.</span><span class="n">Derivative</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">t_s</span><span class="p">)</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">_c_vect_s</span><span class="p">])</span>
        <span class="n">eqn_net</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">c_change</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">_dcdt_vect_s</span><span class="p">))</span>

        <span class="n">sp</span><span class="o">.</span><span class="n">preview</span><span class="p">(</span><span class="n">eqn_net</span><span class="p">,</span>
                   <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span>
                   <span class="n">filename</span><span class="o">=</span><span class="n">save_eqn_image</span><span class="p">,</span>
                   <span class="n">euler</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">dvioptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="s2">&quot;-z&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;--truecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;-D 600&quot;</span><span class="p">,</span> <span class="s2">&quot;-bg&quot;</span><span class="p">,</span> <span class="s2">&quot;Transparent&quot;</span><span class="p">])</span>

        <span class="c1"># Save the equations for the graph to a file:</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Concentrations&#39;</span><span class="p">,</span> <span class="s1">&#39;Change Vector&#39;</span><span class="p">]</span>
        <span class="n">eqns_to_write</span> <span class="o">=</span> <span class="p">[[</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_c_vect_s</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_dcdt_vect_s</span><span class="p">)]]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">save_reduced_eqn_image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c_change_reduced</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">sp</span><span class="o">.</span><span class="n">Derivative</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">t_s</span><span class="p">)</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">_c_vect_reduced_s</span><span class="p">])</span>
            <span class="n">eqn_net_reduced</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">c_change_reduced</span><span class="p">,</span> <span class="n">_dcdt_vect_reduced_s</span><span class="p">)</span>

            <span class="n">sp</span><span class="o">.</span><span class="n">preview</span><span class="p">(</span><span class="n">eqn_net_reduced</span><span class="p">,</span>
                       <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span>
                       <span class="n">filename</span><span class="o">=</span><span class="n">save_reduced_eqn_image</span><span class="p">,</span>
                       <span class="n">euler</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">dvioptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="s2">&quot;-z&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;--truecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;-D 600&quot;</span><span class="p">,</span> <span class="s2">&quot;-bg&quot;</span><span class="p">,</span> <span class="s2">&quot;Transparent&quot;</span><span class="p">])</span>

            <span class="n">eqns_to_write</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_c_vect_reduced_s</span><span class="p">))</span>
            <span class="n">eqns_to_write</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_dcdt_vect_reduced_s</span><span class="p">))</span>
            <span class="n">header</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;Reduced Concentations&#39;</span><span class="p">,</span> <span class="s1">&#39;Reduced Change Vector&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">save_eqn_csv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_eqn_csv</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">csvwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>  <span class="c1"># 2. create a csvwriter object</span>
                <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>  <span class="c1"># 4. write the header</span>
                <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">eqns_to_write</span><span class="p">)</span>  <span class="c1"># 5. write the rest of the data</span>

    <span class="c1"># ----Methods for Analytical Models--------</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reduce_model_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_nonlinsolve</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Using analytical methods, attempt to reduce the multidimensional</span>
<span class="sd">        network equations to as few equations as possible.</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Solve the nonlinear system as well as is possible:</span>
        <span class="n">nosol</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># We want to restrict this model reduction to homogeneous networks that</span>
        <span class="c1"># only contain genes and signals.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_node_inds</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="ow">is</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">logistic</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;System unsolvable due to use of logistic interaction function. Try Hill-type equations.&quot;</span><span class="p">)</span>
            <span class="n">nosol</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Immediately flag the sysem as unsolvable</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">use_nonlinsolve</span><span class="p">:</span>
                    <span class="n">sol_csetoo</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">nonlinsolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">:])</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sol_csetoo</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">:])</span>
                <span class="c1"># Clean up the sympy container for the solutions:</span>
                <span class="n">sol_cseto</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sol_csetoo</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol_cseto</span><span class="p">):</span>

                    <span class="n">c_master_i</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># the indices of concentrations involved in the master equations (the reduced dims)</span>
                    <span class="n">sol_cset</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># A dictionary of auxillary solutions (plug and play)</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c_eq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sol_cseto</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">c_eq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">:</span>  <span class="c1"># If it&#39;s a non-solution for the term, append it as a non-reduced conc.</span>
                            <span class="n">c_master_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c_eq</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Otherwise append the plug-and-play solution set:</span>
                            <span class="n">sol_cset</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">:][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">c_eq</span>

                    <span class="n">master_eq_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># master equations to be numerically optimized (reduced dimension network equations)</span>
                    <span class="n">c_vect_reduced</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># concentrations involved in the master equations</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_master_i</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">c_master_i</span><span class="p">:</span>
                            <span class="c1"># substitute in the expressions in terms of master concentrations to form the master equations:</span>
                            <span class="n">ci_solve_eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sol_cset</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
                            <span class="n">master_eq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ci_solve_eq</span><span class="p">)</span>
                            <span class="n">c_vect_reduced</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># if there&#39;s nothing in c_master_i but there are solutions in sol_cseto, then it&#39;s been fully solved:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The system has been fully solved by analytical methods!&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_solved_analytically</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No solutions found for the system.&quot;</span><span class="p">)</span>
                    <span class="n">nosol</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception called in Sympy.&quot;</span><span class="p">)</span>
                <span class="n">nosol</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Results:</span>
        <span class="k">if</span> <span class="n">nosol</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reduced_dims</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to reduce equations!&quot;</span><span class="p">)</span>
            <span class="c1"># Set all reduced system attributes to None:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_remainder_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># This is the dictionary of remaining concentrations that are in terms of the reduced concentrations,</span>
            <span class="c1"># such that when the master equation set is solved, the results are plugged into the equations in this</span>
            <span class="c1"># dictionary to obtain solutions for the whole network</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nonsignal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># If we have solutions, proceed:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reduced_dims</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solved_analytically</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="c1"># New equation list to be numerically optimized (should be significantly reduced dimensions):</span>
                <span class="c1"># Note: this vector is no longer the change rate vector; its now solving for concentrations</span>
                <span class="c1"># where the original rate change vector is zero:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">master_eq_list</span><span class="p">)</span>
                <span class="c1"># This is the concentration vector that contains the reduced equation concentration variables:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="n">c_vect_reduced</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span> <span class="o">=</span> <span class="n">c_master_i</span>  <span class="c1"># indices of concentrations that are being numerically optimized</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="p">)</span>  <span class="c1"># remaining conc indices</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_remainder_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># remaining concs</span>

                <span class="c1"># This is the dictionary of remaining concentrations that are in terms of the reduced concentrations,</span>
                <span class="c1"># such that when the master equation set is solved, the results are plugged into the equations in this</span>
                <span class="c1"># dictionary to obtain solutions for the whole network:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span> <span class="o">=</span> <span class="n">sol_cset</span>

                <span class="c1"># Create a set of signal node indices to the reduced c_vect array:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">si</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">si</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">nonsignal_reduced_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="p">)),</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Set most reduced system attributes to None:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_remainder_s</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nonsignal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="c1"># This is the dictionary of remaining concentrations that are in terms of the reduced concentrations,</span>
                <span class="c1"># such that when the master equation set is solved, the results are plugged into the equations in this</span>
                <span class="c1"># dictionary to obtain solutions for the whole network:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span> <span class="o">=</span> <span class="n">sol_cset</span>

                <span class="c1"># The sol_cset exists and can be lambdified for full solutions. Here we lambdify it without the c_vect:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_node_inds</span><span class="p">):</span>
                    <span class="n">lambda_params_r</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">extra_params_s</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lambda_params_r</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span> <span class="p">:]]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_f</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">ci</span><span class="p">,</span> <span class="n">eqci</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="c1"># self.sol_cset_f[ci.indices[0]] = sp.lambdify(lambda_params_r, eqci)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_f</span><span class="p">[</span><span class="n">ci</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">lambda_params_r</span><span class="p">,</span> <span class="n">eqci</span><span class="p">)</span>

    <span class="c1"># ----Time Dynamics Methods----------------</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pulses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">tvect</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
               <span class="n">t_on</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
               <span class="n">t_off</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
               <span class="n">c_base</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
               <span class="n">c_active</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
               <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">itop</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&gt;=</span> <span class="n">t_on</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ibot</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&lt;=</span> <span class="n">t_off</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ipulse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">ibot</span><span class="p">,</span> <span class="n">itop</span><span class="p">)</span>

        <span class="n">pulse_sig</span> <span class="o">=</span> <span class="n">c_active</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tvect</span><span class="p">))</span>

        <span class="n">pulse_sig</span><span class="p">[</span><span class="n">ipulse</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_base</span>

        <span class="k">return</span> <span class="n">pulse_sig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_interval_inds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">tvect</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                          <span class="n">t_on</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">t_off</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">t_wait</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
                          <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns indices specifying an interval from the</span>
<span class="sd">        supplied vector tvect spanning between vector</span>
<span class="sd">        values t_on and t_off.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t_vect : ndarray</span>
<span class="sd">            The vector to pull the interval from.</span>

<span class="sd">        t_on : float</span>
<span class="sd">            The first value in the vector defining the interval start.</span>

<span class="sd">        t_off : float</span>
<span class="sd">            The value in the vector defining the interval end.</span>

<span class="sd">        t_wait: float</span>
<span class="sd">            The amount of time to push up the start of the interval from</span>
<span class="sd">            t_on (which is useful if you&#39;re waiting for the system to get</span>
<span class="sd">            back to steady-state).</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">itop</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&gt;=</span> <span class="n">t_on</span> <span class="o">+</span> <span class="n">t_wait</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ibot</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&lt;=</span> <span class="n">t_off</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ipulse_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">ibot</span><span class="p">,</span> <span class="n">itop</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ipulse_inds</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_pulsed_signals_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                   <span class="n">tvect</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                                   <span class="n">sig_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                                   <span class="n">sig_times</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                                   <span class="n">sig_mag</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tvect</span><span class="p">)</span>

        <span class="n">c_signals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">))</span>  <span class="c1"># Initialize matrix holding the signal sequences</span>

        <span class="k">for</span> <span class="n">si</span><span class="p">,</span> <span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">te</span><span class="p">),</span> <span class="p">(</span><span class="n">smin</span><span class="p">,</span> <span class="n">smax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sig_inds</span><span class="p">,</span> <span class="n">sig_times</span><span class="p">,</span> <span class="n">sig_mag</span><span class="p">):</span>
            <span class="n">c_signals</span><span class="p">[:,</span> <span class="n">si</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                            <span class="n">ts</span><span class="p">,</span>
                                            <span class="n">te</span><span class="p">,</span>
                                            <span class="n">c_base</span><span class="o">=</span><span class="n">smax</span><span class="p">,</span>
                                            <span class="n">c_active</span><span class="o">=</span><span class="n">smin</span>
                                            <span class="p">)</span>

        <span class="k">return</span> <span class="n">c_signals</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_intervals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">tvect</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                          <span class="n">sig_times</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                          <span class="n">t_wait</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
                          <span class="n">add_end_intervals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                          <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">intervals_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># Initialize set to hold the interval indices</span>

        <span class="c1"># sig_times = sorted(sig_times) # sort the time tuples by their start time</span>
        <span class="n">sig_times</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># sort the time tuples by their start time</span>

        <span class="k">for</span> <span class="n">ts</span><span class="p">,</span> <span class="n">te</span> <span class="ow">in</span> <span class="n">sig_times</span><span class="p">:</span>
            <span class="n">inti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_interval_inds</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                          <span class="n">ts</span><span class="p">,</span>
                                          <span class="n">te</span><span class="p">,</span>
                                          <span class="n">t_wait</span><span class="o">=</span><span class="n">t_wait</span>
                                          <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inti</span><span class="p">):</span>
                <span class="n">intervals_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">inti</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inti</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">add_end_intervals</span><span class="p">:</span>
            <span class="c1"># Add a start interval</span>
            <span class="n">intis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_interval_inds</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                           <span class="n">tvect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                           <span class="n">sig_times</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                           <span class="n">t_wait</span><span class="o">=</span><span class="n">t_wait</span>
                                           <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intis</span><span class="p">):</span>
                <span class="n">intervals_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">intis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">intis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

            <span class="c1"># Add an end interval:</span>
            <span class="n">intie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_interval_inds</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                           <span class="n">sig_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                           <span class="n">tvect</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                           <span class="n">t_wait</span><span class="o">=</span><span class="n">t_wait</span>
                                           <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intie</span><span class="p">):</span>
                <span class="n">intervals_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">intie</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">intie</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">intervals_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">intervals_set</span><span class="p">)</span>
        <span class="n">intervals_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># sort the time tuples by their start time</span>

        <span class="k">return</span> <span class="n">intervals_list</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_time_vects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">tend</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">dt_samp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tend</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">tvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tend</span><span class="p">,</span> <span class="n">Nt</span><span class="p">)</span>

        <span class="c1"># sampling compression</span>
        <span class="k">if</span> <span class="n">dt_samp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sampr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dt_samp</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
            <span class="n">tvectr</span> <span class="o">=</span> <span class="n">tvect</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="n">sampr</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tvectr</span> <span class="o">=</span> <span class="n">tvect</span>

        <span class="c1"># make a time-step update vector so we can update any sensors as</span>
        <span class="c1"># an absolute reading (dt = 1.0) while treating the kinetics of the</span>
        <span class="c1"># other node types:</span>
        <span class="c1"># dtv = dt * np.ones(self._N_nodes)</span>
        <span class="c1"># dtv[self.sensor_node_inds] = 1.0</span>

        <span class="k">return</span> <span class="n">tvect</span><span class="p">,</span> <span class="n">tvectr</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">multiround</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Perform a rounding procedure to 1/(node_expression_levels - 1) level of resolution.</span>
<span class="sd">        For example, if node_expression_levels = 5.0, then this will round values to 0.0, 0.25, 0.5, 0.75, and 1.0.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">cc</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_expression_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_expression_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cc</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">interaction_function_type</span><span class="o">=</span><span class="n">InterFuncType</span><span class="o">.</span><span class="n">logistic</span><span class="p">,</span> <span class="n">node_expression_levels</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initialize the ProbabilityNet class.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">N_nodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">interaction_function_type</span><span class="p">:</span> <span class="n">InterFuncType</span> <span class="o">=</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">logistic</span><span class="p">,</span>
             <span class="n">node_expression_levels</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Initialize the ProbabilityNet class.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span> <span class="o">=</span> <span class="n">N_nodes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regular_node_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_list</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;G</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>

    <span class="c1"># Initialize some object state variables:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_reduced_dims</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Indicate that model is full dimensions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_solved_analytically</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Indicate that the model does not have an analytical solution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Initialize this to None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">process_params_s</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># initialize this to be an empty list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">edge_types</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span> <span class="o">=</span> <span class="mf">1.0e-6</span> <span class="c1"># small nonzero element for working with Hill versions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_push_away_from_zero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span> <span class="c1"># smallish constant to push initial guess of fsolve away from zero</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>  <span class="c1"># Initialize the base class</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="o">=</span> <span class="n">interaction_function_type</span>

    <span class="k">if</span> <span class="n">node_expression_levels</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Node expression levels must be greater than 1!&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_node_expression_levels</span> <span class="o">=</span> <span class="n">node_expression_levels</span>

    <span class="c1"># Matrix Equations:</span>
    <span class="c1"># Matrix symbols to construct matrix equation bases:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;M_n&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;M_beta&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;M_p&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>

    <span class="c1"># Define symbolic adjacency matrices to use as masks in defining multi and add matrices:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_A_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;A_add&#39;</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">MatrixSymbol</span><span class="p">(</span><span class="s1">&#39;A_mul&#39;</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">)</span>

    <span class="c1"># Now we can define symbolic matrices that use the add and mul adjacencies to mask which</span>
    <span class="c1"># n-parameters to use:</span>
    <span class="n">M_n_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_add_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">)</span>
    <span class="n">M_n_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">)</span>

    <span class="c1"># And functions can be plugged in as matrix equations; these are the fundamental</span>
    <span class="c1"># model building functions:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="ow">is</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">hill</span><span class="p">:</span>
        <span class="c1"># For Hill Functions:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                  <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="o">-</span><span class="n">M_n_add_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                  <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="o">-</span><span class="n">M_n_mul_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># For Logistic Functions:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_add_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                  <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">M_n_add_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_mul_so</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">N_nodes</span><span class="p">,</span>
                                  <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">M_n_mul_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]))))</span>

    <span class="c1"># Symbolic model parameters:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_d_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Maximum rate of decay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_p_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Probability of gene product</span>

    <span class="c1"># Vectorized node-parameters and variables:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>  <span class="c1"># maximum rate of decay for each node</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_p_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)])</span>  <span class="c1"># gene product probability for each node</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_beta_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Hill centre</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_n_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">IndexedBase</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Hill coupling</span>

    <span class="c1"># Create a matrix out of the n_s symbols:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span>
                            <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span>
                               <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>

    <span class="c1"># Define vector of ones to use in matrix operations:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>

    <span class="c1"># Create a matrix that allows us to access the concentration vectors</span>
    <span class="c1"># duplicated along columns:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.build_adjacency_from_edge_type_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_adjacency_from_edge_type_list</span><span class="p">(</span><span class="n">edge_types</span><span class="p">,</span> <span class="n">edges_index</span><span class="p">,</span> <span class="n">coupling_type</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">specified</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_adjacency_from_edge_type_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">edge_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">EdgeType</span><span class="p">],</span>
                    <span class="n">edges_index</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]],</span>
                    <span class="n">coupling_type</span><span class="p">:</span> <span class="n">CouplingType</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">specified</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Build A_full_s, an adjacency matrix that doesn&#39;t distinguish between additive</span>
    <span class="c1"># and multiplicative interactions:</span>
    <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">((</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">),</span> <span class="n">etype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">edges_index</span><span class="p">,</span> <span class="n">edge_types</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
            <span class="n">A_full_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
            <span class="n">A_full_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">((</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">),</span> <span class="n">etype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">edges_index</span><span class="p">,</span> <span class="n">edge_types</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">specified</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span><span class="p">:</span>
                <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span><span class="p">:</span>
                <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">additive</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">multiplicative</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">:</span>
                <span class="n">A_add_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span> <span class="ow">or</span> <span class="n">etype</span> <span class="ow">is</span> <span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">:</span>
                <span class="n">A_mul_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">)</span>
    <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_mul_s</span><span class="p">)</span>
    <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_full_s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">,</span> <span class="n">A_full_s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.build_analytical_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_analytical_model</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_analytical_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">A_add_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span>
             <span class="n">A_mul_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span>
                           <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Initialize a list of node indices that should be constrained (removed from solution searches)</span>
    <span class="c1"># due to their lack of regulation:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">A_add_s</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Shape of A_add_s is not in terms of network node number!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">A_mul_s</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Shape of A_add_s is not in terms of network node number!&quot;</span><span class="p">)</span>

    <span class="n">M_funk_add_si</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_add_so</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
        <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_s</span><span class="p">),</span>
         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_s</span><span class="p">),</span>
         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_s</span><span class="p">),</span>
         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_add_so</span><span class="p">,</span> <span class="n">A_add_s</span><span class="p">)])</span>

    <span class="n">M_funk_mul_si</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_funk_mul_so</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
        <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_p_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_p_s</span><span class="p">),</span>
         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_n_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_n_s</span><span class="p">),</span>
         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_so</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_M_beta_s</span><span class="p">),</span>
         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_so</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">)])</span>

    <span class="c1"># Filter out the 1/2 terms and set to 0 (addiditive) or 1 (multiplicative):</span>
    <span class="n">M_funk_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">(</span>
        <span class="p">(</span><span class="n">M_funk_add_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">M_funk_add_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>

    <span class="n">M_funk_mul_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">(</span>
        <span class="p">(</span><span class="n">M_funk_mul_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">M_funk_mul_si</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>

    <span class="c1"># As A_add_s is a signed adjacency matrix, we need to get the absolute value to count edges:</span>
    <span class="n">abs_A_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_add_s</span><span class="p">)</span>

    <span class="c1"># Count the nodes interacting (on input) with each node:</span>
    <span class="n">n_add_edges_i</span> <span class="o">=</span> <span class="n">abs_A_add_s</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span><span class="o">.</span><span class="n">T</span>
    <span class="c1"># Correct for any zeros in the n_add_edges and create a normalization object:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">((</span><span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_add_edges_i</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]),</span> <span class="n">n_add_edges_i</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">),</span>
                                                      <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>
    <span class="n">add_terms_i</span> <span class="o">=</span> <span class="n">M_funk_add_s</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ones_vect</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># The add_terms need to be normalized to keep concentrations between 0 and 1:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">hadamard_product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">,</span> <span class="n">add_terms_i</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">M_funk_mul_s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># if there&#39;s no add term and no mul term</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># set the rate of change of this unregulated node to zero</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1"># append this node to the list of nodes that should be constrained</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># remove the null add term to avoid nulling all growth</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># the node is a mix of additive and potential multiplicative regulation:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># This is an &quot;energy&quot; function to be minimized at the equilibrium points:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_opti_s</span> <span class="o">=</span> <span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">))[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Create linearized lists of symbolic parameters that are needed to solve the model (exclude the</span>
    <span class="c1"># zero entries of the M_n and M_beta matrices:</span>
    <span class="c1"># FIXME: need to rebuild the graph model if edges index changes...</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="k">for</span> <span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_s</span><span class="p">[</span><span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span><span class="p">]</span> <span class="k">for</span> <span class="n">nde_i</span><span class="p">,</span> <span class="n">nde_j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_A_add_s</span> <span class="o">=</span> <span class="n">A_add_s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_A_mul_s</span> <span class="o">=</span> <span class="n">A_mul_s</span>

    <span class="c1"># get the &quot;regular&quot; nodes:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">)</span>

    <span class="c1"># As we scale-down all concentrations for additive interactions so that the</span>
    <span class="c1"># concentration ranges between 0.0 and 1.0, we need to scale the out edge</span>
    <span class="c1"># beta parameter for these scaled-down nodes so that they signal as they would in</span>
    <span class="c1"># a fully dimensionalized model:</span>
    <span class="n">subs_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">(</span><span class="n">ndei</span><span class="p">,</span> <span class="n">ndej</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges_index</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">[</span><span class="n">ndei</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="ow">is</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">logistic</span><span class="p">:</span>
                <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">],</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">[</span><span class="n">ndei</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">],</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">[</span><span class="n">ei</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_add_edges</span><span class="p">[</span><span class="n">ndei</span><span class="p">]))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_s_viz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcdt_vect_s_viz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visual_equations</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.create_numerical_dcdt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_numerical_dcdt</span><span class="p">(</span><span class="n">constrained_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constrained_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_numerical_dcdt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">constrained_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">constrained_vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># First, lambdify the change vector in a way that supports any constraints:</span>
    <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">constrained_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Compute the symbolic Jacobian:</span>
        <span class="n">dcdt_jac_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">)</span> <span class="c1"># analytical Jacobian</span>

        <span class="n">dcdt_vect_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">),</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span>

        <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">),</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                 <span class="n">dcdt_jac_s</span><span class="p">)</span>


    <span class="k">else</span><span class="p">:</span> <span class="c1"># If there are constraints split the p-vals into an arguments and to-solve set:</span>
        <span class="n">c_vect_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">))[</span><span class="n">constrained_inds</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">c_vect_solve</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">))[</span><span class="n">unconstrained_inds</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="c1"># truncate the change vector to only be for unconstrained inds:</span>
        <span class="n">dcdt_vect_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)[</span><span class="n">unconstrained_inds</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="c1"># Compute the symbolic Jacobian:</span>
        <span class="n">dcdt_jac_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">c_vect_solve</span><span class="p">)</span> <span class="c1"># analytical Jacobian</span>

        <span class="n">dcdt_vect_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">c_vect_solve</span><span class="p">,</span>
                                   <span class="n">c_vect_args</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                  <span class="n">dcdt_vect_s</span><span class="p">)</span>

        <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">c_vect_solve</span><span class="p">,</span>
                                  <span class="n">c_vect_args</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">),</span>
                                 <span class="n">dcdt_jac_s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dcdt_vect_f</span><span class="p">,</span> <span class="n">dcdt_jac_f</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.edges_from_adjacency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges_from_adjacency</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns edge type and edge index from adjacency matrices.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">edges_from_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A_add_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns edge type and edge index from adjacency matrices.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">edges_type</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">edges_index</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">A_add_s</span> <span class="o">+</span> <span class="n">A_mul_s</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
            <span class="n">afull_ij</span> <span class="o">=</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">afull_ij</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">edges_index</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">Is</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">As</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edges_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EdgeType</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">edges_index</span><span class="p">,</span> <span class="n">edges_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.find_attractor_sols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_attractor_sols</span><span class="p">(</span><span class="n">sols_0</span><span class="p">,</span> <span class="n">dcdt_vect_f</span><span class="p">,</span> <span class="n">jac_f</span><span class="p">,</span> <span class="n">func_args</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_saddles</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_attractor_sols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">sols_0</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                         <span class="n">dcdt_vect_f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
                         <span class="n">jac_f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
                         <span class="n">func_args</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                         <span class="n">constrained_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0e-1</span><span class="p">,</span>
                         <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">return_saddles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                         <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0e-20</span> <span class="c1"># Small value to avoid divide-by-zero in the jacobian</span>

    <span class="n">sol_dicts_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pminso</span> <span class="ow">in</span> <span class="n">sols_0</span><span class="p">:</span>

        <span class="n">solution_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Minima Values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pminso</span>

        <span class="n">pmins</span> <span class="o">=</span> <span class="n">pminso</span> <span class="o">+</span> <span class="n">eps</span> <span class="c1"># add the small amount here, before calculating the jacobian</span>

        <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Change at Minima&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcdt_vect_f</span><span class="p">(</span><span class="n">pmins</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">],</span> <span class="o">*</span><span class="n">func_args</span><span class="p">)</span>

        <span class="n">jac</span> <span class="o">=</span> <span class="n">jac_f</span><span class="p">(</span><span class="n">pmins</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">],</span> <span class="o">*</span><span class="n">func_args</span><span class="p">)</span>
        <span class="c1"># get the eigenvalues of the jacobian at this equillibrium point:</span>
        <span class="n">eig_valso</span><span class="p">,</span> <span class="n">eig_vects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">jac</span><span class="p">)</span>

        <span class="c1"># round the eigenvalues so we don&#39;t have issue with small imaginary components</span>
        <span class="n">eig_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_valso</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_valso</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span>

        <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Jacobian Eigenvalues&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eig_vals</span>
        <span class="c1"># print(eig_vals)</span>

        <span class="c1"># get the indices of eigenvalues that have only real components:</span>
        <span class="n">real_eig_inds</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># If all eigenvalues are real and they&#39;re all negative then its an attractor:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_eig_inds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># If all eigenvalues are real and they&#39;re all positive then its a repellor:</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_eig_inds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># If all eigenvalues are real and they&#39;re a mix of positive and negative, then it&#39;s a saddle:</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_eig_inds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">[</span><span class="n">real_eig_inds</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)):</span>
            <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">saddle</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># If there are imaginary eigenvalue components and all real components are less than zero we</span>
        <span class="c1"># have a stable limit cycle:</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">attractor_limit_cycle</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># If there are imaginary eigenvalue components and all real components are less than zero we</span>
        <span class="c1"># have a stable limit cycle:</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">repellor_limit_cycle</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># If there are imaginary eigenvalues and a mix of real component signs, we only know its a limit cycle but can&#39;t say</span>
        <span class="c1"># anything certain about stability:</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eig_vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">limit_cycle</span><span class="o">.</span><span class="n">name</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">char_tag</span> <span class="o">=</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">undetermined</span><span class="o">.</span><span class="n">name</span>

        <span class="n">solution_dict</span><span class="p">[</span><span class="s1">&#39;Stability Characteristic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">char_tag</span>

        <span class="n">sol_dicts_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solution_dict</span><span class="p">)</span>

    <span class="n">solsM</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sol_char_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sol_char_error</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">sol_dic</span> <span class="ow">in</span> <span class="n">sol_dicts_list</span><span class="p">:</span>
        <span class="c1"># print(&quot;Computing the reporting stuff&quot;)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_dic</span><span class="p">[</span><span class="s1">&#39;Change at Minima&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">char</span> <span class="o">=</span> <span class="n">sol_dic</span><span class="p">[</span><span class="s1">&#39;Stability Characteristic&#39;</span><span class="p">]</span>
        <span class="n">sols</span> <span class="o">=</span> <span class="n">sol_dic</span><span class="p">[</span><span class="s1">&#39;Minima Values&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">return_saddles</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">char</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EquilibriumType</span><span class="o">.</span><span class="n">saddle</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">error</span> <span class="o">&lt;=</span> <span class="n">tol</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Soln </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sols</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">solsM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols</span><span class="p">)</span>
                <span class="n">sol_char_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="n">sol_char_error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">&lt;=</span> <span class="n">tol</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Soln </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sols</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">solsM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols</span><span class="p">)</span>
                <span class="n">sol_char_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="n">sol_char_error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

    <span class="n">solsM_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solsM</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">sol_char_list_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_char_list</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="k">if</span> <span class="n">save_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">solsMi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solsM</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solsMi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">csvwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>  <span class="c1"># create a csvwriter object</span>
            <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>  <span class="c1"># write the header</span>
            <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">sol_char_error</span><span class="p">)</span>  <span class="c1"># write the root error at steady-state</span>
            <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">sol_char_list</span><span class="p">)</span>  <span class="c1"># write the attractor characterization</span>
            <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">solsMi</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
                <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>  <span class="c1"># write the soln data rows for each gene</span>

    <span class="k">return</span> <span class="n">solsM_return</span><span class="p">,</span> <span class="n">sol_char_list_return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.generate_state_space" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_state_space</span><span class="p">(</span><span class="n">c_inds</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate a discrete state space over the range of probabilities of
each individual gene in the network.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">c_inds</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                         <span class="n">N_space</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                         <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Generate a discrete state space over the range of probabilities of</span>
<span class="sd">    each individual gene in the network.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">c_lins</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c_inds</span><span class="p">:</span>
        <span class="n">c_lins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_min</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">N_space</span><span class="p">))</span>

    <span class="n">cGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">c_lins</span><span class="p">)</span>

    <span class="n">N_pts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cGrid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

    <span class="n">cM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_pts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cGrid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">c_inds</span><span class="p">,</span> <span class="n">cGrid</span><span class="p">):</span>
        <span class="n">cM</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cGrid</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">cM</span><span class="p">,</span> <span class="n">c_lins</span><span class="p">,</span> <span class="n">cGrid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.get_adjacency_randomly" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_adjacency_randomly</span><span class="p">(</span><span class="n">coupling_type</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">,</span> <span class="n">set_autoactivation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return a randomly-generated full adjacency matrix.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_adjacency_randomly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coupling_type</span><span class="p">:</span> <span class="n">CouplingType</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">,</span> <span class="n">set_autoactivation</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return a randomly-generated full adjacency matrix.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">set_autoactivation</span><span class="p">:</span>
        <span class="c1"># Make it so that any diagonal elements are self-activating rather than self-inhibiting</span>
        <span class="n">A_full_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span>
                             <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">j</span> <span class="k">else</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>

    <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_full_adjacency</span><span class="p">(</span><span class="n">A_full_s</span><span class="p">,</span> <span class="n">coupling_type</span><span class="o">=</span><span class="n">coupling_type</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span><span class="p">,</span> <span class="n">A_full_s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.get_all_intervals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_intervals</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span> <span class="n">sig_times</span><span class="p">,</span> <span class="n">t_wait</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">add_end_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_intervals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">tvect</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                      <span class="n">sig_times</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                      <span class="n">t_wait</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
                      <span class="n">add_end_intervals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                      <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">intervals_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># Initialize set to hold the interval indices</span>

    <span class="c1"># sig_times = sorted(sig_times) # sort the time tuples by their start time</span>
    <span class="n">sig_times</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># sort the time tuples by their start time</span>

    <span class="k">for</span> <span class="n">ts</span><span class="p">,</span> <span class="n">te</span> <span class="ow">in</span> <span class="n">sig_times</span><span class="p">:</span>
        <span class="n">inti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_interval_inds</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                      <span class="n">ts</span><span class="p">,</span>
                                      <span class="n">te</span><span class="p">,</span>
                                      <span class="n">t_wait</span><span class="o">=</span><span class="n">t_wait</span>
                                      <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inti</span><span class="p">):</span>
            <span class="n">intervals_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">inti</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inti</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">add_end_intervals</span><span class="p">:</span>
        <span class="c1"># Add a start interval</span>
        <span class="n">intis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_interval_inds</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                       <span class="n">tvect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="n">sig_times</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="n">t_wait</span><span class="o">=</span><span class="n">t_wait</span>
                                       <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intis</span><span class="p">):</span>
            <span class="n">intervals_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">intis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">intis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="c1"># Add an end interval:</span>
        <span class="n">intie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_interval_inds</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                       <span class="n">sig_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">tvect</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">t_wait</span><span class="o">=</span><span class="n">t_wait</span>
                                       <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intie</span><span class="p">):</span>
            <span class="n">intervals_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">intie</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">intie</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="n">intervals_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">intervals_set</span><span class="p">)</span>
    <span class="n">intervals_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># sort the time tuples by their start time</span>

    <span class="k">return</span> <span class="n">intervals_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.get_function_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_function_args</span><span class="p">(</span><span class="n">constraint_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_base</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_base</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">beta_base</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_function_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">constraint_vals</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                      <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
                      <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">d_vect</span><span class="p">,</span> <span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_numerical_params</span><span class="p">(</span><span class="n">d_base</span><span class="p">,</span> <span class="n">n_base</span><span class="p">,</span> <span class="n">beta_base</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">constraint_vals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">function_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">constraint_vals</span><span class="p">,</span> <span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span><span class="p">,</span> <span class="n">d_vect</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">function_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span><span class="p">,</span> <span class="n">d_vect</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">function_args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.get_interval_inds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_interval_inds</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span> <span class="n">t_on</span><span class="p">,</span> <span class="n">t_off</span><span class="p">,</span> <span class="n">t_wait</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns indices specifying an interval from the
supplied vector tvect spanning between vector
values t_on and t_off.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_vect</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector to pull the interval from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_on</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first value in the vector defining the interval start.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_off</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value in the vector defining the interval end.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_wait</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The amount of time to push up the start of the interval from
t_on (which is useful if you're waiting for the system to get
back to steady-state).</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_interval_inds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">tvect</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span>
                      <span class="n">t_on</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">t_off</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">t_wait</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
                      <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns indices specifying an interval from the</span>
<span class="sd">    supplied vector tvect spanning between vector</span>
<span class="sd">    values t_on and t_off.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t_vect : ndarray</span>
<span class="sd">        The vector to pull the interval from.</span>

<span class="sd">    t_on : float</span>
<span class="sd">        The first value in the vector defining the interval start.</span>

<span class="sd">    t_off : float</span>
<span class="sd">        The value in the vector defining the interval end.</span>

<span class="sd">    t_wait: float</span>
<span class="sd">        The amount of time to push up the start of the interval from</span>
<span class="sd">        t_on (which is useful if you&#39;re waiting for the system to get</span>
<span class="sd">        back to steady-state).</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">itop</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&gt;=</span> <span class="n">t_on</span> <span class="o">+</span> <span class="n">t_wait</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ibot</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&lt;=</span> <span class="n">t_off</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ipulse_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">ibot</span><span class="p">,</span> <span class="n">itop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ipulse_inds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.get_visual_equations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_visual_equations</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_visual_equations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">c_vect_viz</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">subs_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">nde_lab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_list</span><span class="p">):</span>
        <span class="n">nde_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nde_lab</span><span class="p">))</span>
        <span class="n">c_vect_viz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nde_sym</span><span class="p">)</span>
        <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pi</span><span class="p">,</span> <span class="n">nde_sym</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nde_sym</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">(</span><span class="n">nij</span><span class="p">,</span> <span class="n">bij</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">)):</span>
        <span class="n">b_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;beta_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">n_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bij</span><span class="p">,</span> <span class="n">b_sym</span><span class="p">))</span>
        <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nij</span><span class="p">,</span> <span class="n">n_sym</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_sym</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_sym</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ndei</span><span class="p">,</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">):</span>
        <span class="n">d_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;d_</span><span class="si">{</span><span class="n">ndei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">di</span><span class="p">,</span> <span class="n">d_sym</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subs_syms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_sym</span><span class="p">)</span>

    <span class="n">dcdt_vect_s_viz</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c_vect_viz</span><span class="p">,</span> <span class="n">dcdt_vect_s_viz</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.make_numerical_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_numerical_params</span><span class="p">(</span><span class="n">d_base</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_base</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">beta_base</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Scrape the network for base parameters to initialize numerical parameters.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_numerical_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                   <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span>
                   <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                   <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Scrape the network for base parameters to initialize numerical parameters.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Node parameters:</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">d_base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_base</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="s2">&quot;Length of d_base not equal to node number!&quot;</span>
        <span class="n">d_vect</span> <span class="o">=</span> <span class="n">d_base</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">d_base</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)]</span>

    <span class="c1"># Edge parameters:</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">n_base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_base</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">,</span> <span class="s2">&quot;Length of n_base not equal to edge number!&quot;</span>
        <span class="n">n_vect</span> <span class="o">=</span> <span class="n">n_base</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_base</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta_base</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">beta_base</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">,</span> <span class="s2">&quot;Length of n_base not equal to edge number!&quot;</span>
        <span class="n">beta_vect</span> <span class="o">=</span> <span class="n">beta_base</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">beta_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">beta_base</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_edges</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">d_vect</span><span class="p">,</span> <span class="n">n_vect</span><span class="p">,</span> <span class="n">beta_vect</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.make_pulsed_signals_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_pulsed_signals_matrix</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span> <span class="n">sig_inds</span><span class="p">,</span> <span class="n">sig_times</span><span class="p">,</span> <span class="n">sig_mag</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_pulsed_signals_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                               <span class="n">tvect</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                               <span class="n">sig_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                               <span class="n">sig_times</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
                               <span class="n">sig_mag</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tvect</span><span class="p">)</span>

    <span class="n">c_signals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">))</span>  <span class="c1"># Initialize matrix holding the signal sequences</span>

    <span class="k">for</span> <span class="n">si</span><span class="p">,</span> <span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">te</span><span class="p">),</span> <span class="p">(</span><span class="n">smin</span><span class="p">,</span> <span class="n">smax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sig_inds</span><span class="p">,</span> <span class="n">sig_times</span><span class="p">,</span> <span class="n">sig_mag</span><span class="p">):</span>
        <span class="n">c_signals</span><span class="p">[:,</span> <span class="n">si</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span>
                                        <span class="n">ts</span><span class="p">,</span>
                                        <span class="n">te</span><span class="p">,</span>
                                        <span class="n">c_base</span><span class="o">=</span><span class="n">smax</span><span class="p">,</span>
                                        <span class="n">c_active</span><span class="o">=</span><span class="n">smin</span>
                                        <span class="p">)</span>

    <span class="k">return</span> <span class="n">c_signals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.make_time_vects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_time_vects</span><span class="p">(</span><span class="n">tend</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">dt_samp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_time_vects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">tend</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                    <span class="n">dt_samp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tend</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
    <span class="n">tvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tend</span><span class="p">,</span> <span class="n">Nt</span><span class="p">)</span>

    <span class="c1"># sampling compression</span>
    <span class="k">if</span> <span class="n">dt_samp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sampr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dt_samp</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">tvectr</span> <span class="o">=</span> <span class="n">tvect</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="n">sampr</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tvectr</span> <span class="o">=</span> <span class="n">tvect</span>

    <span class="c1"># make a time-step update vector so we can update any sensors as</span>
    <span class="c1"># an absolute reading (dt = 1.0) while treating the kinetics of the</span>
    <span class="c1"># other node types:</span>
    <span class="c1"># dtv = dt * np.ones(self._N_nodes)</span>
    <span class="c1"># dtv[self.sensor_node_inds] = 1.0</span>

    <span class="k">return</span> <span class="n">tvect</span><span class="p">,</span> <span class="n">tvectr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.multiround" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multiround</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform a rounding procedure to 1/(node_expression_levels - 1) level of resolution.
For example, if node_expression_levels = 5.0, then this will round values to 0.0, 0.25, 0.5, 0.75, and 1.0.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multiround</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Perform a rounding procedure to 1/(node_expression_levels - 1) level of resolution.</span>
<span class="sd">    For example, if node_expression_levels = 5.0, then this will round values to 0.0, 0.25, 0.5, 0.75, and 1.0.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">cc</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_expression_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_node_expression_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.process_full_adjacency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_full_adjacency</span><span class="p">(</span><span class="n">A_full_s</span><span class="p">,</span> <span class="n">coupling_type</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process a full adjacency matrix into additive and multiplicative components
based on a specified coupling type.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_full_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A_full_s</span><span class="p">:</span> <span class="n">MutableDenseMatrix</span><span class="p">,</span> <span class="n">coupling_type</span><span class="p">:</span> <span class="n">CouplingType</span><span class="o">=</span><span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Process a full adjacency matrix into additive and multiplicative components</span>
<span class="sd">    based on a specified coupling type.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">):</span>
            <span class="n">afull_ij</span> <span class="o">=</span> <span class="n">A_full_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">afull_ij</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">additive</span> <span class="ow">or</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">:</span>
                    <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">multiplicative</span><span class="p">:</span>
                    <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;CouplingType.specified is not supported in this method.&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">afull_ij</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">additive</span><span class="p">:</span>
                    <span class="n">A_add_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">elif</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">multiplicative</span> <span class="ow">or</span> <span class="n">coupling_type</span> <span class="ow">is</span> <span class="n">CouplingType</span><span class="o">.</span><span class="n">mix1</span><span class="p">:</span>
                    <span class="n">A_mul_s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;CouplingType.specified is not supported in this method.&#39;</span><span class="p">)</span>

    <span class="n">A_add_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_add_s</span><span class="p">)</span>
    <span class="n">A_mul_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A_mul_s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">A_add_s</span><span class="p">,</span> <span class="n">A_mul_s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.pulses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pulses</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span> <span class="n">t_on</span><span class="p">,</span> <span class="n">t_off</span><span class="p">,</span> <span class="n">c_base</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c_active</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pulses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
           <span class="n">tvect</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span><span class="p">,</span>
           <span class="n">t_on</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
           <span class="n">t_off</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
           <span class="n">c_base</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
           <span class="n">c_active</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
           <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">itop</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&gt;=</span> <span class="n">t_on</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ibot</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvect</span> <span class="o">&lt;=</span> <span class="n">t_off</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ipulse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">ibot</span><span class="p">,</span> <span class="n">itop</span><span class="p">)</span>

    <span class="n">pulse_sig</span> <span class="o">=</span> <span class="n">c_active</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tvect</span><span class="p">))</span>

    <span class="n">pulse_sig</span><span class="p">[</span><span class="n">ipulse</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_base</span>

    <span class="k">return</span> <span class="n">pulse_sig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.reduce_model_dimensions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reduce_model_dimensions</span><span class="p">(</span><span class="n">use_nonlinsolve</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Using analytical methods, attempt to reduce the multidimensional
network equations to as few equations as possible.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reduce_model_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_nonlinsolve</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Using analytical methods, attempt to reduce the multidimensional</span>
<span class="sd">    network equations to as few equations as possible.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Solve the nonlinear system as well as is possible:</span>
    <span class="n">nosol</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># We want to restrict this model reduction to homogeneous networks that</span>
    <span class="c1"># only contain genes and signals.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_node_inds</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inter_fun_type</span> <span class="ow">is</span> <span class="n">InterFuncType</span><span class="o">.</span><span class="n">logistic</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;System unsolvable due to use of logistic interaction function. Try Hill-type equations.&quot;</span><span class="p">)</span>
        <span class="n">nosol</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Immediately flag the sysem as unsolvable</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">use_nonlinsolve</span><span class="p">:</span>
                <span class="n">sol_csetoo</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">nonlinsolve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">:])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">sol_csetoo</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">:])</span>
            <span class="c1"># Clean up the sympy container for the solutions:</span>
            <span class="n">sol_cseto</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sol_csetoo</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol_cseto</span><span class="p">):</span>

                <span class="n">c_master_i</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># the indices of concentrations involved in the master equations (the reduced dims)</span>
                <span class="n">sol_cset</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># A dictionary of auxillary solutions (plug and play)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c_eq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sol_cseto</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">c_eq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">:</span>  <span class="c1"># If it&#39;s a non-solution for the term, append it as a non-reduced conc.</span>
                        <span class="n">c_master_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c_eq</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Otherwise append the plug-and-play solution set:</span>
                        <span class="n">sol_cset</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="p">:][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">c_eq</span>

                <span class="n">master_eq_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># master equations to be numerically optimized (reduced dimension network equations)</span>
                <span class="n">c_vect_reduced</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># concentrations involved in the master equations</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_master_i</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">c_master_i</span><span class="p">:</span>
                        <span class="c1"># substitute in the expressions in terms of master concentrations to form the master equations:</span>
                        <span class="n">ci_solve_eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sol_cset</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
                        <span class="n">master_eq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ci_solve_eq</span><span class="p">)</span>
                        <span class="n">c_vect_reduced</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>  <span class="c1"># if there&#39;s nothing in c_master_i but there are solutions in sol_cseto, then it&#39;s been fully solved:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The system has been fully solved by analytical methods!&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_solved_analytically</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No solutions found for the system.&quot;</span><span class="p">)</span>
                <span class="n">nosol</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception called in Sympy.&quot;</span><span class="p">)</span>
            <span class="n">nosol</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Results:</span>
    <span class="k">if</span> <span class="n">nosol</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reduced_dims</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to reduce equations!&quot;</span><span class="p">)</span>
        <span class="c1"># Set all reduced system attributes to None:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_remainder_s</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># This is the dictionary of remaining concentrations that are in terms of the reduced concentrations,</span>
        <span class="c1"># such that when the master equation set is solved, the results are plugged into the equations in this</span>
        <span class="c1"># dictionary to obtain solutions for the whole network</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonsignal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># If we have solutions, proceed:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reduced_dims</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solved_analytically</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="c1"># New equation list to be numerically optimized (should be significantly reduced dimensions):</span>
            <span class="c1"># Note: this vector is no longer the change rate vector; its now solving for concentrations</span>
            <span class="c1"># where the original rate change vector is zero:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">master_eq_list</span><span class="p">)</span>
            <span class="c1"># This is the concentration vector that contains the reduced equation concentration variables:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="n">c_vect_reduced</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span> <span class="o">=</span> <span class="n">c_master_i</span>  <span class="c1"># indices of concentrations that are being numerically optimized</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="p">)</span>  <span class="c1"># remaining conc indices</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_remainder_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># remaining concs</span>

            <span class="c1"># This is the dictionary of remaining concentrations that are in terms of the reduced concentrations,</span>
            <span class="c1"># such that when the master equation set is solved, the results are plugged into the equations in this</span>
            <span class="c1"># dictionary to obtain solutions for the whole network:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span> <span class="o">=</span> <span class="n">sol_cset</span>

            <span class="c1"># Create a set of signal node indices to the reduced c_vect array:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">si</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">si</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">nonsignal_reduced_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span><span class="p">)),</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Set most reduced system attributes to None:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_master_i</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_remainder_i</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_vect_remainder_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nonsignal_reduced_inds</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># This is the dictionary of remaining concentrations that are in terms of the reduced concentrations,</span>
            <span class="c1"># such that when the master equation set is solved, the results are plugged into the equations in this</span>
            <span class="c1"># dictionary to obtain solutions for the whole network:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span> <span class="o">=</span> <span class="n">sol_cset</span>

            <span class="c1"># The sol_cset exists and can be lambdified for full solutions. Here we lambdify it without the c_vect:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_node_inds</span><span class="p">):</span>
                <span class="n">lambda_params_r</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span> <span class="p">:],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">extra_params_s</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">lambda_params_r</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_node_inds</span><span class="p">,</span> <span class="p">:]]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_f</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">ci</span><span class="p">,</span> <span class="n">eqci</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_s</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># self.sol_cset_f[ci.indices[0]] = sp.lambdify(lambda_params_r, eqci)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sol_cset_f</span><span class="p">[</span><span class="n">ci</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">lambda_params_r</span><span class="p">,</span> <span class="n">eqci</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.run_time_sim" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_time_sim</span><span class="p">(</span><span class="n">tvect</span><span class="p">,</span> <span class="n">tvectr</span><span class="p">,</span> <span class="n">cvecti</span><span class="p">,</span> <span class="n">sig_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sig_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constrained_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_base</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_base</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">beta_base</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_time_sim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">tvect</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                 <span class="n">tvectr</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                 <span class="n">cvecti</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="p">,</span>
                 <span class="n">sig_inds</span><span class="p">:</span> <span class="n">ndarray</span><span class="o">|</span><span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">sig_vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="n">lil_array</span><span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">constrained_inds</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">constrained_vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                 <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.0</span><span class="p">,</span>
                 <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>
                 <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">tvect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tvect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sig_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">sig_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sig_inds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sig_vals</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">concs_time</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">dcdt_vect_f</span><span class="p">,</span> <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_numerical_dcdt</span><span class="p">(</span><span class="n">constrained_inds</span><span class="o">=</span><span class="n">constrained_inds</span><span class="p">,</span>
                                                         <span class="n">constrained_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">)</span>

    <span class="n">function_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function_args</span><span class="p">(</span><span class="n">constraint_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">,</span>
                                           <span class="n">d_base</span><span class="o">=</span><span class="n">d_base</span><span class="p">,</span>
                                           <span class="n">n_base</span><span class="o">=</span><span class="n">n_base</span><span class="p">,</span>
                                           <span class="n">beta_base</span><span class="o">=</span><span class="n">beta_base</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ti</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvect</span><span class="p">):</span>
        <span class="n">dcdt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dcdt_vect_f</span><span class="p">(</span><span class="n">cvecti</span><span class="p">,</span> <span class="o">*</span><span class="n">function_args</span><span class="p">))</span>
        <span class="n">cvecti</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dcdt</span>

        <span class="c1"># manually set the signal node values:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sig_vals</span><span class="p">)</span> <span class="ow">is</span> <span class="n">lil_array</span><span class="p">:</span>
            <span class="n">cvecti</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">,</span> <span class="n">sig_inds</span><span class="p">]</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cvecti</span><span class="p">[</span><span class="n">sig_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">,</span> <span class="n">sig_inds</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">tvectr</span><span class="p">:</span>
            <span class="n">concs_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cvecti</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">concs_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">concs_time</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">concs_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.save_model_equations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_model_equations</span><span class="p">(</span><span class="n">save_eqn_image</span><span class="p">,</span> <span class="n">save_reduced_eqn_image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_eqn_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">substitute_node_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save images of the model equations, as well as a csv file that has
model equations written in LaTeX format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>save_eqn_image</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path and filename to save the main model equations as an image.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_reduced_eqn_image</code>
            </td>
            <td>
                  <code>str|None = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path and filename to save the reduced main model equations as an image (if model is reduced).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_eqn_csv</code>
            </td>
            <td>
                  <code>str|None = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path and filename to save the main and reduced model equations as LaTex in a csv file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_model_equations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">save_eqn_image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">save_reduced_eqn_image</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">save_eqn_csv</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">substitute_node_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                         <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Save images of the model equations, as well as a csv file that has</span>
<span class="sd">    model equations written in LaTeX format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    save_eqn_image : str</span>
<span class="sd">        The path and filename to save the main model equations as an image.</span>

<span class="sd">    save_reduced_eqn_image : str|None = None</span>
<span class="sd">        The path and filename to save the reduced main model equations as an image (if model is reduced).</span>

<span class="sd">    save_eqn_csv : str|None = None</span>
<span class="sd">        The path and filename to save the main and reduced model equations as LaTex in a csv file.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">substitute_node_labels</span><span class="p">:</span>
        <span class="n">subs_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">nde_lab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_list</span><span class="p">):</span>
            <span class="n">nde_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">nde_lab</span><span class="p">)</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pi</span><span class="p">,</span> <span class="n">nde_sym</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">ei</span><span class="p">,</span> <span class="p">(</span><span class="n">nij</span><span class="p">,</span> <span class="n">bij</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_vect_s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta_vect_s</span><span class="p">)):</span>
            <span class="n">b_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;beta_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">n_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n_</span><span class="si">{</span><span class="n">ei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bij</span><span class="p">,</span> <span class="n">b_sym</span><span class="p">))</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nij</span><span class="p">,</span> <span class="n">n_sym</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">ndei</span><span class="p">,</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_d_vect_s</span><span class="p">):</span>
            <span class="n">d_sym</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;d_</span><span class="si">{</span><span class="n">ndei</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">subs_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">di</span><span class="p">,</span> <span class="n">d_sym</span><span class="p">))</span>

        <span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>
        <span class="n">_c_vect_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>
            <span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs_list</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">_dcdt_vect_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_s</span>
        <span class="n">_c_vect_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_s</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_dcdt_vect_reduced_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span>
            <span class="n">_c_vect_reduced_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_vect_reduced_s</span>


    <span class="n">t_s</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">c_change</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">sp</span><span class="o">.</span><span class="n">Derivative</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">t_s</span><span class="p">)</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">_c_vect_s</span><span class="p">])</span>
    <span class="n">eqn_net</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">c_change</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">_dcdt_vect_s</span><span class="p">))</span>

    <span class="n">sp</span><span class="o">.</span><span class="n">preview</span><span class="p">(</span><span class="n">eqn_net</span><span class="p">,</span>
               <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span>
               <span class="n">filename</span><span class="o">=</span><span class="n">save_eqn_image</span><span class="p">,</span>
               <span class="n">euler</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">dvioptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="s2">&quot;-z&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;--truecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;-D 600&quot;</span><span class="p">,</span> <span class="s2">&quot;-bg&quot;</span><span class="p">,</span> <span class="s2">&quot;Transparent&quot;</span><span class="p">])</span>

    <span class="c1"># Save the equations for the graph to a file:</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Concentrations&#39;</span><span class="p">,</span> <span class="s1">&#39;Change Vector&#39;</span><span class="p">]</span>
    <span class="n">eqns_to_write</span> <span class="o">=</span> <span class="p">[[</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_c_vect_s</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_dcdt_vect_s</span><span class="p">)]]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dcdt_vect_reduced_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">save_reduced_eqn_image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">c_change_reduced</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">sp</span><span class="o">.</span><span class="n">Derivative</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">t_s</span><span class="p">)</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">_c_vect_reduced_s</span><span class="p">])</span>
        <span class="n">eqn_net_reduced</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">c_change_reduced</span><span class="p">,</span> <span class="n">_dcdt_vect_reduced_s</span><span class="p">)</span>

        <span class="n">sp</span><span class="o">.</span><span class="n">preview</span><span class="p">(</span><span class="n">eqn_net_reduced</span><span class="p">,</span>
                   <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span>
                   <span class="n">filename</span><span class="o">=</span><span class="n">save_reduced_eqn_image</span><span class="p">,</span>
                   <span class="n">euler</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">dvioptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="s2">&quot;-z&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;--truecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;-D 600&quot;</span><span class="p">,</span> <span class="s2">&quot;-bg&quot;</span><span class="p">,</span> <span class="s2">&quot;Transparent&quot;</span><span class="p">])</span>

        <span class="n">eqns_to_write</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_c_vect_reduced_s</span><span class="p">))</span>
        <span class="n">eqns_to_write</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">_dcdt_vect_reduced_s</span><span class="p">))</span>
        <span class="n">header</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;Reduced Concentations&#39;</span><span class="p">,</span> <span class="s1">&#39;Reduced Change Vector&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">save_eqn_csv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_eqn_csv</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">csvwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>  <span class="c1"># 2. create a csvwriter object</span>
            <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>  <span class="c1"># 4. write the header</span>
            <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">eqns_to_write</span><span class="p">)</span>  <span class="c1"># 5. write the rest of the data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cellnition.science.network_models.probability_networks.ProbabilityNet.solve_probability_equms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_probability_equms</span><span class="p">(</span><span class="n">constraint_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constraint_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">signal_constr_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_base</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_base</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">beta_base</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">N_space</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">search_tol</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">,</span> <span class="n">sol_tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_saddles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">search_main_nodes_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">node_num_max</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Solve for the equilibrium points of gene product probabilities in
terms of a given set of numerical parameters.</p>


            <details class="quote">
              <summary>Source code in <code>cellnition/science/network_models/probability_networks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_probability_equms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">constraint_inds</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">constraint_vals</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">signal_constr_vals</span><span class="p">:</span> <span class="nb">list</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">d_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                            <span class="n">n_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.0</span><span class="p">,</span>
                            <span class="n">beta_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">|</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
                            <span class="n">N_space</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                            <span class="n">search_tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0e-15</span><span class="p">,</span>
                            <span class="n">sol_tol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0e-1</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">save_file</span><span class="p">:</span> <span class="nb">str</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">return_saddles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">search_main_nodes_only</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">node_num_max</span><span class="p">:</span> <span class="nb">int</span><span class="o">|</span><span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Solve for the equilibrium points of gene product probabilities in</span>
<span class="sd">    terms of a given set of numerical parameters.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># For any network, there may be nodes without regulation that require constraints</span>
    <span class="c1"># (these are in self._constrained_nodes). Therefore, add these to any user-supplied</span>
    <span class="c1"># constraints:</span>
    <span class="n">constrained_inds</span><span class="p">,</span> <span class="n">constrained_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_constrained_nodes</span><span class="p">(</span><span class="n">constraint_inds</span><span class="p">,</span>
                                                                        <span class="n">constraint_vals</span><span class="p">,</span>
                                                                        <span class="n">signal_constr_vals</span><span class="o">=</span><span class="n">signal_constr_vals</span><span class="p">)</span>

    <span class="n">dcdt_vect_f</span><span class="p">,</span> <span class="n">dcdt_jac_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_numerical_dcdt</span><span class="p">(</span><span class="n">constrained_inds</span><span class="o">=</span><span class="n">constrained_inds</span><span class="p">,</span>
                                                         <span class="n">constrained_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">node_num_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sort_hier_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hier_node_level</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">influence_node_inds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noninput_node_inds</span><span class="p">)[</span><span class="n">sort_hier_inds</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">node_num_max</span><span class="p">])</span>


    <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">constrained_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">unconstrained_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes_index</span><span class="p">,</span> <span class="n">constrained_inds</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">search_main_nodes_only</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="n">unconstrained_inds</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node_num_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">node_num_max</span><span class="p">:</span>
                <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_nodes</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">M_pstates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_state_space</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">influence_node_inds</span><span class="p">,</span> <span class="n">N_space</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No main nodes; cannot perform state search with &quot;</span>
                            <span class="s2">&quot;search_main_nodes_only=True.&quot;</span><span class="p">)</span>

    <span class="n">sol_Mo</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">function_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function_args</span><span class="p">(</span><span class="n">constraint_vals</span><span class="o">=</span><span class="n">constrained_vals</span><span class="p">,</span>
                                           <span class="n">d_base</span><span class="o">=</span><span class="n">d_base</span><span class="p">,</span>
                                           <span class="n">n_base</span><span class="o">=</span><span class="n">n_base</span><span class="p">,</span>
                                           <span class="n">beta_base</span><span class="o">=</span><span class="n">beta_base</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_function_args</span> <span class="o">=</span> <span class="n">function_args</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cvecto</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">M_pstates</span><span class="p">):</span> <span class="c1"># for each test vector:</span>
        <span class="c1"># get values for the genes we&#39;re solving for...</span>
        <span class="c1"># Note: fsolve doesn&#39;t allow us to impose constraints so we need to push this initial guess</span>
        <span class="c1"># quite far away from zero with the added constant:</span>
        <span class="n">c_vect_sol</span> <span class="o">=</span> <span class="n">cvecto</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_push_away_from_zero</span>
        <span class="n">sol_roots</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">dcdt_vect_f</span><span class="p">,</span>
                           <span class="n">c_vect_sol</span><span class="p">,</span>
                           <span class="n">args</span><span class="o">=</span><span class="n">function_args</span><span class="p">,</span>
                           <span class="n">xtol</span><span class="o">=</span><span class="n">search_tol</span><span class="p">,</span>
                           <span class="n">fprime</span><span class="o">=</span><span class="n">dcdt_jac_f</span><span class="p">,</span>
                           <span class="n">col_deriv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="p">)</span>

        <span class="c1"># Find any roots below zero and constrain them to 0.0:</span>
        <span class="n">sol_roots</span><span class="p">[(</span><span class="n">sol_roots</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span>

        <span class="n">c_eqms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_nodes</span><span class="p">)</span>
        <span class="n">c_eqms</span><span class="p">[</span><span class="n">unconstrained_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_roots</span>

        <span class="k">if</span> <span class="n">constrained_inds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">constrained_vals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c_eqms</span><span class="p">[</span><span class="n">constrained_inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">constrained_vals</span>

        <span class="c1"># c_eqms = self.multiround(c_eqms)</span>

        <span class="n">sol_Mo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_eqms</span><span class="p">)</span>

    <span class="c1"># _, unique_inds = np.unique(np.round(sol_Mo, 2), axis=0, return_index=True)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">unique_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiround</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_Mo</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">sol_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sol_Mo</span><span class="p">)[</span><span class="n">unique_inds</span><span class="p">]</span>

    <span class="n">stable_sol_M</span><span class="p">,</span> <span class="n">sol_M_char</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_attractor_sols</span><span class="p">(</span><span class="n">sol_M</span><span class="p">,</span>
                                                         <span class="n">dcdt_vect_f</span><span class="p">,</span>
                                                         <span class="n">dcdt_jac_f</span><span class="p">,</span>
                                                         <span class="n">function_args</span><span class="p">,</span>
                                                         <span class="n">constrained_inds</span><span class="o">=</span><span class="n">constrained_inds</span><span class="p">,</span>
                                                         <span class="n">tol</span><span class="o">=</span> <span class="n">sol_tol</span><span class="p">,</span>
                                                         <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                                                         <span class="n">save_file</span> <span class="o">=</span> <span class="n">save_file</span><span class="p">,</span>
                                                         <span class="n">return_saddles</span><span class="o">=</span><span class="n">return_saddles</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">stable_sol_M</span><span class="p">,</span> <span class="n">sol_M_char</span><span class="p">,</span> <span class="n">sol_M</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>